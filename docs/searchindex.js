Search.setIndex({"docnames": ["documentation", "documentation/Module", "documentation/intervention", "documentation/models", "documentation/patching", "documentation/tracing", "documentation/util", "index", "start", "tutorials", "tutorials/main_demo", "tutorials/nnsight_exercises"], "filenames": ["documentation.rst", "documentation/Module.rst", "documentation/intervention.rst", "documentation/models.rst", "documentation/patching.rst", "documentation/tracing.rst", "documentation/util.rst", "index.rst", "start.rst", "tutorials.rst", "tutorials/main_demo.ipynb", "tutorials/nnsight_exercises.ipynb"], "titles": ["Documentation", "nnsight.Module", "nnsight.intervention", "nnsight.models", "nnsight.patching", "nnsight.tracing", "nnsight.util", "nnsight documentation", "Getting Started", "Tutorials", "Main Demo", "NDIF Main Demo Notebook"], "terms": {"nnsight": [0, 8, 10], "model": [0, 1, 2, 5, 7, 8, 9], "modul": [0, 2, 3, 4, 5, 6, 7, 10, 11], "util": [0, 11], "intervent": [0, 1, 3, 11], "trace": [0, 2, 3], "patch": [0, 11], "The": [1, 2, 3, 4, 5, 7, 10, 11], "object": [1, 2, 3, 4, 5, 6, 7], "act": [1, 3, 5, 10], "entrypoint": 1, "interwoven": 1, "graph": [1, 2, 3, 5, 11], "manipul": [1, 7, 8], "input": [1, 2, 3, 6, 10, 11], "output": [1, 2, 3, 5, 10], "i": [1, 2, 3, 5, 6, 7, 8, 10, 11], "run": [1, 3, 5, 6, 9], "specif": [1, 3, 7, 10, 11], "attribut": [1, 2, 3, 4, 5, 6, 11], "ar": [1, 2, 3, 5, 6, 10, 11], "root": [1, 2, 3, 5, 6, 11], "node": [1, 2, 5], "all": [1, 2, 3, 5, 6, 7, 8, 11], "oper": [1, 3, 5, 11], "perform": [1, 3, 5, 6, 11], "proxi": [1, 2, 5, 10, 11], "downstream": [1, 2, 3], "popul": [1, 2, 5], "requir": [1, 11], "tracer": 1, "add": [1, 2, 4, 5, 11], "correct": [1, 10, 11], "exampl": [1, 2, 3, 7, 8, 9, 11], "below": [1, 11], "show": [1, 10, 11], "access": [1, 2, 3, 11], "gpt2": [1, 3, 11], "save": [1, 2, 3, 10], "them": [1, 2, 3, 6, 11], "dure": [1, 2, 5, 9, 11], "execut": [1, 2, 3, 5, 6, 10, 11], "print": [1, 2, 3, 6, 10, 11], "result": [1, 2, 5, 10], "valu": [1, 2, 3, 5, 10, 11], "after": [1, 3, 6, 10, 11], "gener": [1, 2, 3, 5], "invok": [1, 2, 3, 10, 11], "eiffel": [1, 2, 3, 11], "tower": [1, 2, 3, 11], "citi": [1, 2, 3, 10, 11], "hidden_st": [1, 2, 11], "lm_head": [1, 2, 3, 11], "logit": [1, 2, 3, 6, 9], "set": [1, 2, 5, 11], "zero": [1, 10, 11], "transform": [1, 2, 3, 6], "h": [1, 2, 3, 6], "0": [1, 2, 3, 10], "class": [1, 2, 3, 4, 5, 6, 11], "meant": [1, 3], "wrap": [1, 3, 6, 11], "exist": [1, 2, 11], "torch": [1, 2, 3, 4, 5, 6, 10, 11], "within": [1, 3, 6, 11], "": [1, 2, 3, 5, 6, 10, 11], "tree": [1, 10], "order": [1, 2, 3, 5, 11], "function": [1, 2, 3, 4, 6, 7], "respect": [1, 11], "module_path": [1, 2], "string": [1, 6, 11], "repres": [1, 4, 5, 11], "path": [1, 2, 3, 6, 11], "thi": [1, 2, 3, 5, 6, 8, 10, 11], "rel": [1, 2], "separ": [1, 6, 11], "e": [1, 6, 11], "x": [1, 3, 6, 10, 11], "mlp": [1, 2, 3, 10], "abstractmodel": [1, 3], "initi": [1, 3, 4, 11], "meta": [1, 3, 5], "type": [1, 2, 3, 4, 5, 6, 11], "str": [1, 2, 3, 5, 6, 11], "reset": [1, 5], "pass": [1, 3, 5, 6, 9], "through": [1, 2, 5, 6, 10, 11], "interventionproxi": [1, 2, 11], "output_shap": 1, "shape": [1, 2, 5, 6, 10, 11], "tensor": [1, 2, 3, 5, 6, 11], "most": [1, 11], "recent": 1, "can": [1, 2, 3, 5, 10, 11], "also": [1, 3, 4, 10, 11], "nest": 1, "list": [1, 2, 3, 4, 5, 10, 11], "size": [1, 2, 6, 10, 11], "output_typ": 1, "dtype": 1, "input_shap": 1, "input_typ": 1, "which": [1, 3, 5, 6, 10, 11], "an": [1, 2, 4, 5, 6, 10, 11], "must": [1, 11], "manual": 1, "context": [1, 2, 3, 4, 10, 11], "properti": [1, 2], "call": [1, 2, 3, 4, 5, 6, 11], "denot": [1, 2, 11], "user": [1, 2, 3, 11], "wish": [1, 3, 11], "get": [1, 5, 6, 7, 10, 11], "therefor": [1, 5], "we": [1, 3, 10, 11], "creat": [1, 5, 10, 11], "request": [1, 11], "onli": [1, 2, 3, 5, 6, 10, 11], "first": [1, 2, 3, 5, 6, 10, 11], "time": [1, 6, 10, 11], "refer": [1, 11], "otherwis": [1, 11], "return": [1, 2, 3, 6, 10, 11], "alreadi": [1, 10, 11], "one": [1, 3, 5, 6, 10, 11], "static": 1, "our": [1, 10, 11], "forward": [1, 3, 6, 9], "hook": [1, 2, 3, 6], "data": [1, 5, 6, 10, 11], "doe": [1, 10, 11], "nn": [1, 2, 3, 5, 11], "modulelist": [1, 3, 10], "paramet": [1, 2, 3, 4, 6, 10, 11], "contain": [2, 3, 7, 11], "logic": 2, "interleav": [2, 3, 5], "comput": [2, 3, 5, 6, 10], "extend": 2, "base": [2, 5, 11], "fx": 2, "make": [2, 10, 11], "easier": [2, 11], "interact": [2, 3, 5, 11], "interven": [2, 9], "entri": [2, 5], "hookmodel": 2, "provid": [2, 7, 11], "manag": [2, 3, 4, 11], "ad": [2, 3, 5, 11], "remov": [2, 11], "upon": 2, "exit": [2, 10, 11], "input_hook": 2, "option": [2, 4, 5, 6], "callabl": [2, 5, 6], "none": [2, 3, 4, 5, 11], "output_hook": 2, "appli": [2, 3, 6, 8, 10, 11], "regist": [2, 6], "__enter__": [2, 4], "__exit__": [2, 4], "along": [2, 11], "tupl": [2, 10, 11], "design": 2, "should": [2, 5, 6, 11], "have": [2, 5, 7, 8, 11], "signatur": 2, "ani": [2, 3, 4, 5, 6, 10, 11], "handl": [2, 4, 11], "from": [2, 3, 4, 6, 10, 11], "us": [2, 3, 5, 6, 7, 10], "when": [2, 3, 5, 11], "removablehandl": 2, "sub": [2, 3, 11], "addit": [2, 11], "so": [2, 5, 10, 11], "both": [2, 3, 5, 11], "clone": [2, 11], "point": [2, 5, 11], "delet": 2, "complet": [2, 5, 10, 11], "listen": [2, 5], "enabl": [2, 3], "work": [2, 10, 11], "would": [2, 10, 11], "had": [2, 11], "you": [2, 3, 5, 8, 11], "thrown": 2, "error": [2, 11], "index": [2, 5, 10, 11], "token": [2, 3, 6, 10], "hidden": [2, 10], "state": [2, 3, 10], "easili": [2, 11], "done": [2, 11], "idx": [2, 11], "t": [2, 10, 11], "collect": [2, 3, 6, 11], "actual": [2, 3, 5, 10, 11], "updat": [2, 5, 6], "throw": 2, "method": [2, 3, 5, 6, 11], "indic": [2, 10, 11], "union": [2, 3, 5, 11], "retriev": [2, 6], "tokenindex": 2, "alia": 2, "do": [2, 11], "directli": [2, 3, 11], "second": [2, 11], "dimens": [2, 11], "posit": [2, 3, 10, 11], "neg": 2, "pad": [2, 11], "left": [2, 11], "equival": [2, 11], "3": [2, 3, 10], "For": [2, 8, 10, 11], "store": [2, 5, 10, 11], "helper": [2, 6, 11], "aid": 2, "activ": [2, 3, 10, 11], "kei": [2, 5, 7, 11], "involv": [2, 5, 11], "form": [2, 3, 5, 11], "current": [2, 5, 11], "check": [2, 3, 7, 8, 11], "argument_node_nam": [2, 5], "If": [2, 3, 5, 6, 8, 10, 11], "name": [2, 3, 5, 11], "iter": [2, 3, 11], "arg": [2, 3, 5, 6], "argument": [2, 3, 5, 6, 11], "batch_siz": [2, 11], "batch_start": 2, "narrow": 2, "select": 2, "batch": [2, 3, 6, 11], "relev": [2, 10], "view": [2, 5, 11], "oppos": [2, 11], "copi": 2, "allow": [2, 3, 5, 11], "subsequ": [2, 11], "edit": 2, "origin": [2, 4, 10, 11], "prevent": 2, "effect": [2, 11], "bath": 2, "outsid": [2, 5, 11], "preview": 2, "either": [2, 3, 11], "potenti": 2, "modifi": 2, "main": [3, 9], "packag": [3, 6, 7, 8], "load": [3, 9, 11], "here": [3, 10, 11], "huggingfac": [3, 10, 11], "its": [3, 11], "repo": [3, 10], "id": [3, 6, 10, 11], "languagemodel": [3, 10, 11], "import": [3, 4, 10], "device_map": [3, 10, 11], "cuda": [3, 10, 11], "In": [3, 10, 11], "case": [3, 10, 11], "mean": [3, 10, 11], "underli": 3, "automodelforcausallm": 3, "unus": 3, "ultim": 3, "leverag": 3, "acceler": 3, "gpu": [3, 10], "local_model": [3, 11], "further": 3, "encapsul": 3, "out": [3, 4, 5, 7, 8, 10, 11], "structur": [3, 10, 11], "well": [3, 5, 11], "meta_model": 3, "demonstr": [3, 11], "like": [3, 8, 10, 11], "gpt2lmheadmodel": 3, "gpt2model": 3, "wte": 3, "embed": [3, 10, 11], "50257": 3, "768": 3, "wpe": 3, "1024": 3, "drop": 3, "dropout": [3, 10, 11], "p": [3, 10, 11], "1": [3, 6, 10], "inplac": [3, 10, 11], "fals": [3, 6, 10, 11], "11": [3, 10, 11], "12": [3, 10, 11], "gpt2block": 3, "ln_1": 3, "layernorm": [3, 10, 11], "ep": [3, 10], "1e": [3, 10, 11], "05": [3, 10, 11], "elementwise_affin": [3, 10], "true": [3, 6, 10, 11], "attn": [3, 11], "gpt2attent": 3, "c_attn": 3, "conv1d": 3, "c_proj": 3, "attn_dropout": [3, 11], "resid_dropout": 3, "ln_2": 3, "gpt2mlp": 3, "c_fc": 3, "newgeluactiv": 3, "ln_f": 3, "linear": [3, 10, 11], "in_featur": [3, 10, 11], "out_featur": [3, 10, 11], "bia": [3, 10], "two": [3, 11], "enter": 3, "track": [3, 5, 10], "multi": 3, "infer": [3, 11], "determin": 3, "behavior": 3, "three": [3, 11], "where": [3, 5, 11], "accept": [3, 11], "other": [3, 5, 11], "invoc": [3, 11], "It": [3, 5, 11], "prepar": 3, "prompt": [3, 10, 11], "languag": [3, 10, 11], "over": [3, 10, 11], "max_new_token": [3, 11], "logits1": 3, "empir": 3, "build": [3, 11], "logits2": 3, "runner": 3, "direct": [3, 5], "train": 3, "mode": [3, 11], "gradient": 3, "see": [3, 7, 8, 10, 11], "repoid_path_model": 3, "alter": 3, "bool": [3, 6, 11], "kwarg": [3, 5, 6], "abstract": 3, "implement": [3, 5, 11], "pytorch": [3, 11], "gain": 3, "repoid_path_clsnam": 3, "hug": 3, "face": 3, "checkpoint": 3, "custom": 3, "keyword": 3, "dict": [3, 5, 10, 11], "dispatch": 3, "ha": [3, 5, 6, 11], "bee": 3, "yet": [3, 7, 8, 10, 11], "custom_model": 3, "wa": [3, 10, 11], "version": [3, 11], "devic": [3, 5, 11], "_typ_": 3, "local": 3, "ran": [3, 5, 11], "singl": [3, 5, 11], "_run_loc": 3, "A": [3, 11], "simpl": [3, 6], "some": [3, 4, 6, 8, 10, 11], "process": [3, 5, 11], "_gener": 3, "tandem": 3, "limit": 3, "amount": 3, "predict": [3, 11], "doc": [3, 11], "more": [3, 7, 8, 10, 11], "inform": [3, 7, 10, 11], "node_nam": 3, "module_nam": 3, "_summary_": [3, 5], "_description_": [3, 5], "wrapper": [3, 6], "around": [3, 11], "int": [3, 5, 11], "config": 3, "file": [3, 11], "repositori": 3, "pretrainedconfig": 3, "lm": 3, "pretrainedtoken": 3, "pretrainedmodel": 3, "diffusermodel": 3, "diffus": 3, "repoid_or_path": 3, "cliptoken": 3, "to_imag": 3, "latent": 3, "imag": [3, 11], "convert": [3, 5, 11], "default_patch": 4, "default": [4, 5, 6, 11], "patcher": 4, "obj": 4, "replac": [4, 11], "carri": [4, 5, 11], "importlib": 4, "import_modul": 4, "self": [4, 11], "__module__": 4, "And": 4, "setattr": 4, "__name__": 4, "restor": [4, 10], "each": [5, 10, 11], "flow": 5, "said": 5, "thei": [5, 11], "AND": 5, "proxy_valu": 5, "datatyp": 5, "pre": 5, "set_valu": 5, "bi": 5, "depend": [5, 11], "respons": [5, 11], "same": [5, 6, 11], "theirs": 5, "longer": [5, 10, 11], "destroi": [5, 11], "free": 5, "memori": 5, "re": [5, 11], "remain": 5, "new": [5, 11], "own": [5, 11], "traceabl": 5, "mani": 5, "python": [5, 11], "built": 5, "magic": 5, "__torch_function__": 5, "find": [5, 11], "shame": 5, "reserv": 5, "target": [5, 6], "There": [5, 11], "__init__": [5, 6, 11], "compil": 5, "whatev": [5, 11], "being": [5, 10, 11], "multipl": [5, 11], "Their": 5, "need": [5, 6, 11], "map": [5, 11], "These": [5, 10, 11], "kick": 5, "rtn": 5, "what": [5, 11], "null": [5, 11], "never": [5, 11], "proxy_class": 5, "name_idx": 5, "target_nam": 5, "number": [5, 11], "previou": [5, 11], "uniqu": 5, "module_proxi": 5, "given": [5, 6, 10, 11], "generation_idx": 5, "desc": 5, "_proxy_devic": 5, "throughout": [6, 11], "wrappermodul": 6, "element": [6, 11], "defin": [6, 11], "everi": [6, 11], "overridden": 6, "subclass": 6, "although": [6, 11], "recip": 6, "instanc": [6, 11], "afterward": 6, "instead": [6, 11], "sinc": [6, 10, 11], "former": 6, "take": [6, 11], "care": [6, 11], "while": 6, "latter": [6, 11], "silent": [6, 11], "ignor": [6, 11], "fn": [6, 11], "cl": 6, "member": 6, "give": [6, 10, 11], "kind": [6, 11], "been": [6, 7, 8, 11], "cross_entropy_loss": 6, "target_id": 6, "shift": 6, "avg_batch": 6, "avg_token": 6, "cross": 6, "entropi": 6, "loss": 6, "n": [6, 11], "featur": [6, 7, 8, 11], "last": [6, 11], "averag": [6, 11], "across": 6, "fetch_attr": 6, "hierarchi": 6, "level": 6, "fetch": 6, "func": 6, "lggr": 6, "decor": 6, "__class__": 6, "\u025bn": [7, 8], "sa\u026at": [7, 8], "interpret": [7, 8, 11], "intern": [7, 8, 10, 11], "larg": [7, 11], "link": [7, 11], "start": [7, 10, 11], "instal": [7, 11], "tutori": [7, 8], "colab": [7, 8, 11], "page": [7, 11], "instruct": [7, 11], "section": [7, 8, 11], "depth": [7, 11], "concept": 7, "background": 7, "explan": [7, 11], "detail": [7, 10, 11], "descript": 7, "includ": [7, 11], "sourc": [7, 11], "Not": [7, 8, 11], "tool": [7, 11], "github": [7, 8, 11], "usag": 7, "deep": [8, 11], "learn": 8, "To": [8, 10, 11], "pip": [8, 11], "how": [8, 10, 11], "d": [8, 11], "hand": [8, 10], "experi": [8, 11], "cover": [8, 11], "basic": [8, 11], "document": [8, 11], "demo": 9, "len": [9, 11], "notebook": [], "engin": 11, "api": 11, "follow": 11, "With": [], "open": 11, "llm": [], "referenc": [], "ll": [10, 11], "look": 11, "gpt": 11, "2": 10, "small": 11, "80m": [], "declar": [], "onto": 10, "text": 11, "decod": [10, 11], "pari": [10, 11], "let": [10, 11], "break": [10, 11], "down": [10, 11], "piec": 11, "block": 11, "later": [10, 11], "specifi": [10, 11], "want": [10, 11], "varieti": 11, "format": 11, "final": [10, 11], "raw": [], "But": 11, "black": [], "box": [], "gpt2_text": [], "natur": [], "task": [], "gpt2_token": [], "encod": 10, "focu": [], "highlight": 11, "line": [10, 11], "layer": [10, 11], "Then": 11, "word": 11, "grab": [], "becom": 10, "0th": 11, "anoth": [], "10": [10, 11], "64": 11, "becaus": 11, "attent": 10, "eventu": 11, "similarli": [], "u": 11, "ever": 11, "dereferenc": 11, "35364": [], "3303": [], "7587": [], "8861": [], "884": [], "355": [], "1808": [], "18877": [], "4572": [], "11059": [], "3555": [], "35915": [], "290": [], "15676": [], "1634": [], "389": [], "6032": [], "10448": [], "351": [], "28679": [], "4673": [], "319": [], "431": [], "7790": [], "40522": [], "13": [10, 11], "2102": [], "2059": [], "1688": [], "0503": [], "3703": [], "2015": [], "6594": [], "9412": [], "2137": [], "8": [10, 11], "5667": [], "6": [10, 11], "3562": [], "4": 10, "1276": 11, "6006": [], "0798": [], "5781": [], "1944": [], "8023": [], "5": [10, 11], "6864": [], "6289": [], "1180": [], "4320": [], "20": 11, "7147": [], "7145": [], "3738": [], "4004": [], "1358": [], "9569": [], "3060": [], "7": [10, 11], "1600": [], "6868": [], "9850": [], "7206": [], "7800": [], "1185": [], "1680": [], "7024": [], "2865": [], "assign": 11, "As": [10, 11], "ablat": [], "head": [], "abov": [10, 11], "layer_to_abl": [], "head_index_to_abl": [], "normal_lm_head": [], "attention_pattern": 11, "ablated_lm_head": [], "observ": 11, "notic": 11, "chang": 10, "tensor_token": [], "0187": [], "2913": [], "circuit": [], "veri": 11, "detect": [], "continu": [], "repeat": [], "consist": [10, 11], "compos": 11, "togeth": 11, "alwai": 11, "attend": 11, "earlier": 11, "why": [], "sai": 11, "try": 11, "next": 11, "articl": [], "about": [10, 11], "michael": [], "jordan": [], "could": 11, "surnam": [], "occur": [], "ie": [], "confid": 10, "come": 11, "interest": 11, "fact": 11, "generalis": [], "arbitrari": [], "sequenc": 11, "50": 11, "random": 11, "twice": [], "plot": [], "goe": [], "terribl": [], "good": 11, "halfwai": [], "seq_len": 11, "random_token": [], "randint": [], "1000": 11, "10000": [], "repeated_token": [], "einop": 11, "token_id": 10, "xaxi": [], "yaxi": [], "titl": [10, 11], "49": 11, "place": 11, "back": [], "paid": [], "identifi": 11, "output_attent": [], "attn_hidden_st": [], "layer_idx": [], "rang": [10, 11], "stack": 11, "diagon": [], "dim1": [], "dim2": [], "offset": [], "induction_scor": [], "cpu": 11, "imshow": [10, 11], "score": 11, "pretrain": 10, "eleutherai": [10, 11], "1b": 10, "pythia": 10, "command": 10, "download": 10, "configur": 10, "weight": [10, 11], "your": [10, 11], "machin": [10, 11], "even": [10, 11], "though": 10, "still": [10, 11], "inspect": 10, "gptneoxforcausallm": 10, "gpt_neox": 10, "gptneoxmodel": 10, "embed_in": 10, "50304": 10, "2048": [10, 11], "emb_dropout": 10, "15": [10, 11], "16": [10, 11], "gptneoxlay": 10, "input_layernorm": 10, "post_attention_layernorm": 10, "post_attention_dropout": 10, "post_mlp_dropout": 10, "gptneoxattent": 10, "rotary_emb": 10, "gptneoxrotaryembed": 10, "query_key_valu": 10, "6144": 10, "dens": 10, "attention_dropout": 10, "gptneoxmlp": 10, "dense_h_to_4h": 10, "8192": 10, "dense_4h_to_h": 10, "geluactiv": 10, "final_layer_norm": 10, "embed_out": 10, "extract": [10, 11], "residu": [10, 11], "stream": [10, 11], "john": 10, "mari": 10, "went": 10, "milk": 10, "last_hidden_st": 10, "now": [10, 11], "aren": 10, "tell": 10, "modif": 10, "until": 10, "cach": [10, 11], "insid": [10, 11], "desir": 10, "probabl": [10, 11], "move": [10, 11], "One": [10, 11], "techniqu": 10, "treat": 10, "intermedi": 10, "crude": 10, "approxim": 10, "def": [10, 11], "norm": 10, "unembed": [10, 11], "all_prob": 10, "prob": 10, "softmax": [10, 11], "dim": [10, 11], "append": [10, 11], "distribut": 10, "evolv": 10, "plotli": [10, 11], "express": [10, 11], "px": [10, 11], "mary_token": 10, "input_id": [10, 11], "layer_prob": 10, "item": [10, 11], "accord": [10, 11], "label": [10, 11], "suggest": [10, 11], "begin": [10, 11], "realiz": 10, "answer": [10, 11], "few": [10, 11], "consid": [10, 11], "countri": [10, 11], "best": [10, 11], "guess": 10, "franc": 10, "tok": [10, 11], "zip": [10, 11], "topk": [10, 11], "f": [10, 11], "3f": 10, "425": 10, "096": 10, "022": 10, "belgium": 10, "008": 10, "prov": 10, "007": 10, "luxem": 10, "saint": 10, "la": 10, "compon": 10, "correctli": [10, 11], "wai": [10, 11], "corrupt": [10, 11], "represent": [10, 11], "confus": [10, 11], "certain": 10, "clean": [10, 11], "caus": [10, 11], "again": [10, 11], "9": [10, 11], "subject_idx": 10, "fourth": [10, 11], "answer_token": 10, "002277057385072112": 10, "all_hidden_st": 10, "record": 10, "n_layer": [10, 11], "n_token": [10, 11], "intervened_prob": 10, "_": 10, "visual": 10, "squeez": [10, 11], "token_label": 10, "enumer": 10, "fig": 10, "y": [10, 11], "color_continuous_midpoint": 10, "color_continuous_scal": 10, "rdbu": 10, "causal": [10, 11], "locat": 10, "befor": [10, 11], "meng": 10, "et": 10, "al": 10, "2022": 10, "written": 11, "style": 11, "arena": 11, "gdrive": 11, "directori": 11, "note": 11, "ve": 11, "code": 11, "beyond": 11, "oom": 11, "unless": 11, "got": 11, "pro": 11, "smth": 11, "howev": 11, "displai": 11, "my": 11, "ipynb": 11, "virtual": 11, "did": 11, "librari": 11, "translat": 11, "g": 11, "question": 11, "pose": 11, "paper": 11, "icl": 11, "exemplar": 11, "math": 11, "itself": 11, "prove": 11, "ye": 11, "construct": 11, "produc": 11, "shot": 11, "just": 11, "replic": 11, "crux": 11, "whose": 11, "induc": 11, "solv": 11, "behaviour": 11, "randomli": 11, "shuffl": 11, "steer": 11, "differ": 11, "capit": 11, "abl": 11, "think": 11, "netherland": 11, "usual": 11, "talk": 11, "amsterdam": 11, "up": 11, "vocabulari": 11, "arithmet": 11, "googl": 11, "in_colab": 11, "except": 11, "o": 11, "sy": 11, "fn_vector": 11, "wget": 11, "http": 11, "com": 11, "callummcdougal": 11, "archiv": 11, "ref": 11, "unzip": 11, "renam": 11, "chdir": 11, "dev": 11, "jaxtyp": 11, "transformer_len": 11, "git": 11, "circuitsvi": 11, "subdirectori": 11, "upgrad": 11, "pydant": 11, "clear": 11, "ipython": 11, "clear_output": 11, "els": 11, "get_ipython": 11, "run_line_mag": 11, "load_ext": 11, "autoreload": 11, "amp": 11, "pathlib": 11, "gdown": 11, "zipfil": 11, "expect": 11, "resolv": 11, "assert": 11, "ndif_root": 11, "insert": 11, "cv": 11, "numpi": 11, "np": 11, "float": 11, "tqdm": 11, "webbrows": 11, "rich": 11, "rprint": 11, "tabl": 11, "openai": 11, "gc": 11, "plotly_util": 11, "test": 11, "is_avail": 11, "set_grad_en": 11, "j": 11, "6b": 11, "discuss": 11, "extens": 11, "plain": 11, "standard": 11, "lot": 11, "etc": 11, "action": 11, "variabl": 11, "n_head": 11, "d_model": 11, "n_embd": 11, "d_head": 11, "28": 11, "4096": 11, "256": 11, "gptjconfig": 11, "34": 11, "_name_or_path": 11, "activation_funct": 11, "gelu_new": 11, "architectur": 11, "gptjforcausallm": 11, "attn_pdrop": 11, "bos_token_id": 11, "50256": 11, "embd_pdrop": 11, "eos_token_id": 11, "gradient_checkpoint": 11, "initializer_rang": 11, "02": 11, "layer_norm_epsilon": 11, "model_typ": 11, "gptj": 11, "n_inner": 11, "n_posit": 11, "resid_pdrop": 11, "rotari": 11, "rotary_dim": 11, "scale_attn_weight": 11, "summary_activ": 11, "summary_first_dropout": 11, "summary_proj_to_label": 11, "summary_typ": 11, "cls_index": 11, "summary_use_proj": 11, "task_specific_param": 11, "do_sampl": 11, "max_length": 11, "temperatur": 11, "tie_word_embed": 11, "tokenizer_class": 11, "gpt2token": 11, "transformers_vers": 11, "33": 11, "use_cach": 11, "vocab_s": 11, "50400": 11, "transformerlen": 11, "unlik": 11, "won": 11, "to_str_tok": 11, "todai": 11, "dictionari": 11, "thing": 11, "attention_mask": 11, "dropdown": 11, "return_tensor": 11, "pt": 11, "rather": 11, "than": 11, "length": 11, "shorter": 11, "integ": 11, "correspond": 11, "1d": 11, "arrai": 11, "those": 11, "concaten": 11, "sometim": 11, "batch_decod": 11, "doesn": 11, "2d": 11, "thursdai": 11, "40": 11, "1239": 11, "714": 11, "651": 11, "262": 11, "8181": 11, "286": 11, "48971": 11, "12545": 11, "4711": 11, "2456": 11, "481": 11, "307": 11, "6626": 11, "510": 11, "1212": 11, "6827": 11, "1978": 11, "2396": 11, "428": 11, "530": 11, "split": 11, "sentenc": 11, "special": 11, "\u0121": 11, "charact": 11, "prepend": 11, "space": 11, "39": 11, "3635": 11, "hang": 11, "\u0121sentenc": 11, "\u0121will": 11, "\u0121be": 11, "\u0121token": 11, "iz": 11, "seri": 11, "mask": 11, "don": 11, "hello": 11, "world": 11, "15496": 11, "995": 11, "bit": 11, "bunch": 11, "plu": 11, "mayb": 11, "might": 11, "exact": 11, "quit": 11, "middl": 11, "sent": 11, "off": 11, "simplest": 11, "read": 11, "warn": 11, "printout": 11, "fwd": 11, "filterwarn": 11, "messag": 11, "pad_token_id": 11, "end": 11, "go": 11, "essenti": 11, "autoregress": 11, "isn": 11, "strictli": 11, "necessari": 11, "anywai": 11, "suppress": 11, "part": 11, "abil": 11, "On": 11, "made": 11, "often": 11, "visit": 11, "exactli": 11, "particular": 11, "gptjblock": 11, "figur": 11, "present": 11, "were": 11, "calcul": 11, "full": 11, "debug": 11, "happen": 11, "difficulti": 11, "spend": 11, "minut": 11, "That": 11, "put": 11, "practic": 11, "pattern": 11, "zeroth": 11, "remind": 11, "num_head": 11, "num_token": 11, "stuck": 11, "gptjattent": 11, "affect": 11, "disabl": 11, "asid": 11, "batchnorm": 11, "without": 11, "worri": 11, "purpos": 11, "hint": 11, "dummi": 11, "attn_pattern": 11, "str_token": 11, "attn_patterns_valu": 11, "solut": 11, "unnam": 11, "queri": 11, "previous": 11, "verifi": 11, "yourself": 11, "scratch": 11, "q_proj": 11, "k_proj": 11, "wari": 11, "harder": 11, "rough": 11, "intuit": 11, "focus": 11, "pair": 11, "30": 11, "familiar": 11, "antonym_pair": 11, "txt": 11, "skip": 11, "altern": 11, "ones": 11, "fill": 11, "generate_dataset": 11, "guid": 11, "chat": 11, "haven": 11, "guidanc": 11, "recommend": 11, "templat": 11, "chatcomplet": 11, "role": 11, "system": 11, "help": 11, "assist": 11, "antonym_task": 11, "start_of_respons": 11, "explain": 11, "start_of_respos": 11, "sure": 11, "example_antonym": 11, "old": 11, "young": 11, "top": 11, "bottom": 11, "awak": 11, "asleep": 11, "futur": 11, "past": 11, "me": 11, "obviou": 11, "associ": 11, "gpt4": 11, "classic": 11, "trick": 11, "rest": 11, "commonli": 11, "adversari": 11, "attack": 11, "possibl": 11, "solvabl": 11, "too": 11, "much": 11, "openai_kei": 11, "api_kei": 11, "pleas": 11, "t0": 11, "success": 11, "satiisfi": 11, "response_text": 11, "choic": 11, "comma": 11, "colon": 11, "word_pair": 11, "strip": 11, "finish": 11, "2f": 11, "100": 11, "w": 11, "write": 11, "r": 11, "readlin": 11, "volunt": 11, "compel": 11, "worst": 11, "big": 11, "bore": 11, "excit": 11, "brave": 11, "cowardli": 11, "firstli": 11, "antonymsequ": 11, "q": 11, "na": 11, "__len__": 11, "__getitem__": 11, "join": 11, "__str__": 11, "readabl": 11, "indep": 11, "word_list": 11, "hot": 11, "cold": 11, "seq": 11, "nactual": 11, "fed": 11, "gt": 11, "secondli": 11, "antonymdataset": 11, "chosen": 11, "seed": 11, "between": 11, "n_prepend": 11, "bidirect": 11, "revers": 11, "reproduc": 11, "enough": 11, "choos": 11, "random_pair": 11, "random_ord": 11, "create_corrupted_dataset": 11, "forget": 11, "mistak": 11, "add_row": 11, "repr": 11, "comedi": 11, "tragedi": 11, "harmoni": 11, "discord": 11, "vertic": 11, "horizont": 11, "courag": 11, "cowardic": 11, "inflat": 11, "deflat": 11, "marri": 11, "divorc": 11, "tenant": 11, "landlord": 11, "angel": 11, "devil": 11, "compet": 11, "cooper": 11, "giant": 11, "dwarf": 11, "liber": 11, "confin": 11, "human": 11, "anim": 11, "noisi": 11, "benefit": 11, "disadvantag": 11, "domest": 11, "foreign": 11, "unfaith": 11, "faith": 11, "minimum": 11, "maximum": 11, "solid": 11, "liquid": 11, "honest": 11, "deceit": 11, "light": 11, "heavi": 11, "empti": 11, "compar": 11, "stai": 11, "unconsci": 11, "hard": 11, "departur": 11, "exterior": 11, "knowledg": 11, "wisdom": 11, "interior": 11, "win": 11, "crimin": 11, "slave": 11, "folli": 11, "guilti": 11, "littl": 11, "clearli": 11, "termin": 11, "workshop": 11, "nice": 11, "toolbox": 11, "support": 11, "color": 11, "green": 11, "bold": 11, "underlin": 11, "dark_orang": 11, "b": 11, "cyan": 11, "col1": 11, "col2": 11, "cell": 11, "create_prompt": 11, "m": 11, "automat": 11, "vanish": 11, "appear": 11, "dark": 11, "te": 11, "test_calculate_h": 11, "understand": 11, "weak": 11, "fragil": 11, "strong": 11, "rigor": 11, "filter": 11, "display_model_completions_on_antonym": 11, "num_to_displai": 11, "match": 11, "min": 11, "correct_complet": 11, "correct_completion_first_token": 11, "whether": 11, "is_correct": 11, "uncorrupt": 11, "high": 11, "model_complet": 11, "sad": 11, "happi": 11, "fail": 11, "healthi": 11, "sick": 11, "major": 11, "minor": 11, "increas": 11, "decreas": 11, "slaveri": 11, "freedom": 11, "close": 11, "fantasi": 11, "realiti": 11, "wild": 11, "afraid": 11, "loos": 11, "tight": 11, "careless": 11, "calm": 11, "stormi": 11, "south": 11, "north": 11, "paradis": 11, "hell": 11, "fear": 11, "shallow": 11, "exclud": 11, "thin": 11, "thick": 11, "fast": 11, "slow": 11, "reject": 11, "modern": 11, "ancient": 11, "sane": 11, "insan": 11, "gentl": 11, "bui": 11, "sell": 11, "moral": 11, "immor": 11, "humbl": 11, "proud": 11, "arrog": 11, "arriv": 11, "depart": 11, "leav": 11, "low": 11, "stupid": 11, "smart": 11, "junior": 11, "senior": 11, "inferior": 11, "superior": 11, "wrote": 11, "unchang": 11, "taken": 11, "docstr": 11, "diagram": 11, "turn": 11, "onc": 11, "reshap": 11, "redefin": 11, "anyth": 11, "zero_shot_s": 11, "zero_shot_dataset": 11, "completions_intervent": 11, "row": 11, "token_complet": 11, "least": 11, "25": 11, "display_model_completions_on_h_intervent": 11, "completion_ni": 11, "completion_i": 11, "model_completions_intervent": 11, "great": 11, "parallel": 11, "complex": 11, "calculate_h_and_interven": 11, "mostli": 11, "rewrit": 11, "determinist": 11, "kept": 11, "shouldn": 11, "keep": 11, "seen": 11, "highest": 11, "extra": 11, "suppli": 11, "output_scor": 11, "return_dict_in_gener": 11, "similar": 11, "approach": 11, "fine": 11, "person": 11, "prefer": 11, "logprob": 11, "log": 11, "someth": 11, "likelihood": 11, "signific": 11, "know": 11, "gotcha": 11, "pick": 11, "calculate_h_and_intervene_logprob": 11, "correct_logprob": 11, "correct_logprobs_intervent": 11, "slice": 11, "d_vocab": 11, "log_softmax": 11, "correct_completion_id": 11, "tolist": 11, "display_model_logprobs_on_h_intervent": 11, "improv": 11, "logprob_ni": 11, "logprob_i": 11, "delta_logprob": 11, "zero_shot_prompt": 11, "is_improv": 11, "48": 11, "83": 11, "65": 11, "04": 11, "45": 11, "97": 11, "87": 11, "71": 11, "53": 11, "99": 11, "27": 11, "72": 11, "21": 11, "73": 11, "82": 11, "62": 11, "07": 11, "18": 11, "60": 11, "58": 11, "92": 11, "68": 11, "66": 11, "61": 11, "98": 11, "63": 11, "06": 11, "96": 11, "80": 11, "35": 11, "52": 11, "88": 11, "technic": 11, "complic": 11, "out_proj": 11, "sum": 11, "independ": 11, "anthrop": 11, "mathemat": 11, "framework": 11, "deal": 11, "easiest": 11, "per": 11, "basi": 11, "z": 11, "appropri": 11, "pretti": 11, "total": 11, "fowrad": 11, "intevent": 11, "tip": 11, "new_shap": 11, "new_valu": 11, "org": 11, "stabl": 11, "html": 11, "__": 11, "statement": 11, "rearrang": 11, "annot": 11, "calculate_fn_vectors_and_interven": 11, "cie": 11, "todo": 11, "constraint": 11, "hopefulli": 11, "fix": 11, "server": 11, "corrupted_dataset": 11, "a_dict": 11, "output_logit": 11, "red": 11, "logits_corrupt": 11, "logits_intervent": 11, "logprobs_corrupt": 11, "logprobs_intervent": 11, "reason": 11, "attach": 11, "85": 11, "165": 11, "empty_cach": 11, "_result": 11, "concat": 11, "indirect": 11, "width": 11, "height": 11, "600": 11, "aspect": 11, "equal": 11, "hardcod": 11, "post": 11, "matrix": 11, "matric": 11, "w_o": 11, "calculate_fn_vector": 11, "head_list": 11, "list_of_head": 11, "head_dict": 11, "z_dict": 11, "output_list": 11, "project": 11, "mix": 11, "attn_head_output_dict": 11, "test_calculate_fn_vector": 11, "chapter": 11, "came": 11, "hypothesi": 11, "stuff": 11, "mnager": 11, "th": 11, "overwrit": 11, "coupl": 11, "By": 11, "greedili": 11, "step": 11, "speed": 11, "less": 11, "blog": 11, "intervene_with_fn_vector": 11, "hope": 11, "qualit": 11, "prompt_templ": 11, "No": 11, "seem": 11, "normal": 11, "successfulli": 11, "ood": 11, "14": 11, "expens": 11, "completion_intervent": 11, "peopl": 11, "cheap": 11, "ppl": 11, "kinda": 11, "far": 11, "introduc": 11, "conceptu": 11, "idea": 11, "hold": 11, "fairli": 11, "repurpos": 11, "onlin": 11, "symmetr": 11, "generate_dataset_capit": 11, "portug": 11, "lisbon": 11, "ireland": 11, "dublin": 11, "chile": 11, "santiago": 11, "japan": 11, "tokyo": 11, "cc_word_pair": 11, "holdout": 11, "_cc_word_pair": 11, "tulip": 11, "windmil": 11, "chees": 11, "home": 11, "neither": 11, "author": 11, "dot": 11, "product": 11, "relat": 11, "evok": 11, "negat": 11, "counterpart": 11, "lesser": 11, "moscow": 11, "madrid": 11, "chose": 11, "inher": 11, "asymmetr": 11, "flip": 11, "spoiler": 11, "found": 11, "slightli": 11, "investig": 11, "sens": 11, "outperform": 11, "max_logit": 11, "identif": [], "ioi": [], "gave": [], "bottl": [], "redwood": [], "research": [], "excel": [], "studi": [], "kevin": [], "david": [], "bau": [], "rome": [], "goal": [], "metric": [], "recov": [], "clean_prompt": [], "corrupted_prompt": [], "incorrect": [], "clean_token": [], "corrupted_token": [], "logits_to_logit_diff": [], "correct_answ": [], "incorrect_answ": [], "correct_index": [], "incorrect_index": [], "clean_resid": [], "clean_logit": [], "corrupted_logit": [], "significantli": [], "capabl": [], "clean_logit_diff": [], "corrupted_logit_diff": [], "1235": [], "2725": [], "consider": [], "augment": [], "duplic": [], "loop": [], "180": [], "versu": [], "corrupted_tokens_list": [], "resid_pr": [], "po": [], "clean_resid_pr": [], "patched_logit": [], "extrem": [], "localis": [], "subject": [], "matter": [], "patched_result": [], "patching_result": [], "patched_logit_diff": [], "unsqueez": [], "temp_plot": []}, "objects": {"nnsight": [[1, 0, 0, "-", "Module"], [2, 0, 0, "-", "intervention"], [3, 0, 0, "-", "models"], [4, 0, 0, "-", "patching"], [5, 0, 0, "-", "tracing"], [6, 0, 0, "-", "util"]], "nnsight.Module": [[1, 1, 1, "", "Module"]], "nnsight.Module.Module": [[1, 2, 1, "", "input"], [1, 3, 1, "", "input_shape"], [1, 3, 1, "", "input_type"], [1, 3, 1, "", "module_path"], [1, 2, 1, "id1", "output"], [1, 3, 1, "", "output_shape"], [1, 3, 1, "", "output_type"], [1, 3, 1, "", "tracer"], [1, 4, 1, "", "wrap"]], "nnsight.intervention": [[2, 1, 1, "", "HookModel"], [2, 1, 1, "", "InterventionProxy"], [2, 1, 1, "", "TokenIndexer"], [2, 5, 1, "", "intervene"]], "nnsight.intervention.HookModel": [[2, 3, 1, "", "handles"], [2, 3, 1, "", "input_hook"], [2, 3, 1, "", "model"], [2, 3, 1, "", "modules"], [2, 3, 1, "", "output_hook"]], "nnsight.intervention.InterventionProxy": [[2, 4, 1, "", "save"], [2, 2, 1, "", "shape"], [2, 2, 1, "", "t"], [2, 2, 1, "", "token"], [2, 2, 1, "", "value"]], "nnsight.models": [[3, 0, 0, "-", "AbstractModel"], [3, 0, 0, "-", "DiffuserModel"], [3, 0, 0, "-", "LanguageModel"]], "nnsight.models.AbstractModel": [[3, 1, 1, "", "AbstractModel"]], "nnsight.models.AbstractModel.AbstractModel": [[3, 3, 1, "", "alter"], [3, 3, 1, "", "args"], [3, 3, 1, "", "custom_model"], [3, 3, 1, "", "dispatched"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "generate"], [3, 3, 1, "", "kwargs"], [3, 3, 1, "", "local_model"], [3, 3, 1, "", "meta_model"], [3, 4, 1, "", "modulize"], [3, 3, 1, "", "repoid_path_clsname"], [3, 3, 1, "", "tokenizer"]], "nnsight.models.DiffuserModel": [[3, 1, 1, "", "Diffuser"], [3, 1, 1, "", "DiffuserModel"]], "nnsight.models.DiffuserModel.DiffuserModel": [[3, 4, 1, "", "to_image"]], "nnsight.models.LanguageModel": [[3, 1, 1, "", "LanguageModel"]], "nnsight.models.LanguageModel.LanguageModel": [[3, 3, 1, "", "config"], [3, 3, 1, "", "local_model"], [3, 3, 1, "", "meta_model"], [3, 3, 1, "", "tokenizer"]], "nnsight.patching": [[4, 3, 1, "", "DEFAULT_PATCHER"], [4, 1, 1, "", "Patch"], [4, 1, 1, "", "Patcher"]], "nnsight.patching.Patch": [[4, 3, 1, "", "obj"], [4, 4, 1, "", "patch"], [4, 3, 1, "", "replacement"], [4, 4, 1, "", "restore"]], "nnsight.patching.Patcher": [[4, 4, 1, "", "add"], [4, 3, 1, "", "patches"]], "nnsight.tracing.Graph": [[5, 0, 0, "-", "Graph"]], "nnsight.tracing.Graph.Graph": [[5, 3, 1, "", "argument_node_names"], [5, 3, 1, "", "generation_idx"], [5, 3, 1, "", "module_proxy"], [5, 3, 1, "", "name_idx"], [5, 3, 1, "", "nodes"], [5, 3, 1, "", "proxy_class"]], "nnsight.tracing.Node": [[5, 0, 0, "-", "Node"]], "nnsight.tracing.Node.Node": [[5, 3, 1, "", "_proxy_device"], [5, 3, 1, "", "args"], [5, 3, 1, "", "dependencies"], [5, 3, 1, "", "graph"], [5, 3, 1, "", "kwargs"], [5, 3, 1, "", "listeners"], [5, 3, 1, "", "meta"], [5, 3, 1, "", "name"], [5, 3, 1, "", "proxy_value"], [5, 3, 1, "", "target"], [5, 3, 1, "", "value"]], "nnsight.tracing.Proxy": [[5, 0, 0, "-", "Proxy"]], "nnsight.tracing.Proxy.Proxy": [[5, 3, 1, "", "node"]], "nnsight.util": [[6, 1, 1, "", "WrapperModule"], [6, 5, 1, "", "apply"], [6, 5, 1, "", "cross_entropy_loss"], [6, 5, 1, "", "fetch_attr"], [6, 5, 1, "", "timed"], [6, 5, 1, "", "wrap"]], "nnsight.util.WrapperModule": [[6, 4, 1, "", "forward"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:property", "3": "py:attribute", "4": "py:method", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "property", "Python property"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"], "5": ["py", "function", "Python function"]}, "titleterms": {"document": [0, 7], "nnsight": [1, 2, 3, 4, 5, 6, 7, 11], "modul": 1, "intervent": 2, "model": [3, 10, 11], "patch": 4, "trace": 5, "util": 6, "get": 8, "start": 8, "instal": 8, "first": 8, "step": 8, "tutori": 9, "basic": [], "load": 10, "access": [], "activ": [], "interven": [10, 11], "search": [], "induct": [], "head": 11, "main": [10, 11], "demo": [10, 11], "run": [10, 11], "exampl": 10, "logit": [10, 11], "len": 10, "dure": 10, "forward": [10, 11], "pass": [10, 11], "ndif": 11, "notebook": 11, "content": 11, "learn": 11, "object": 11, "1": 11, "introduct": 11, "2": 11, "task": 11, "encod": 11, "hidden": 11, "state": 11, "3": 11, "function": 11, "vector": 11, "4": 11, "bonu": 11, "setup": 11, "import": 11, "syntax": 11, "config": 11, "token": 11, "output": 11, "transform": 11, "h": 11, "0": 11, "save": 11, "exercis": 11, "visual": 11, "attent": 11, "antonym": 11, "dataset": 11, "combin": 11, "calculate_h": 11, "intervene_with_h": 11, "comput": 11, "chang": 11, "accuraci": 11, "multi": 11, "gener": 11, "us": 11, "result": 11, "anoth": 11, "option": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Documentation": [[0, "documentation"]], "nnsight.Module": [[1, "module-nnsight.Module"]], "nnsight.models": [[3, "module-nnsight.models"]], "nnsight.patching": [[4, "nnsight-patching"]], "nnsight.tracing": [[5, "module-nnsight.tracing"]], "nnsight.util": [[6, "module-nnsight.util"]], "Getting Started": [[8, "getting-started"]], "Installation": [[8, "installation"]], "First Steps": [[8, "first-steps"]], "Tutorials": [[9, "tutorials"]], "Main Demo": [[10, "Main-Demo"]], "Loading and Running Models": [[10, "Loading-and-Running-Models"]], "Example: Logit Lens": [[10, "Example:-Logit-Lens"]], "Intervening during a forward pass": [[10, "Intervening-during-a-forward-pass"]], "NDIF Main Demo Notebook": [[11, "NDIF-Main-Demo-Notebook"]], "Content & Learning Objectives": [[11, "Content-&-Learning-Objectives"]], "1\ufe0f\u20e3 Introduction to nnsight": [[11, "1\ufe0f\u20e3-Introduction-to-nnsight"], [11, "id1"]], "2\ufe0f\u20e3 Task-encoding hidden states": [[11, "2\ufe0f\u20e3-Task-encoding-hidden-states"], [11, "id2"]], "3\ufe0f\u20e3 Function Vectors": [[11, "3\ufe0f\u20e3-Function-Vectors"], [11, "id3"]], "4\ufe0f\u20e3 Bonus": [[11, "4\ufe0f\u20e3-Bonus"], [11, "id4"]], "Setup": [[11, "Setup"]], "Important syntax": [[11, "Important-syntax"]], "Model config": [[11, "Model-config"]], "Tokenizers": [[11, "Tokenizers"]], "Model outputs": [[11, "Model-outputs"]], "Running the model": [[11, "Running-the-model"]], "model.transformer.h[-1]": [[11, "model.transformer.h[-1]"]], ".output[0]": [[11, ".output[0]"]], ".save()": [[11, ".save()"]], "Exercise - visualize attention heads": [[11, "Exercise---visualize-attention-heads"]], "Antonym Dataset": [[11, "Antonym-Dataset"]], "Exercise - run forward pass on antonym dataset": [[11, "Exercise---run-forward-pass-on-antonym-dataset"]], "Exercise - intervene with h": [[11, "Exercise---intervene-with-h"]], "Exercise - combine the functions calculate_h and intervene_with_h": [[11, "Exercise---combine-the-functions-calculate_h-and-intervene_with_h"]], "Logit outputs": [[11, "Logit-outputs"]], "Exercise - compute change in accuracy": [[11, "Exercise---compute-change-in-accuracy"]], "Multi-token generation": [[11, "Multi-token-generation"]], "Using nnsight for multi-token generation": [[11, "Using-nnsight-for-multi-token-generation"]], "Exercise - intervene with function vector, in multi-token generation": [[11, "Exercise---intervene-with-function-vector,-in-multi-token-generation"]], "Exercise - generalize results to another task (optional)": [[11, "Exercise---generalize-results-to-another-task-(optional)"]], "nnsight.intervention": [[2, "module-nnsight.intervention"]], "nnsight documentation": [[7, "nnsight-documentation"]]}, "indexentries": {}})