Search.setIndex({"docnames": ["documentation", "documentation/Module", "documentation/intervention", "documentation/models", "documentation/patching", "documentation/tracing", "documentation/util", "index", "start", "tutorials", "tutorials/basics", "tutorials/induction", "tutorials/main_demo", "tutorials/patching"], "filenames": ["documentation.rst", "documentation/Module.rst", "documentation/intervention.rst", "documentation/models.rst", "documentation/patching.rst", "documentation/tracing.rst", "documentation/util.rst", "index.rst", "start.rst", "tutorials.rst", "tutorials/basics.rst", "tutorials/induction.rst", "tutorials/main_demo.ipynb", "tutorials/patching.rst"], "titles": ["Documentation", "nnsight.Module", "nnsight.intervention", "nnsight.models", "nnsight.patching", "nnsight.tracing", "nnsight.util", "nnsight documentation", "Getting Started", "Tutorials", "Basics", "Searching for Induction Heads", "Main Demo", "Patching"], "terms": {"nnsight": [0, 8, 10, 12], "model": [0, 1, 2, 7, 8, 9, 11, 13], "modul": [0, 2, 3, 4, 5, 6, 7, 10, 12], "util": 0, "intervent": [0, 1, 3, 10, 13], "trace": [0, 2, 3], "patch": 0, "class": [1, 2, 3, 4, 5, 6], "meant": [1, 3], "wrap": [1, 3, 6], "exist": [1, 2], "torch": [1, 2, 3, 5, 6, 10, 11, 12], "within": [1, 3, 6, 10, 13], "": [1, 2, 3, 6, 9, 10, 11, 12, 13], "tree": [1, 12], "order": [1, 3], "add": [1, 2, 4, 13], "function": [1, 2, 3, 6, 7], "proxi": [1, 2, 5, 10, 12, 13], "output": [1, 2, 3, 10, 11, 12, 13], "input": [1, 2, 3, 6, 10, 12, 13], "ar": [1, 2, 3, 5, 6, 9, 10, 11, 12, 13], "access": [1, 2, 3, 13], "respect": [1, 13], "module_path": [1, 2], "string": [1, 6], "repres": [1, 4, 5, 13], "attribut": [1, 2, 3, 4, 6], "path": [1, 2, 3, 6], "thi": [1, 2, 3, 6, 8, 10, 11, 12, 13], "rel": [1, 2], "root": [1, 2, 3, 5, 6], "seperar": 1, "e": [1, 6], "x": [1, 3, 6, 12, 13], "transform": [1, 2, 3, 6, 10, 11, 13], "h": [1, 2, 3, 6, 10, 11, 13], "0": [1, 2, 3, 10, 12, 13], "mlp": [1, 2, 3, 12], "set": [1, 2, 10, 13], "abstractmodel": [1, 3], "intial": 1, "meta": [1, 3, 5], "type": [1, 2, 3, 4, 5, 6], "str": [1, 2, 3, 5, 6], "object": [1, 2, 3, 4, 6, 7, 10, 13], "reset": 1, "pass": [1, 3, 6, 9, 13], "through": [1, 2, 6, 12, 13], "interventionproxi": [1, 2], "output_shap": 1, "shape": [1, 2, 6, 10, 12, 13], "tensor": [1, 2, 3, 6, 10, 13], "popul": [1, 2, 10], "most": [1, 10], "recent": 1, "can": [1, 2, 10, 11, 12, 13], "also": [1, 3, 4, 10, 12], "nest": [1, 13], "list": [1, 2, 3, 4, 5, 12, 13], "size": [1, 2, 6, 10, 12], "output_typ": 1, "dtype": 1, "input_shap": 1, "input_typ": 1, "tracer": 1, "which": [1, 3, 6, 10, 11, 12, 13], "an": [1, 2, 4, 6, 10, 11, 12, 13], "graph": [1, 2, 3, 5, 10], "must": 1, "manual": 1, "context": [1, 2, 3, 4, 10, 12, 13], "properti": [1, 2], "call": [1, 2, 4, 6, 10, 13], "denot": [1, 2, 10], "user": [1, 2, 3], "wish": [1, 3, 10], "get": [1, 6, 7, 10, 12, 13], "therefor": 1, "we": [1, 3, 10, 11, 12, 13], "creat": [1, 10, 12, 13], "request": 1, "onli": [1, 2, 3, 6, 10, 12, 13], "gener": [1, 2, 3, 10, 11, 13], "first": [1, 2, 3, 6, 10, 11, 12], "time": [1, 6, 12, 13], "i": [1, 2, 3, 6, 7, 8, 10, 11, 12, 13], "refer": 1, "otherwis": 1, "return": [1, 2, 3, 6, 10, 12, 13], "alreadi": [1, 12], "one": [1, 3, 6, 10, 12], "static": 1, "our": [1, 12, 13], "forward": [1, 3, 6, 9], "hook": [1, 2, 3, 6], "data": [1, 6, 12], "doe": [1, 10, 12], "nn": [1, 2, 3], "modulelist": [1, 3, 12], "paramet": [1, 2, 3, 4, 6, 10, 12], "The": [1, 2, 3, 7, 10, 11, 12, 13], "hookmodel": 2, "input_hook": 2, "option": [2, 4, 5, 6], "callabl": [2, 5, 6], "none": [2, 3, 4, 5], "output_hook": 2, "manag": [2, 3, 4], "appli": [2, 3, 6, 8, 10, 12, 13], "regist": [2, 6], "provid": [2, 7], "__enter__": [2, 4], "remov": 2, "them": [2, 3, 6], "__exit__": [2, 4], "along": [2, 10], "tupl": [2, 10, 12], "design": [2, 13], "should": [2, 6], "have": [2, 7, 8, 13], "signatur": 2, "ani": [2, 3, 4, 5, 6, 10, 12], "handl": 2, "from": [2, 3, 4, 6, 9, 10, 11, 12, 13], "us": [2, 3, 5, 6, 7, 10, 11, 12, 13], "when": [2, 3, 10, 13], "removablehandl": 2, "node": [2, 5], "sub": [2, 3], "addit": 2, "exampl": [2, 3, 7, 8, 9, 10], "save": [2, 3, 10, 11, 12, 13], "so": [2, 5, 11, 12], "both": [2, 3], "clone": [2, 10], "point": [2, 10, 11], "execut": [2, 3, 6, 12], "delet": 2, "complet": [2, 12, 13], "listen": [2, 5], "enabl": [2, 3], "invok": [2, 3, 10, 11, 12, 13], "eiffel": [2, 3, 10], "tower": [2, 3, 10], "citi": [2, 3, 10, 12], "hidden_st": [2, 10], "lm_head": [2, 3, 10, 11, 13], "logit": [2, 3, 6, 9, 11, 13], "print": [2, 3, 6, 10, 12, 13], "valu": [2, 3, 5, 10, 11, 12, 13], "work": [2, 10, 12], "would": [2, 12, 13], "had": 2, "you": [2, 3, 8, 10], "thrown": 2, "error": 2, "index": [2, 10, 12, 13], "token": [2, 3, 6, 10, 11, 12, 13], "hidden": [2, 10, 12], "state": [2, 3, 10, 12], "easili": 2, "done": 2, "idx": 2, "t": [2, 10, 12, 13], "collect": [2, 3, 6], "actual": [2, 3, 10, 12], "updat": [2, 6], "dure": [2, 9, 10], "throw": 2, "method": [2, 3, 6], "indic": [2, 12], "result": [2, 10, 12, 13], "union": [2, 3, 5], "retriev": [2, 6], "tokenindex": 2, "alia": 2, "do": [2, 10, 13], "base": 2, "directli": [2, 3], "second": [2, 11, 12, 13], "dimens": [2, 13], "make": [2, 12], "posit": [2, 3, 11, 12, 13], "indici": 2, "neg": [2, 13], "pad": 2, "left": 2, "equival": 2, "3": [2, 3, 10, 12], "For": [2, 8, 10, 12], "store": [2, 12, 13], "helper": [2, 6], "aid": 2, "interven": [2, 9, 13], "activ": [2, 3, 12, 13], "kei": [2, 7, 10, 13], "entri": 2, "all": [2, 3, 6, 7, 8, 10, 13], "involv": [2, 5], "form": 2, "current": [2, 11], "check": [2, 3, 7, 8, 10], "argument_node_nam": [2, 5], "If": [2, 3, 6, 8, 10, 12], "name": [2, 3, 5], "iter": [2, 3, 13], "arg": [2, 3, 5, 6], "argument": [2, 3, 6, 10], "batch_siz": [2, 11], "batch_start": 2, "narrow": 2, "select": 2, "batch": [2, 3, 6, 11, 13], "relev": [2, 12, 13], "view": 2, "oppos": 2, "copi": [2, 11], "allow": [2, 3, 10], "subsequ": [2, 11], "downstream": [2, 3], "edit": [2, 10], "origin": [2, 4, 9, 12], "prevent": 2, "effect": 2, "bath": 2, "outsid": 2, "perview": 2, "either": [2, 3], "interleav": [2, 3], "comput": [2, 3, 5, 6, 10, 12, 13], "potenti": 2, "modifi": 2, "contain": [3, 7, 10], "main": [3, 9], "packag": [3, 7, 8], "load": [3, 9, 11, 13], "here": [3, 10, 12, 13], "gpt2": [3, 10, 11, 13], "huggingfac": [3, 12], "its": [3, 10, 11, 13], "repo": [3, 10, 12], "id": [3, 6, 10, 11, 12], "languagemodel": [3, 10, 11, 12, 13], "import": [3, 4, 11, 12, 13], "device_map": [3, 10, 11, 12, 13], "cuda": [3, 10, 12, 13], "In": [3, 10, 12], "case": [3, 12], "mean": [3, 11, 12], "underli": [3, 13], "automodelforcausallm": 3, "unus": 3, "ultim": 3, "leverag": 3, "acceler": 3, "gpu": [3, 12], "local_model": 3, "further": 3, "encapsul": 3, "out": [3, 4, 7, 8, 10, 12], "structur": [3, 12, 13], "well": 3, "meta_model": 3, "demonstr": 3, "like": [3, 8, 10, 12, 13], "gpt2lmheadmodel": 3, "gpt2model": 3, "wte": 3, "embed": [3, 12], "50257": 3, "768": [3, 10], "wpe": 3, "1024": 3, "drop": 3, "dropout": [3, 12], "p": [3, 12], "1": [3, 6, 10, 11, 12, 13], "inplac": [3, 12], "fals": [3, 6, 11, 12], "11": [3, 10, 12], "12": [3, 10, 12, 13], "gpt2block": 3, "ln_1": 3, "layernorm": [3, 12], "ep": [3, 12], "1e": [3, 12], "05": [3, 12], "elementwise_affin": [3, 12], "true": [3, 6, 10, 11, 12], "attn": [3, 10, 11], "gpt2attent": 3, "c_attn": 3, "conv1d": 3, "c_proj": 3, "attn_dropout": 3, "resid_dropout": 3, "ln_2": 3, "gpt2mlp": 3, "c_fc": 3, "act": [3, 12], "newgeluactiv": 3, "ln_f": 3, "linear": [3, 12], "in_featur": [3, 12], "out_featur": [3, 12], "bia": [3, 12], "two": [3, 10, 11], "interact": 3, "run": [3, 6, 9, 10, 13], "enter": 3, "track": [3, 12], "oper": [3, 10], "perform": [3, 6, 10, 13], "multi": 3, "infer": [3, 10], "determin": 3, "behavior": 3, "three": 3, "where": [3, 10, 13], "accept": 3, "other": [3, 10], "invoc": [3, 10], "It": 3, "prepar": 3, "prompt": [3, 10, 12, 13], "languag": [3, 10, 11, 12], "after": [3, 6, 10, 11, 12, 13], "over": [3, 12], "max_new_token": [3, 10, 11, 13], "logits1": 3, "empir": 3, "build": 3, "logits2": 3, "runner": 3, "direct": 3, "train": 3, "mode": 3, "gradient": 3, "repoid_path_model": 3, "alter": 3, "bool": [3, 6], "kwarg": [3, 5, 6], "abstract": 3, "implment": 3, "pytorch": 3, "gain": 3, "repoid_path_clsnam": 3, "hug": [3, 10], "face": [3, 10], "checkpoint": 3, "custom": 3, "initi": [3, 10, 13], "keyword": 3, "dict": [3, 5, 12], "dispatch": 3, "ha": [3, 6, 13], "bee": 3, "yet": [3, 7, 8, 12], "custom_model": 3, "wa": [3, 12], "version": 3, "devic": [3, 5, 10, 11, 13], "ad": [3, 10], "_typ_": 3, "local": 3, "ran": [3, 10], "intervetnion": 3, "singl": 3, "specif": [3, 7, 10, 12, 13], "_run_loc": 3, "A": 3, "simpl": [3, 6], "some": [3, 6, 8, 10, 12], "process": [3, 10], "_gener": 3, "tandem": 3, "limit": 3, "amount": 3, "predict": [3, 11, 13], "see": [3, 7, 8, 10, 11, 12, 13], "doc": 3, "more": [3, 7, 8, 10, 12], "inform": [3, 7, 10, 12, 13], "node_nam": 3, "module_nam": 3, "_summary_": [3, 5], "_description_": [3, 5], "diffusermodel": 3, "diffus": 3, "repoid_or_path": 3, "cliptoken": 3, "to_imag": 3, "latent": 3, "imag": 3, "convert": 3, "obj": 4, "replac": 4, "carri": [4, 10], "importlib": 4, "import_modul": 4, "self": 4, "__module__": 4, "And": 4, "setattr": 4, "__name__": 4, "restor": [4, 12], "nthe": 4, "patcher": 4, "wrappermodul": 6, "element": 6, "defin": [6, 10], "everi": 6, "overridden": 6, "subclass": 6, "although": 6, "recip": 6, "need": [6, 10], "instanc": 6, "afterward": 6, "instead": 6, "sinc": [6, 12], "former": 6, "take": [6, 10], "care": 6, "while": 6, "latter": 6, "silent": 6, "ignor": 6, "fn": 6, "cl": 6, "member": 6, "give": [6, 12], "same": [5, 6], "kind": 6, "been": [6, 7, 8], "memeb": 6, "given": [5, 6, 10, 12], "cross_entropy_loss": [6, 10, 11], "target_id": 6, "shift": [6, 10, 11], "avg_batch": 6, "avg_token": [6, 11], "cross": 6, "entropi": 6, "loss": [6, 10, 11], "n": 6, "featur": [6, 7, 8, 10], "target": [5, 6], "last": [6, 10], "default": [5, 6], "averag": [6, 11], "across": 6, "fetch_attr": 6, "hierarchi": 6, "level": 6, "seper": 6, "fetch": 6, "func": 6, "lggr": 6, "decor": 6, "wrapper": 6, "__class__": 6, "__init__": 6, "\u025bn": [7, 8], "sa\u026at": [7, 8], "interpret": [7, 8], "manipul": [7, 8], "intern": [7, 8, 10, 12], "deep": [7, 8], "learn": [7, 8], "link": 7, "start": [7, 12, 13], "instal": 7, "tutori": [7, 8], "colab": [7, 8, 10], "step": [], "basic": 8, "search": [], "induct": [], "head": [10, 13], "To": [8, 11, 12], "pip": 8, "section": [7, 8], "how": [8, 12, 13], "d": [8, 10], "hand": [8, 12], "experi": 8, "cover": [8, 10], "Not": [7, 8], "document": 8, "github": [7, 8], "sever": 9, "adapt": 9, "neel": 9, "nanda": 9, "transformerlen": 9, "demo": [9, 10], "notebook": 10, "engin": [10, 13], "api": [10, 13], "follow": [10, 11], "With": 10, "open": 10, "sourc": [7, 10], "llm": 10, "referenc": 10, "ll": [10, 12, 13], "look": [10, 11], "gpt": [10, 11, 13], "2": [10, 11, 12, 13], "small": [10, 11, 13], "80m": 10, "declar": [10, 11, 13], "onto": [10, 11, 12, 13], "text": 10, "decod": [10, 12, 13], "pari": [10, 12], "let": [10, 11, 12, 13], "break": [10, 12], "down": [10, 12], "piec": 10, "block": 10, "exit": [10, 12, 13], "later": [10, 12], "specifi": [10, 12], "want": [10, 12], "varieti": 10, "format": 10, "final": [10, 12, 13], "raw": 10, "But": [10, 11], "what": 10, "black": 10, "box": 10, "gpt2_text": 10, "natur": [10, 13], "task": [10, 13], "gpt2_token": 10, "encod": [10, 12, 13], "focu": 10, "highlight": 10, "line": [10, 11, 12], "layer": [10, 11, 12, 13], "Then": 10, "word": 10, "grab": 10, "becom": [10, 12], "0th": 10, "anoth": 10, "10": [10, 11, 12], "64": 10, "becaus": [10, 13], "attent": [10, 11, 12], "eventu": 10, "similarli": 10, "u": [10, 13], "longer": [10, 12], "ever": 10, "dereferenc": 10, "destroi": 10, "35364": 10, "3303": 10, "7587": 10, "8861": 10, "884": 10, "355": 10, "1808": 10, "18877": 10, "4572": 10, "11059": 10, "3555": 10, "35915": 10, "290": 10, "15676": 10, "1634": 10, "389": 10, "6032": 10, "10448": 10, "351": 10, "28679": 10, "4673": 10, "319": 10, "431": 10, "7790": 10, "40522": 10, "13": [10, 12], "2102": 10, "2059": 10, "1688": 10, "0503": 10, "3703": 10, "2015": 10, "6594": 10, "9412": 10, "2137": 10, "8": [10, 12, 13], "5667": 10, "6": [10, 12], "3562": 10, "4": [10, 12, 13], "1276": 10, "6006": 10, "0798": 10, "5781": 10, "1944": 10, "8023": 10, "5": [10, 12], "6864": 10, "6289": 10, "1180": 10, "4320": 10, "20": 10, "7147": 10, "7145": 10, "3738": 10, "4004": 10, "1358": 10, "9569": 10, "3060": 10, "7": [10, 12, 13], "1600": 10, "6868": 10, "9850": 10, "7206": 10, "7800": 10, "1185": 10, "1680": 10, "7024": 10, "2865": 10, "assign": 10, "flow": 10, "As": [10, 12], "ablat": 10, "abov": [10, 12], "layer_to_abl": 10, "head_index_to_abl": 10, "normal_lm_head": 10, "attention_pattern": 10, "ablated_lm_head": 10, "observ": 10, "notic": 10, "chang": [10, 12], "tensor_token": 10, "0187": 10, "2913": 10, "circuit": [11, 13], "veri": 11, "detect": 11, "continu": [11, 13], "repeat": 11, "thei": 11, "consist": [11, 12], "separ": 11, "compos": 11, "togeth": 11, "previou": [5, 11], "alwai": 11, "attend": 11, "earlier": 11, "why": 11, "sai": 11, "try": 11, "next": 11, "new": 11, "articl": 11, "about": [11, 12], "michael": 11, "jordan": 11, "could": 11, "mani": 11, "surnam": 11, "occur": 11, "ie": [11, 13], "confid": [11, 12], "come": 11, "interest": 11, "fact": 11, "generalis": 11, "arbitrari": 11, "sequenc": [11, 13], "50": 11, "random": 11, "twice": 11, "plot": 11, "goe": 11, "terribl": 11, "good": 11, "halfwai": 11, "seq_len": [11, 13], "random_token": 11, "randint": 11, "1000": 11, "10000": 11, "repeated_token": 11, "einop": 11, "token_id": [11, 12], "xaxi": [11, 13], "yaxi": [11, 13], "titl": [11, 12, 13], "each": [11, 12, 13], "49": 11, "place": 11, "back": 11, "paid": 11, "identifi": [11, 13], "output_attent": 11, "attn_hidden_st": 11, "layer_idx": 11, "rang": [11, 12, 13], "len": [9, 11, 13], "stack": 11, "diagon": 11, "dim1": 11, "dim2": 11, "offset": 11, "induction_scor": 11, "cpu": 11, "imshow": [11, 12, 13], "score": 11, "indirect": 13, "identif": 13, "ioi": 13, "sentenc": 13, "john": [12, 13], "mari": [12, 13], "went": [12, 13], "gave": 13, "bottl": 13, "milk": [12, 13], "rather": 13, "than": 13, "find": 13, "redwood": 13, "research": 13, "excel": 13, "paper": 13, "studi": 13, "techniqu": [12, 13], "kevin": 13, "meng": [12, 13], "david": 13, "bau": 13, "rome": 13, "goal": 13, "up": 13, "clean": [12, 13], "corrupt": [12, 13], "metric": 13, "pick": 13, "much": 13, "recov": 13, "clean_prompt": 13, "corrupted_prompt": 13, "differ": 13, "between": 13, "correct": [12, 13], "incorrect": 13, "clean_token": 13, "corrupted_token": 13, "def": [12, 13], "logits_to_logit_diff": 13, "correct_answ": 13, "incorrect_answ": 13, "correct_index": 13, "incorrect_index": 13, "clean_resid": 13, "clean_logit": 13, "append": [12, 13], "corrupted_logit": 13, "note": 13, "python": 13, "residu": [12, 13], "stream": [12, 13], "re": 13, "numpi": 13, "arrai": 13, "below": 13, "significantli": 13, "show": [12, 13], "capabl": 13, "clean_logit_diff": 13, "corrupted_logit_diff": 13, "1235": 13, "2725": 13, "consider": 13, "made": 13, "augment": 13, "By": 13, "duplic": 13, "now": [12, 13], "d_model": 13, "loop": 13, "compar": 13, "180": 13, "versu": 13, "n_layer": [12, 13], "corrupted_tokens_list": 13, "tqdm": 13, "resid_pr": 13, "po": 13, "clean_resid_pr": 13, "patched_logit": 13, "visual": [12, 13], "extrem": 13, "localis": 13, "subject": 13, "matter": 13, "remain": 13, "until": [12, 13], "move": [12, 13], "9": [12, 13], "patched_result": 13, "np": 13, "zero": [12, 13], "16": [12, 13], "patching_result": 13, "patched_logit_diff": 13, "unsqueez": 13, "end": 13, "label": [12, 13], "plotli": [12, 13], "doesn": 13, "token_label": 13, "f": [12, 13], "_": [12, 13], "enumer": 13, "temp_plot": 13, "normal": 13, "fx": 5, "proxy_class": 5, "map": 5, "name_idx": 5, "target_nam": 5, "number": 5, "uniqu": 5, "int": 5, "module_proxi": 5, "generation_idx": 5, "proxy_valu": 5, "desc": 5, "depend": 5, "_proxy_devic": 5, "ndif": [], "setup": [], "introduct": [], "No": [], "read": [], "googl": [], "in_colab": [], "unzip": [], "wget": [], "o": [], "dev": [], "zip": 12, "http": [], "drive": [], "com": [], "uc": [], "1js0ydba19upxcc786_sx1bylqx": [], "p0hec": [], "export": [], "download": 12, "necessari": [], "librari": [], "circuitsvi": [], "jaxtyp": [], "transformer_len": [], "upgrad": [], "pydant": [], "without": [], "field_seri": [], "isn": [], "avail": [], "except": [], "jupyt": [], "2023": [], "19": [], "07": [], "15": 12, "resolv": [], "108": [], "177": [], "127": [], "113": [], "102": [], "138": [], "connect": [], "443": [], "sent": [], "await": [], "respons": [], "303": [], "locat": 12, "0k": [], "6o": [], "googleusercont": [], "securesc": [], "ha0ro937gcuc7l7deffksulhg5h7mbp1": [], "5dktb6ub5adjdpvc94ogms58d8m7ovit": [], "1697745975000": [], "03673451779721625206": [], "uuid": [], "bab92a10": [], "ce6f": [], "41f5": [], "931a": [], "304ce000368c": [], "warn": [], "wildcard": [], "support": [], "18": [], "172": [], "217": [], "218": [], "132": [], "2a00": [], "1450": [], "4013": [], "c08": [], "84": [], "200": [], "ok": [], "length": [], "711907": [], "695k": [], "applic": [], "100": [], "gt": [], "695": [], "22k": [], "kb": [], "006": [], "mb": [], "archiv": [], "1a29996e0dcf59c8b2c08f33ed618be247f7d7c2": [], "workflow": [], "inflat": [], "app": [], "yml": [], "gitignor": [], "readm": [], "md": [], "py": [], "extract": 12, "config": [], "yaml": [], "editor": [], "graphedit": [], "wrappermoduleedit": [], "logger": [], "test": [], "conftest": [], "test_lm": [], "toolbox": [], "optim": [], "lora": [], "softprompt": [], "adhoc_modul": [], "multitoken": [], "optim2": [], "test_serv": [], "test_server_llama": [], "tl": [], "ipynb_checkpoint": [], "ipynb": [], "main_demo": [], "pyproject": [], "toml": [], "server": [], "responsedict": [], "__main__": [], "download_model": [], "environ": [], "processor": [], "modelprocessor": [], "requestprocessor": [], "signalprocessor": [], "cfg": [], "obtain": [], "file": [], "content": [], "backend": [], "build_edit": [], "requir": [], "metadata": [], "34": [], "py3": [], "whl": [], "30": [], "eta": [], "00": [], "satisfi": [], "protobuf": [], "usr": [], "lib": [], "python3": [], "dist": [], "socketio": [], "client": [], "python_socketio": [], "74": [], "lt": [], "14": [], "cp310": [], "manylinux_2_17_x86_64": [], "manylinux2014_x86_64": [], "62": [], "cu118": [], "sentencepiec": [], "99": [], "81": [], "torchvis": [], "23": [], "258": [], "28": [], "21": [], "82": [], "17": [], "psutil": [], "pyyaml": [], "hub": [], "huggingface_hub": [], "301": [], "302": [], "31": [], "filelock": [], "extens": [], "sympi": [], "networkx": [], "jinja2": [], "fsspec": [], "triton": [], "pillow": [], "regex": [], "2019": [], "safetensor": [], "68": [], "bidict": [], "22": [], "engineio": [], "python_engineio": [], "56": [], "websocket": [], "54": [], "info": [], "compat": [], "33": [], "77": [], "27": [], "66": [], "simple_websocket": [], "charset": [], "idna": [], "urllib3": [], "certifi": [], "2017": [], "zipp": [], "markupsaf": [], "mpmath": [], "wsproto": [], "24": [], "h11": [], "58": [], "wheel": [], "filenam": [], "6022": [], "sha256": [], "8f45508789a8b50665bf9039b1787df3b3b51ff75b073738d29ab3b77578b429": [], "directori": [], "tmp": [], "ephem": [], "cach": 12, "szdtuv7r": [], "fd": [], "c4": [], "df7c4cde8ec8a0c223d8f35c1bda4921c5b64dd9c96acada66": [], "successfulli": [], "built": [], "42": [], "26": [], "78": [], "nvidia": [], "cubla": [], "cu12": [], "nvidia_cublas_cu12": [], "manylinux1_x86_64": [], "410": [], "cupti": [], "105": [], "nvidia_cuda_cupti_cu12": [], "101": [], "nvrtc": [], "nvidia_cuda_nvrtc_cu12": [], "runtim": [], "nvidia_cuda_runtime_cu12": [], "823": [], "61": [], "cudnn": [], "nvidia_cudnn_cu12": [], "731": [], "cufft": [], "nvidia_cufft_cu12": [], "121": [], "curand": [], "106": [], "nvidia_curand_cu12": [], "cusolv": [], "107": [], "nvidia_cusolver_cu12": [], "124": [], "cuspars": [], "nvidia_cusparse_cu12": [], "196": [], "nccl": [], "nvidia_nccl_cu12": [], "209": [], "nvtx": [], "nvidia_nvtx_cu12": [], "nvjitlink": [], "nvidia_nvjitlink_cu12": [], "52": [], "95": [], "attempt": [], "uninstal": [], "found": [], "39": [], "account": [], "behaviour": [], "conflict": [], "lida": [], "fastapi": [], "kaleido": [], "multipart": [], "uvicorn": [], "cupi": [], "cuda11x": [], "incompat": [], "numba": [], "tensorflow": [], "44": [], "29": [], "typeguard": [], "beartyp": [], "739": [], "dataset": [], "519": [], "fanci": [], "einsum": [], "fancy_einsum": [], "panda": [], "rich": [], "25": [], "wandb": [], "pyarrow": [], "dill": [], "115": [], "xxhash": [], "multiprocess": [], "70": [], "py310": [], "134": [], "aiohttp": [], "dateutil": [], "pytz": [], "2020": [], "post1": [], "markdown": [], "pygment": [], "click": [], "gitpython": [], "40": [], "190": [], "sentri": [], "sdk": [], "sentry_sdk": [], "32": [], "py2": [], "240": [], "241": [], "docker": [], "pycr": [], "docker_pycr": [], "pathtool": [], "tar": [], "gz": [], "setproctitl": [], "manylinux_2_5_x86_64": [], "setuptool": [], "67": [], "appdir": [], "six": [], "attr": [], "multidict": [], "async": [], "timeout": [], "0a3": [], "yarl": [], "frozenlist": [], "aiosign": [], "gitdb": [], "mdurl": [], "smmap": [], "8791": [], "c87bee03575a6c8124f68f82c2a7eed77a2e2c4e72af7d92efb4b46b6289c48d": [], "e7": [], "f3": [], "152153d6eb222ee7a56ff8617d80ee5207207a8c00a7aab794": [], "395": [], "annot": [], "annotated_typ": [], "core": [], "pydantic_cor": [], "typing_extens": [], "llmx": [], "15a0": [], "coher": [], "openai": [], "tiktoken": [], "sy": [], "cv": [], "express": 12, "px": 12, "pathlib": [], "float": [], "ipython": [], "displai": [], "webbrows": [], "is_avail": [], "els": [], "turn": [], "automat": [], "differenti": [], "off": [], "memori": [], "focus": [], "set_grad_en": [], "autograd": [], "grad_mod": [], "0x7bf2119cf7f0": [], "render": [], "to_numpi": [], "color_continuous_midpoint": 12, "color_continuous_scal": 12, "rdbu": 12, "y": 12, "scatter": [], "caxi": [], "color": [], "coupl": [], "servic": [], "nation": [], "inferenc": [], "framework": [], "parmet": [], "believ": [], "understand": [], "ai": [], "cognit": [], "greatest": [], "scientif": [], "question": [], "ag": [], "itself": [], "yield": [], "progress": [], "massiv": [], "public": [], "undertak": [], "bridg": [], "experiment": [], "platform": [], "democrat": [], "transpar": [], "big": [], "mechanist": [], "larg": [], "revers": [], "algorithm": [], "weight": 12, "world": [], "todai": [], "program": [], "essenti": [], "speak": [], "english": [], "human": [], "palm": [], "etc": [], "idea": [], "nor": [], "write": [], "ourselv": [], "repo_id": [], "debug": [], "module_0": [], "del": [], "pad_token_id": [], "eos_token_id": [], "50256": [], "argument_0": [], "__getitem___0": [], "proxy_save_0": [], "go": [], "answer": 12, "machin": 12, "translat": [], "comprehens": [], "summar": [], "typic": [], "approach": [], "supervis": [], "taskspecif": [], "onc": [], "again": 12, "On": [], "statement": [], "There": [], "know": [], "gpt2attentionalt": [], "queri": [], "That": [], "lot": [], "put": [], "practic": [], "q": [], "k": [], "attn_pattern": [], "argument_1": [], "proxy_save_1": [], "argument_2": [], "proxy_save_2": [], "pattern": [], "head_idx": [], "seq_q": [], "seq_k": [], "verifi": [], "dim": 12, "layer0_attn_scor": [], "head_dim": [], "mask": [], "triu": [], "ones": [], "masked_fill_": [], "1e9": [], "scale": [], "softmax": 12, "layer0_pattern_from_q_and_k": [], "comparison": [], "calcul": [], "equal": [], "individu": [], "percentag": [], "bool_matrix": [], "num_tru": [], "sum": [], "item": 12, "total": [], "matrix": [], "total_valu": [], "numel": [], "percent_tru": [], "nice": [], "alan": [], "coonei": [], "anthrop": [], "pysvelt": [], "hover": [], "lock": [], "grid": [], "top": [], "destin": [], "lower": [], "triangular": [], "causal": 12, "backward": [], "network": [], "65": [], "subplot": [], "sp": [], "io": [], "pio": [], "graph_object": [], "head_1": [], "imshow_fig": [], "img": [], "87": [], "gpt2_str_token": [], "One": 12, "great": [], "thing": [], "neural": [], "full": [], "control": [], "system": [], "perspect": [], "exactli": [], "insid": 12, "even": 12, "don": [], "precis": [], "surgic": [], "power": [], "tool": 7, "counterfactu": [], "accordingli": [], "being": 12, "abl": [], "pretti": [], "affect": [], "howev": [], "explicitli": [], "compon": 12, "head_index": [], "abal": [], "abalated_lm_head": [], "update_0": [], "somewhat": [], "argument_3": [], "proxy_save_3": [], "argument_4": [], "proxy_save_4": [], "argument_5": [], "proxy_save_5": [], "argument_6": [], "proxy_save_6": [], "argument_7": [], "proxy_save_7": [], "argument_8": [], "proxy_save_8": [], "argument_9": [], "proxy_save_9": [], "argument_10": [], "proxy_save_10": [], "argument_11": [], "proxy_save_11": [], "argument_12": [], "proxy_save_12": [], "argument_13": [], "proxy_save_13": [], "__getitem___1": [], "__getitem___2": [], "update_1": [], "__getitem___3": [], "update_2": [], "__getitem___4": [], "update_3": [], "__getitem___5": [], "update_4": [], "__getitem___6": [], "update_5": [], "__getitem___7": [], "update_6": [], "__getitem___8": [], "update_7": [], "__getitem___9": [], "update_8": [], "__getitem___10": [], "update_9": [], "__getitem___11": [], "update_10": [], "__getitem___12": [], "update_11": [], "__getitem___13": [], "update_12": [], "__getitem___14": [], "update_13": [], "__getitem___15": [], "update_14": [], "__getitem___16": [], "update_15": [], "04": [], "09": [], "06": [], "86": [], "69": [], "08": [], "75": [], "83": [], "92": [], "02": [], "43": [], "chart_json": [], "to_json": [], "temp_val": [], "json": [], "w": [], "threshold": [], "03": [], "whatev": [], "desir": 12, "arr": [], "ab": [], "91": [], "numpy_loss": [], "temp_fig": [], "chart_schema": [], "88": [], "97": [], "highli": [], "feed": [], "shorter": [], "includ": 7, "stripe": [], "induction_head_lay": [], "induction_head_index": [], "single_random_sequ": [], "repeated_random_sequ": [], "overview": [], "hidden_states1": [], "hidden_states2": [], "hidden_states3": [], "side": [], "just": [], "madison": [], "squar": [], "garden": [], "york": [], "pre": [], "shown": [], "0063": [], "1795": [], "2060": [], "1978": [], "1870": [], "1588": [], "1256": [], "0201": [], "0853": [], "0117": [], "1322": [], "0054": [], "1283": [], "1087": [], "1027": [], "0407": [], "1525": [], "0030": [], "0874": [], "1263": [], "0033": [], "1747": [], "0309": [], "0572": [], "0183": [], "0333": [], "0689": [], "0931": [], "0714": [], "1341": [], "0436": [], "2236": [], "1965": [], "0693": [], "1080": [], "usual": [], "chain": [], "vocabularli": [], "space": [], "argmax": [], "vocabulari": [], "36": [], "2874": [], "35": [], "0114": [], "38": [], "0793": [], "5163": [], "41": [], "3759": [], "9193": [], "8886": [], "1562": [], "71": [], "8408": [], "80": [], "4195": [], "2552": [], "1206": [], "2950": [], "6519": [], "9941": [], "94": [], "4878": [], "5194": [], "85": [], "6998": [], "8675": [], "111": [], "8628": [], "6634": [], "116": [], "7652": [], "114": [], "8267": [], "112": [], "3621": [], "8531": [], "3006": [], "8192": 12, "9943": [], "89": [], "8382": [], "6898": [], "103": [], "9307": [], "5054": [], "1563": [], "109": [], "3099": [], "110": [], "1395": [], "198": [], "417": [], "8765": [], "318": [], "257": [], "262": [], "3504": [], "7372": [], "6342": [], "el": [], "middl": [], "centr": [], "home": [], "juang": [], "c": [], "miniconda3": [], "env": [], "interp": [], "site": [], "1260": [], "userwarn": [], "agnost": [], "max_length": [], "thegener": [], "recommend": [], "maximum": [], "share": [], "smark": [], "auto": [], "tqdmwarn": [], "iprogress": [], "pleas": [], "ipywidget": [], "readthedoc": [], "en": [], "stabl": [], "user_instal": [], "html": [], "autonotebook": [], "notebook_tqdm": [], "pretrain": 12, "eleutherai": 12, "1b": 12, "pythia": 12, "command": 12, "configur": 12, "your": 12, "though": 12, "still": 12, "inspect": 12, "gptneoxforcausallm": 12, "gpt_neox": 12, "gptneoxmodel": 12, "embed_in": 12, "50304": 12, "2048": 12, "emb_dropout": 12, "gptneoxlay": 12, "input_layernorm": 12, "post_attention_layernorm": 12, "post_attention_dropout": 12, "post_mlp_dropout": 12, "gptneoxattent": 12, "rotary_emb": 12, "gptneoxrotaryembed": 12, "query_key_valu": 12, "6144": 12, "dens": 12, "attention_dropout": 12, "gptneoxmlp": 12, "dense_h_to_4h": 12, "dense_4h_to_h": 12, "geluactiv": 12, "final_layer_norm": 12, "embed_out": 12, "last_hidden_st": 12, "aren": 12, "tell": 12, "modif": 12, "detail": [7, 12], "probabl": 12, "treat": 12, "intermedi": 12, "crude": 12, "approxim": 12, "norm": 12, "unembed": 12, "all_prob": 12, "prob": 12, "distribut": 12, "evolv": 12, "mary_token": 12, "input_id": 12, "layer_prob": 12, "accord": 12, "suggest": 12, "begin": 12, "realiz": 12, "few": 12, "consid": 12, "countri": 12, "best": 12, "guess": 12, "franc": 12, "tok": 12, "topk": 12, "3f": 12, "425": 12, "096": 12, "022": 12, "belgium": 12, "008": 12, "prov": 12, "007": 12, "luxem": 12, "saint": 12, "la": 12, "correctli": 12, "wai": 12, "represent": 12, "confus": 12, "certain": 12, "caus": 12, "subject_idx": 12, "answer_token": 12, "0022770469076931477": [], "all_hidden_st": 12, "record": 12, "n_token": 12, "intervened_prob": 12, "todo": [], "fig": 12, "update_layout": [], "tickmod": [], "tickval": [], "ticktext": [], "tickangl": [], "90": [], "unrot": [], "xaxis_sid": [], "These": 12, "befor": 12, "et": 12, "al": 12, "2022": 12, "002277057385072112": 12, "squeez": 12, "depth": 7, "concept": 7, "background": 7, "explan": 7, "page": 7, "descript": 7, "usag": 7, "instruct": 7}, "objects": {"nnsight": [[1, 0, 0, "-", "Module"], [5, 0, 0, "-", "fx"], [2, 0, 0, "-", "intervention"], [3, 0, 0, "-", "models"], [4, 0, 0, "-", "patching"], [6, 0, 0, "-", "util"]], "nnsight.Module": [[1, 1, 1, "", "Module"]], "nnsight.Module.Module": [[1, 2, 1, "", "input"], [1, 3, 1, "", "input_shape"], [1, 3, 1, "", "input_type"], [1, 3, 1, "", "module_path"], [1, 2, 1, "id1", "output"], [1, 3, 1, "", "output_shape"], [1, 3, 1, "", "output_type"], [1, 3, 1, "", "tracer"], [1, 4, 1, "", "wrap"]], "nnsight.fx.Graph": [[5, 0, 0, "-", "Graph"]], "nnsight.fx.Graph.Graph": [[5, 3, 1, "", "argument_node_names"], [5, 3, 1, "", "generation_idx"], [5, 3, 1, "", "module_proxy"], [5, 3, 1, "", "name_idx"], [5, 3, 1, "", "nodes"], [5, 3, 1, "", "proxy_class"]], "nnsight.fx.Node": [[5, 0, 0, "-", "Node"]], "nnsight.fx.Node.Node": [[5, 3, 1, "", "_proxy_device"], [5, 3, 1, "", "args"], [5, 3, 1, "", "dependencies"], [5, 3, 1, "", "graph"], [5, 3, 1, "", "kwargs"], [5, 3, 1, "", "listeners"], [5, 3, 1, "", "meta"], [5, 3, 1, "", "name"], [5, 3, 1, "", "proxy_value"], [5, 3, 1, "", "target"], [5, 3, 1, "", "value"]], "nnsight.fx.Proxy": [[5, 0, 0, "-", "Proxy"]], "nnsight.fx.Proxy.Proxy": [[5, 3, 1, "", "node"]], "nnsight.intervention": [[2, 1, 1, "", "HookModel"], [2, 1, 1, "", "InterventionProxy"], [2, 1, 1, "", "TokenIndexer"], [2, 5, 1, "", "intervene"]], "nnsight.intervention.HookModel": [[2, 3, 1, "", "handles"], [2, 3, 1, "", "input_hook"], [2, 3, 1, "", "model"], [2, 3, 1, "", "modules"], [2, 3, 1, "", "output_hook"]], "nnsight.intervention.InterventionProxy": [[2, 4, 1, "", "save"], [2, 2, 1, "", "shape"], [2, 2, 1, "", "t"], [2, 2, 1, "", "token"], [2, 2, 1, "", "value"]], "nnsight.models": [[3, 0, 0, "-", "AbstractModel"], [3, 0, 0, "-", "DiffuserModel"], [3, 0, 0, "-", "LanguageModel"]], "nnsight.models.AbstractModel": [[3, 1, 1, "", "AbstractModel"]], "nnsight.models.AbstractModel.AbstractModel": [[3, 3, 1, "", "alter"], [3, 3, 1, "", "args"], [3, 3, 1, "", "custom_model"], [3, 3, 1, "", "dispatched"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "generate"], [3, 3, 1, "", "kwargs"], [3, 3, 1, "", "local_model"], [3, 3, 1, "", "meta_model"], [3, 4, 1, "", "modulize"], [3, 3, 1, "", "repoid_path_clsname"], [3, 3, 1, "", "tokenizer"]], "nnsight.models.DiffuserModel": [[3, 1, 1, "", "Diffuser"], [3, 1, 1, "", "DiffuserModel"]], "nnsight.models.DiffuserModel.DiffuserModel": [[3, 4, 1, "", "to_image"]], "nnsight.models.LanguageModel": [[3, 1, 1, "", "LanguageModel"]], "nnsight.patching": [[4, 1, 1, "", "Patch"], [4, 1, 1, "", "Patcher"]], "nnsight.patching.Patch": [[4, 3, 1, "", "obj"], [4, 4, 1, "", "patch"], [4, 3, 1, "", "replacement"], [4, 4, 1, "", "restore"]], "nnsight.patching.Patcher": [[4, 4, 1, "", "add"], [4, 3, 1, "", "patches"]], "nnsight.util": [[6, 1, 1, "", "WrapperModule"], [6, 5, 1, "", "apply"], [6, 5, 1, "", "cross_entropy_loss"], [6, 5, 1, "", "fetch_attr"], [6, 5, 1, "", "timed"], [6, 5, 1, "", "wrap"]], "nnsight.util.WrapperModule": [[6, 4, 1, "", "forward"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:property", "3": "py:attribute", "4": "py:method", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "property", "Python property"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"], "5": ["py", "function", "Python function"]}, "titleterms": {"document": [0, 7], "nnsight": [1, 2, 3, 4, 5, 6, 7], "modul": 1, "intervent": 2, "model": [3, 10, 12], "patch": [4, 13], "trace": 5, "util": 6, "get": 8, "start": 8, "instal": 8, "first": 8, "step": 8, "tutori": 9, "basic": 10, "load": [10, 12], "access": 10, "activ": 10, "interven": [10, 12], "search": 11, "induct": 11, "head": 11, "ndif": [], "main": 12, "demo": 12, "notebook": [], "setup": [], "introduct": [], "visual": [], "attent": [], "indirect": [], "object": [], "identif": [], "task": [], "featur": [], "multipl": [], "token": [], "gener": [], "base": [], "index": [], "cross": [], "prompt": [], "ad": [], "hoc": [], "run": 12, "exampl": 12, "logit": 12, "len": 12, "dure": 12, "forward": 12, "pass": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Documentation": [[0, "documentation"]], "nnsight.Module": [[1, "module-nnsight.Module"]], "nnsight.intervention": [[2, "nnsight-intervention"]], "nnsight.models": [[3, "module-nnsight.models"]], "nnsight.patching": [[4, "nnsight-patching"]], "nnsight.tracing": [[5, "module-nnsight.fx"]], "nnsight.util": [[6, "module-nnsight.util"]], "Basics": [[10, "basics"]], "Loading Models": [[10, "loading-models"]], "Accessing Activations": [[10, "accessing-activations"]], "Intervening on Activations": [[10, "intervening-on-activations"]], "Searching for Induction Heads": [[11, "searching-for-induction-heads"]], "Patching": [[13, "patching"]], "Tutorials": [[9, "tutorials"]], "Main Demo": [[12, "Main-Demo"]], "Loading and Running Models": [[12, "Loading-and-Running-Models"]], "Example: Logit Lens": [[12, "Example:-Logit-Lens"]], "Intervening during a forward pass": [[12, "Intervening-during-a-forward-pass"]], "nnsight documentation": [[7, "nnsight-documentation"]], "Getting Started": [[8, "getting-started"]], "Installation": [[8, "installation"]], "First Steps": [[8, "first-steps"]]}, "indexentries": {}})