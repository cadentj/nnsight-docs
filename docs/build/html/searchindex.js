Search.setIndex({"docnames": ["basics", "index", "induction", "patching", "start", "tutorials"], "filenames": ["basics.rst", "index.rst", "induction.rst", "patching.rst", "start.rst", "tutorials.rst"], "titles": ["Basics", "nnsight documentation", "Searching for Induction Heads", "Patching", "Getting Started", "Tutorials"], "terms": {"\u025bn": 1, "sa\u026at": 1, "i": [0, 1, 2, 3], "python": [1, 3], "librari": 1, "mechanist": [0, 1], "interpret": [0, 1], "open": [0, 1], "llm": [0, 1], "It": 1, "offer": 1, "an": [0, 1, 2, 3], "intuit": 1, "api": [0, 1, 3], "access": [1, 3], "intern": [0, 1], "oper": [0, 1], "model": [1, 2, 3], "host": 1, "nation": 1, "deep": 1, "inferenc": 1, "framework": 1, "check": [0, 1], "out": [0, 1], "usag": [], "section": 1, "further": 1, "inform": [0, 1, 3], "includ": 1, "how": [0, 1, 3], "instal": 1, "project": [], "thi": [0, 2, 3], "under": [], "activ": 3, "develop": [], "creat": [0, 3], "recip": [], "lumach": [], "invalidkinderror": [], "To": [0, 2, 4], "us": [0, 2, 3, 4], "first": [0, 2, 4], "pip": 4, "venv": [], "retriev": [], "list": 3, "random": [2, 3], "ingredi": [], "you": 0, "can": [0, 2, 3], "get_random_ingredi": [], "function": [], "The": [0, 2, 3], "kind": [], "paramet": 0, "should": 0, "either": [], "meat": [], "fish": [], "veggi": [], "otherwis": [], "rais": [], "except": [], "invalid": [], "node": [], "name": [], "graph": 0, "proxy_valu": [], "target": [], "arg": [], "kwarg": [], "meta": [], "listen": [], "depend": [], "_futur": [], "_proxy_devic": [], "destroi": 0, "done": [], "execut": [], "fufil": [], "futur": [], "proxy_devic": [], "updat": [], "valu": [0, 2, 3], "class": [], "engin": [0, 3], "fx": [], "str": [], "ani": 0, "union": [], "callabl": [], "option": [], "none": [], "dict": [], "_summary_": [], "_description_": [], "type": [], "default": [], "desc": [], "torch": [0, 2], "devic": [0, 3], "remov": [], "refer": [], "": [0, 2, 3], "log": [], "destruct": [], "bool": [], "wrapper": [], "return": [0, 3], "actual": 0, "true": [0, 2], "all": [0, 3], "ar": [0, 2, 3], "properti": [], "lazi": [], "creation": [], "attribut": [], "static": [], "value1": [], "value2": [], "tensor": [0, 3], "other": 0, "_type_": [], "gener": [0, 2, 3], "block": 0, "generation_idx": [], "batch_siz": 2, "prompt": [0, 3], "output": [0, 2, 3], "context": [0, 3], "abstractmodel": [], "server": [], "fals": 2, "object": [0, 3], "If": 0, "when": [0, 3], "device_map": 0, "wait": [], "form": [], "respons": [], "have": [0, 3], "manual": [], "request": [], "argument": 0, "call": [0, 3], "keyword": [], "keep": [], "track": [], "what": 0, "iter": 3, "do": [0, 3], "intervent": [0, 3], "modul": 0, "specifi": 0, "chang": 0, "invok": [0, 2, 3], "next": 2, "int": [], "current": 2, "size": [], "invoc": 0, "batch": [2, 3], "user": [], "get": [0, 1, 3], "start": [1, 3], "string": [], "now": [0, 3], "doe": 0, "initi": [0, 3], "run": [0, 3], "onli": [0, 3], "after": [0, 2, 3], "exit": [0, 3], "acual": [], "load": [2, 3], "ran": 0, "proxi": [0, 3], "which": [0, 2, 3], "essenti": [], "we": [0, 2, 3], "wish": 0, "carri": 0, "later": 0, "layer": [0, 2, 3], "test": [], "hello": [], "world": [], "notebook": 0, "servic": [], "provid": [], "parmet": [], "gradient": [], "believ": [], "understand": 0, "ai": [], "cognit": [], "one": 0, "greatest": [], "scientif": [], "question": [], "ag": [], "train": [], "itself": [], "yield": [], "progress": [], "made": 3, "through": 3, "massiv": [], "public": [], "undertak": [], "bridg": [], "research": 3, "experiment": [], "platform": [], "democrat": [], "transpar": [], "big": [], "packag": [], "larg": [], "goal": 3, "take": 0, "revers": [], "algorithm": [], "learn": [], "dure": 0, "from": [0, 2, 3], "its": [0, 2, 3], "weight": [], "fact": 2, "about": [0, 2], "todai": [], "comput": [0, 3], "program": [], "speak": [], "english": [], "human": [], "level": [], "gpt": [0, 2, 3], "3": 0, "palm": [], "etc": [], "yet": [], "idea": [], "thei": [0, 2], "work": 0, "nor": [], "write": [], "ourselv": [], "introduc": [], "basic": [1, 5], "concept": [], "few": [], "self": [], "contain": 0, "exampl": [0, 3], "main": 0, "demo": 0, "introduct": [], "tutori": 1, "try": [0, 2], "let": [0, 2, 3], "some": 0, "text": 0, "go": 0, "over": 0, "piec": 0, "denot": 0, "token": [0, 2, 3], "given": 0, "max_new_token": [0, 2, 3], "1": [0, 2, 3], "within": [0, 3], "want": 0, "appli": [0, 3], "process": 0, "varieti": 0, "input": [0, 3], "format": 0, "final": [0, 3], "raw": 0, "point": [0, 2], "But": [0, 2], "languagemodel": 0, "gpt2": 0, "eiffel": 0, "tower": 0, "citi": 0, "hidden_st": 0, "transform": [0, 2, 3], "h": [0, 2, 3], "0": [0, 3], "save": [0, 2, 3], "print": [0, 3], "decod": [0, 3], "t": [0, 3], "allow": 0, "sourc": 0, "referenc": 0, "hug": 0, "face": 0, "repo": 0, "id": [0, 2], "them": [], "repo_id": [], "For": [0, 3], "ll": [0, 3], "look": [0, 2], "2": [0, 2, 3], "small": [0, 2, 3], "80m": 0, "caption": [], "break": 0, "black": 0, "box": 0, "line": [0, 2], "paper": 3, "gpt2_text": 0, "natur": [0, 3], "languag": [0, 2], "task": [0, 3], "answer": [], "machin": [], "translat": [], "read": [], "comprehens": [], "summar": [], "typic": [], "approach": [], "supervis": [], "taskspecif": [], "dataset": [], "gpt2_token": 0, "encod": [0, 3], "onc": [], "again": [], "time": 3, "On": [], "re": 3, "sai": 2, "last": 0, "index": [0, 3], "statement": [], "down": [], "specif": [0, 3], "In": 0, "word": 0, "infer": 0, "grab": 0, "perform": [0, 3], "defin": 0, "also": 0, "becom": 0, "There": [], "two": [0, 2], "here": [0, 3], "0th": 0, "becaus": [0, 3], "tupl": 0, "where": [0, 3], "hidden": 0, "state": 0, "indici": [], "attent": [0, 2], "shape": [0, 3], "eventu": 0, "10": 2, "768": [], "12": 3, "64": [], "note": 3, "similarli": 0, "clone": 0, "u": [0, 3], "build": 0, "longer": 0, "ever": 0, "need": 0, "dereferenc": 0, "popul": 0, "search": [1, 5], "induct": [1, 5], "head": [0, 1, 3, 5], "patch": [1, 5], "http": [], "circuit": [2, 3], "pub": [], "2022": [], "html": [], "veri": 2, "import": [2, 3], "detect": 2, "continu": [2, 3], "repeat": [2, 3], "subsequ": 2, "consist": 2, "separ": 2, "compos": 2, "togeth": 2, "previou": 2, "alwai": 2, "attend": 2, "earlier": 2, "copi": 2, "see": [0, 2, 3], "why": 2, "predict": [2, 3], "new": 2, "articl": 2, "michael": 2, "jordan": 2, "could": 2, "follow": [0, 2], "mani": 2, "surnam": 2, "occur": 2, "ie": [2, 3], "confid": 2, "come": 2, "interest": 2, "generalis": 2, "arbitrari": 2, "sequenc": [2, 3], "50": 2, "twice": 2, "plot": 2, "averag": 2, "loss": [0, 2, 3], "posit": [2, 3], "goe": 2, "terribl": 2, "good": 2, "halfwai": 2, "seq_len": [2, 3], "random_token": 2, "randint": 2, "1000": 2, "10000": 2, "repeated_token": 2, "einop": 2, "token_id": 2, "logit": [2, 3], "lm_head": [0, 2, 3], "cross_entropy_loss": [0, 2], "shift": [0, 2], "avg_token": 2, "xaxi": [2, 3], "yaxi": [2, 3], "titl": [2, 3], "_": 3, "second": [2, 3], "each": [2, 3], "49": 2, "place": 2, "back": 2, "so": 2, "paid": 2, "identifi": [2, 3], "output_attent": 2, "attn_hidden_st": 2, "layer_idx": 2, "attn": [0, 2], "rang": [2, 3], "len": [2, 3], "stack": 2, "diagon": 2, "dim1": 2, "dim2": 2, "offset": 2, "induction_scor": 2, "mean": [0, 2], "cpu": 2, "imshow": [2, 3], "score": 2, "4": [0, 3], "llama": [], "pari": 0, "_load": [], "_access": [], "content": [], "declar": 0, "ref": [], "bullet": [], "ha": 3, "item": [], "onto": 0, "focu": 0, "highlight": 0, "One": 0, "great": 0, "thing": 0, "neural": 0, "network": 0, "full": 0, "control": 0, "our": [0, 3], "system": 0, "perspect": 0, "know": 0, "exactli": 0, "insid": 0, "even": 0, "don": 0, "And": 0, "make": 0, "precis": 0, "surgic": 0, "edit": 0, "behaviour": 0, "extrem": [0, 3], "power": 0, "tool": 0, "set": [0, 3], "up": [0, 3], "care": 0, "counterfactu": 0, "causal": 0, "easili": 0, "accordingli": 0, "being": 0, "abl": 0, "pretti": 0, "core": 0, "support": 0, "kei": [0, 3], "featur": 0, "most": 0, "ad": 0, "assign": 0, "flow": 0, "As": 0, "ablat": 0, "7": [0, 3], "abov": 0, "affect": [], "howev": [], "explicitli": [], "cross": [], "more": [0, 3], "pattern": [], "compon": [], "head_index": [], "zero": 3, "both": [], "normal": 3, "abal": [], "calcul": [], "metric": 3, "determin": [], "effect": [], "layer_to_abl": 0, "head_index_to_abl": 0, "normal_lm_head": 0, "attention_pattern": 0, "abalated_lm_head": 0, "tensor_token": 0, "0187": 0, "2913": 0, "35364": 0, "3303": 0, "7587": 0, "8861": 0, "11": 0, "884": 0, "355": 0, "1808": 0, "18877": 0, "4572": 0, "11059": 0, "3555": 0, "35915": 0, "290": 0, "15676": 0, "1634": 0, "389": 0, "6032": 0, "10448": 0, "351": 0, "28679": 0, "4673": 0, "319": 0, "431": 0, "7790": 0, "40522": 0, "13": 0, "2102": 0, "cuda": [0, 3], "2059": 0, "1688": 0, "0503": 0, "3703": 0, "2015": 0, "6594": 0, "9412": 0, "2137": 0, "8": [0, 3], "5667": 0, "6": 0, "3562": 0, "1276": 0, "6006": 0, "0798": 0, "5781": 0, "1944": 0, "8023": 0, "5": 0, "6864": 0, "6289": 0, "1180": 0, "4320": 0, "20": 0, "7147": 0, "7145": 0, "3738": 0, "4004": 0, "1358": 0, "9569": 0, "3060": 0, "1600": 0, "6868": 0, "9850": 0, "7206": 0, "7800": 0, "1185": 0, "1680": 0, "7024": 0, "2865": 0, "ablated_lm_head": 0, "result": [0, 3], "notic": 0, "ve": 0, "cover": 0, "broader": 0, "behavior": 0, "somewhat": 3, "involv": 3, "indirect": 3, "identif": 3, "ioi": 3, "sentenc": 3, "like": [0, 3], "john": 3, "mari": 3, "went": 3, "store": 3, "gave": 3, "bottl": 3, "milk": 3, "rather": 3, "than": 3, "find": 3, "redwood": 3, "excel": 3, "studi": 3, "underli": 3, "techniqu": 3, "kevin": 3, "meng": 3, "david": 3, "bau": 3, "rome": 3, "complet": 3, "clean": 3, "corrupt": 3, "pick": 3, "interven": 3, "much": 3, "recov": 3, "differ": 3, "between": 3, "correct": 3, "incorrect": 3, "clean_prompt": 3, "corrupted_prompt": 3, "clean_token": 3, "corrupted_token": 3, "def": 3, "logits_to_logit_diff": 3, "correct_answ": 3, "incorrect_answ": 3, "correct_index": 3, "incorrect_index": 3, "clean_resid": 3, "clean_logit": 3, "append": 3, "corrupted_logit": 3, "structur": 3, "residu": 3, "stream": 3, "numpi": 3, "arrai": 3, "below": 3, "significantli": 3, "neg": 3, "show": 3, "capabl": 3, "clean_logit_diff": 3, "corrupted_logit_diff": 3, "1235": 3, "2725": 3, "repres": 3, "design": 3, "consider": 3, "respect": 3, "augment": 3, "By": 3, "pass": 3, "duplic": 3, "d_model": 3, "loop": 3, "dimens": 3, "compar": 3, "nest": 3, "would": 3, "180": 3, "versu": 3, "n_layer": 3, "corrupted_tokens_list": 3, "tqdm": 3, "resid_pr": 3, "po": 3, "clean_resid_pr": 3, "patched_logit": 3, "visual": 3, "localis": 3, "subject": 3, "matter": 3, "relev": 3, "remain": 3, "until": 3, "move": 3, "9": 3, "patched_result": 3, "np": 3, "16": 3, "patching_result": 3, "patched_logit_diff": 3, "unsqueez": 3, "add": 3, "end": 3, "label": 3, "plotli": 3, "doesn": 3, "token_label": 3, "f": 3, "enumer": 3, "temp_plot": 3, "x": 3, "git": [], "github": [], "com": [], "jadenfiotto": [], "kaufman": [], "ndif": [], "nnsight": 4, "d": 0, "along": 0, "colab": 0, "With": 0}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": [], "nnsight": 1, "": [], "document": 1, "content": 1, "usag": [], "instal": 4, "creat": [], "recip": [], "gener": [], "context": [], "get": 4, "start": 4, "layer": [], "argument": [], "test": [], "main": [], "demo": [], "introduct": [], "load": 0, "model": 0, "tutori": 5, "access": 0, "activ": 0, "search": 2, "induct": 2, "head": 2, "patch": 3, "block": [], "basic": 0, "interven": 0}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Basics": [[0, "basics"]], "Loading Models": [[0, "loading-models"]], "Accessing Activations": [[0, "accessing-activations"]], "Intervening on Activations": [[0, "intervening-on-activations"]], "nnsight documentation": [[1, "nnsight-documentation"]], "Contents": [[1, "contents"]], "Searching for Induction Heads": [[2, "searching-for-induction-heads"]], "Patching": [[3, "patching"]], "Getting Started": [[4, "getting-started"]], "Installation": [[4, "installation"]], "Tutorials": [[5, "tutorials"]]}, "indexentries": {}})