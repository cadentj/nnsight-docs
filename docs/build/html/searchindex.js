Search.setIndex({"docnames": ["contexts", "contexts/generator", "contexts/invoker", "contexts/runner", "documentation", "documentation/Module", "documentation/intervention", "documentation/models", "documentation/patching", "documentation/tracing", "documentation/util", "features/adhoc", "features/crossprompt", "features/multitoken", "features/pertoken", "index", "models", "models/lm", "start", "toolbox", "toolbox/lora", "tutorials", "tutorials/basics", "tutorials/induction", "tutorials/patching", "utils", "utils/crossentropy"], "filenames": ["contexts.rst", "contexts/generator.rst", "contexts/invoker.rst", "contexts/runner.rst", "documentation.rst", "documentation/Module.rst", "documentation/intervention.rst", "documentation/models.rst", "documentation/patching.rst", "documentation/tracing.rst", "documentation/util.rst", "features/adhoc.rst", "features/crossprompt.rst", "features/multitoken.rst", "features/pertoken.rst", "index.rst", "models.rst", "models/lm.rst", "start.rst", "toolbox.rst", "toolbox/lora.rst", "tutorials.rst", "tutorials/basics.rst", "tutorials/induction.rst", "tutorials/patching.rst", "utils.rst", "utils/crossentropy.rst"], "titles": ["Contexts", "Generator", "Invoker", "Forward", "Documentation", "nnsight.Module", "nnsight.intervention", "nnsight.models", "nnsight.patching", "nnsight.tracing", "nnsight.util", "Ad-Hoc Module", "Cross Prompt intervention", "Multiple Token Generation", "Per Token Indexing", "nnsight documentation", "Models", "nnsight.LanguageModel", "Getting Started", "Toolbox", "nnsight.toolbox.optim.LORA", "Tutorials", "Basics", "Searching for Induction Heads", "Patching", "Utils", "nnsight.utils.cross_entropy_loss"], "terms": {"gener": [0, 2, 3, 5, 6, 7, 9, 11, 12, 14, 17, 20, 22, 23, 24], "nnsight": [0, 1, 2, 3, 4, 16, 18, 19, 22, 25], "model": [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 13, 14, 15, 17, 18, 20, 23, 24, 26], "abstractmodel": [0, 1, 3, 5, 7, 17, 20], "exampl": [0, 5, 6, 7, 18, 22], "invok": [0, 1, 5, 6, 7, 11, 12, 13, 14, 20, 22, 23, 24], "forward": [0, 5, 7, 10], "runner": [0, 3, 7], "The": [1, 2, 3, 5, 6, 7, 8, 9, 11, 13, 14, 20, 22, 23, 24], "context": [1, 2, 3, 5, 6, 7, 8, 22, 24], "creat": [1, 2, 5, 9, 22, 24], "graph": [1, 3, 5, 6, 7, 9, 22], "oper": [1, 2, 3, 5, 7, 9, 12, 22], "which": [1, 5, 7, 9, 10, 11, 20, 22, 23, 24], "ar": [1, 5, 6, 7, 9, 10, 14, 21, 22, 23, 24, 26], "carri": [1, 8, 9, 22], "out": [1, 7, 8, 9, 11, 18, 22], "actual": [1, 2, 6, 7, 9, 11, 22], "after": [1, 2, 3, 5, 7, 10, 22, 23, 24], "block": [1, 2, 12, 22], "i": [1, 2, 3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 18, 20, 22, 23, 24, 26], "exit": [1, 6, 22, 24], "arg": [1, 2, 3, 6, 7, 9, 10, 17], "kwarg": [1, 2, 3, 7, 9, 10, 17], "return": [1, 2, 3, 5, 6, 7, 10, 20, 22, 24, 26], "paramet": [1, 2, 3, 5, 6, 7, 8, 10, 17, 20, 22, 26], "keyword": [1, 2, 3, 7, 17], "argument": [1, 2, 3, 6, 7, 9, 10, 17, 22], "pass": [1, 3, 5, 7, 9, 10, 24], "downstream": [1, 5, 6, 7], "automodelforcausallm": [1, 7], "see": [1, 2, 7, 18, 22, 23, 24], "link": [1, 15], "doc": [1, 7], "refer": [1, 5], "class": [1, 2, 3, 5, 6, 7, 8, 9, 10, 17, 20, 26], "bool": [1, 3, 7, 10, 26], "true": [1, 7, 10, 22, 23, 26], "server": 1, "fals": [1, 3, 7, 10, 23, 26], "none": [1, 2, 3, 6, 7, 8, 9, 17, 20], "orchestr": [1, 2, 3], "either": [1, 3, 6, 7], "local": [1, 7, 17], "facilit": [1, 20], "user": [1, 5, 6, 7], "intervent": [1, 2, 3, 4, 5, 7, 13, 15, 22, 24], "dure": [1, 3, 5, 6, 9, 11, 22], "process": [1, 2, 3, 7, 9, 22], "object": [1, 2, 3, 5, 6, 7, 8, 9, 10, 22, 24], "thi": [1, 3, 5, 6, 7, 9, 10, 12, 14, 18, 22, 23, 24, 26], "call": [1, 2, 5, 6, 7, 8, 9, 10, 17, 22, 24], "whether": [1, 3], "wait": 1, "respons": [1, 2, 9], "when": [1, 6, 7, 9, 13, 14, 22, 24], "us": [1, 3, 6, 7, 9, 10, 11, 12, 13, 14, 15, 22, 23, 24, 26], "device_map": [1, 7, 17, 22, 23, 24], "run": [1, 2, 3, 5, 7, 9, 10, 22, 24], "__enter__": [1, 2, 3, 6, 8], "prepar": [1, 2, 3, 7, 17], "session": [1, 3], "__exit__": [1, 2, 3, 6, 8], "exc_typ": [1, 2, 3], "exc_val": [1, 2, 3], "exc_tb": [1, 2, 3], "clean": [1, 2, 3, 24], "up": [1, 2, 3, 17, 24], "run_loc": 1, "store": [1, 6, 9, 24], "output": [1, 2, 3, 5, 6, 7, 9, 11, 12, 13, 14, 20, 22, 23, 24, 26], "run_serv": 1, "send": 1, "request": [1, 5], "blocking_request": 1, "pydant": 1, "requestmodel": 1, "non_blocking_request": 1, "non": 1, "input": [1, 2, 3, 5, 6, 7, 10, 17, 20, 22, 24, 26], "an": [1, 3, 5, 6, 8, 9, 10, 17, 22, 23, 24], "invoc": [1, 2, 7, 12, 14, 22], "max_new_token": [1, 2, 7, 12, 13, 14, 22, 23, 24], "1": [1, 3, 7, 10, 11, 12, 13, 14, 20, 22, 23, 24, 26], "gpt2_token": [1, 22], "hidden_st": [1, 5, 6, 11, 14, 22], "transform": [1, 5, 6, 7, 10, 11, 12, 13, 14, 17, 20, 22, 23, 24], "h": [1, 5, 6, 7, 10, 11, 13, 14, 20, 22, 23, 24], "0": [1, 5, 6, 7, 11, 12, 13, 14, 20, 22, 24], "save": [1, 2, 3, 5, 6, 7, 11, 12, 13, 14, 22, 23, 24], "we": [1, 2, 5, 7, 11, 12, 13, 14, 22, 23, 24], "denot": [1, 5, 6, 13, 22], "wish": [1, 5, 7, 22], "token": [1, 2, 3, 6, 7, 10, 11, 12, 17, 20, 22, 23, 24, 26], "given": [1, 9, 10, 22], "some": [1, 7, 8, 10, 18, 22], "prompt": [1, 2, 3, 7, 22, 24], "now": [1, 24], "doe": [1, 5, 22], "initi": [1, 5, 7, 8, 17, 22, 24], "onli": [1, 5, 6, 7, 9, 10, 22, 24], "acual": 1, "load": [1, 7, 17, 23, 24], "ran": [1, 7, 9, 22], "all": [1, 2, 3, 5, 6, 7, 9, 10, 18, 22, 24], "proxi": [1, 2, 5, 6, 9, 22, 24], "essenti": 1, "later": [1, 22], "within": [2, 3, 5, 7, 10, 12, 22, 24, 26], "specifi": [2, 22], "want": [2, 22], "insid": 2, "appli": [2, 6, 7, 10, 11, 13, 18, 20, 22, 24, 25, 26], "torch": [2, 3, 5, 6, 7, 8, 9, 10, 11, 17, 20, 22, 23, 26], "tensor": [2, 3, 5, 6, 7, 9, 10, 11, 12, 22, 24, 26], "list": [2, 3, 5, 6, 7, 8, 9, 17, 20, 24], "union": [2, 3, 6, 7, 9], "A": [2, 3, 7, 17, 20, 26], "sequenc": [2, 3, 23, 24, 26], "batch": [2, 3, 6, 7, 10, 23, 24, 26], "set": [2, 3, 5, 6, 9, 17, 22, 24, 26], "environ": 2, "It": [2, 3, 7, 9, 17], "also": [2, 5, 7, 8, 11, 12, 22], "keep": 2, "track": [2, 7, 9], "id": [2, 7, 10, 22, 23], "data": [2, 3, 5, 9, 10, 20], "addit": [2, 3, 6], "new": [2, 9, 12, 23], "next": [2, 13, 23], "iter": [2, 6, 7, 24], "increment": 2, "index": [2, 3, 6, 9, 22, 24], "save_al": 2, "dict": [2, 7, 9], "str": [2, 5, 6, 7, 9, 10], "modul": [2, 4, 6, 7, 8, 9, 10, 15, 20, 22], "dictionari": 2, "map": [2, 9], "path": [2, 5, 6, 7, 10], "3": [2, 6, 7, 12, 13, 22, 26], "madison": [2, 12], "squar": [2, 12], "garden": [2, 12], "locat": [2, 12], "citi": [2, 5, 6, 7, 11, 12, 13, 14, 22], "lm_head_on": 2, "lm_head": [2, 3, 5, 6, 7, 11, 22, 23, 24], "eiffel": [2, 5, 6, 7, 11, 13, 14, 22], "tower": [2, 5, 6, 7, 11, 13, 14, 22], "lm_head_two": 2, "multipl": [2, 9, 14], "can": [2, 5, 6, 7, 9, 11, 12, 22, 23, 24, 26], "differ": [2, 24], "have": [2, 6, 9, 12, 18, 24, 26], "impact": 2, "other": [2, 3, 7, 9, 22], "unless": 2, "explicitli": 2, "cross": [2, 10, 26], "more": [2, 7, 13, 18, 22], "interact": [3, 6, 7, 9], "": [3, 5, 6, 7, 9, 10, 11, 17, 21, 22, 23, 24, 26], "function": [3, 5, 6, 7, 8, 10, 14, 26], "implement": [3, 7, 9, 20], "instanc": [3, 10, 17], "string": [3, 5, 10], "format": [3, 22], "infer": [3, 7, 17, 22], "execut": [3, 5, 6, 7, 9, 10], "train": [3, 7], "manag": [3, 6, 7, 8, 20], "being": [3, 9, 20], "mode": [3, 7], "default": [3, 8, 9, 10, 20, 26], "batch_siz": [3, 6, 23, 26], "current": [3, 6, 9, 23], "size": [3, 5, 6, 10, 22], "generation_idx": [3, 9], "provid": [3, 6, 17, 20], "import": [3, 7, 8, 20, 23, 24], "from": [3, 6, 7, 8, 10, 12, 14, 17, 20, 21, 22, 23, 24, 26], "toolbox": 3, "optim": [3, 19], "lora": [3, 19], "util": [3, 4, 15, 20], "dataload": [3, 20], "dataset": [3, 20], "rest": [3, 20], "your": [3, 20], "code": [3, 20], "epoch": 3, "rang": [3, 23, 24], "target": [3, 9, 10, 26], "enumer": [3, 24], "zero_grad": 3, "logit": [3, 5, 6, 7, 10, 23, 24, 26], "loss": [3, 10, 22, 23, 24, 26], "lossfn": 3, "valu": [3, 5, 6, 7, 9, 11, 12, 13, 14, 22, 23, 24], "backward": 3, "step": [3, 15], "trace": [4, 6, 7, 15], "patch": [4, 15, 21], "act": [5, 7, 9], "entrypoint": 5, "interwoven": 5, "manipul": [5, 15, 18], "specif": [5, 7, 14, 20, 22, 24], "attribut": [5, 6, 7, 8, 9, 10], "root": [5, 6, 7, 9, 10], "node": [5, 6, 9], "perform": [5, 7, 9, 10, 14, 17, 22, 24], "popul": [5, 6, 9, 22], "requir": 5, "tracer": 5, "add": [5, 6, 8, 9, 24], "correct": [5, 24], "below": [5, 24], "show": [5, 24], "access": [5, 6, 7, 24], "gpt2": [5, 7, 13, 17, 22, 23, 24], "them": [5, 6, 7, 10, 12], "print": [5, 6, 7, 10, 11, 12, 20, 22, 24], "result": [5, 6, 9, 22, 24], "zero": [5, 24], "meant": [5, 7], "wrap": [5, 7, 10], "exist": [5, 6], "tree": [5, 11], "order": [5, 6, 7, 9, 11], "respect": [5, 24], "module_path": [5, 6], "repres": [5, 8, 9, 24], "rel": [5, 6], "separ": [5, 10, 23], "e": [5, 10], "x": [5, 7, 10, 24], "mlp": [5, 6, 7, 20], "meta": [5, 7, 9, 17], "type": [5, 6, 7, 8, 9, 10, 20, 26], "reset": [5, 9], "through": [5, 6, 9, 10, 24], "interventionproxi": [5, 6], "output_shap": 5, "shape": [5, 6, 9, 10, 20, 22, 24, 26], "most": [5, 22], "recent": 5, "nest": [5, 24], "output_typ": 5, "dtype": 5, "input_shap": 5, "input_typ": 5, "must": 5, "manual": 5, "properti": [5, 6], "get": [5, 9, 10, 11, 14, 15, 22, 24], "therefor": [5, 9], "first": [5, 6, 7, 9, 10, 12, 14, 15, 20, 22, 23, 26], "time": [5, 10, 24], "otherwis": [5, 26], "alreadi": 5, "one": [5, 7, 9, 10, 13, 22], "static": 5, "our": [5, 24], "hook": [5, 6, 7, 10], "nn": [5, 6, 7, 9], "modulelist": [5, 7], "contain": [6, 7, 20, 22, 26], "logic": 6, "interleav": [6, 7, 9], "comput": [6, 7, 9, 10, 11, 22, 24, 26], "extend": 6, "base": [6, 9, 17], "fx": 6, "make": 6, "easier": 6, "interven": [6, 24], "entri": [6, 9], "hookmodel": 6, "ad": [6, 7, 9, 22], "remov": [6, 26], "upon": 6, "input_hook": 6, "callabl": [6, 9, 10], "output_hook": 6, "regist": [6, 10], "along": [6, 22], "tupl": [6, 22], "design": [6, 20, 24], "should": [6, 9, 10, 13], "signatur": 6, "ani": [6, 7, 8, 9, 10, 11, 20, 22], "handl": [6, 8, 26], "removablehandl": 6, "sub": [6, 7], "so": [6, 9, 14, 23], "both": [6, 7, 9, 17], "clone": [6, 22], "point": [6, 9, 11, 22, 23], "delet": 6, "complet": [6, 9, 24], "listen": [6, 9], "enabl": [6, 7], "work": [6, 12, 22], "would": [6, 24], "had": 6, "you": [6, 7, 9, 11, 18, 22], "thrown": 6, "error": 6, "hidden": [6, 11, 13, 14, 22], "state": [6, 7, 11, 13, 14, 22], "easili": 6, "done": 6, "idx": [6, 14], "t": [6, 14, 22, 24], "collect": [6, 7, 10], "updat": [6, 9, 10], "throw": 6, "method": [6, 7, 9, 10], "indic": 6, "retriev": [6, 10], "tokenindex": 6, "alia": 6, "do": [6, 22, 24], "directli": [6, 7], "second": [6, 12, 20, 23, 24], "dimens": [6, 24, 26], "posit": [6, 7, 23, 24], "neg": [6, 24], "pad": [6, 14], "left": [6, 14, 26], "equival": 6, "For": [6, 18, 22], "helper": [6, 10, 14], "aid": 6, "activ": [6, 7, 24], "kei": [6, 9, 22, 24], "involv": [6, 9], "form": [6, 7, 9], "check": [6, 7, 18, 22], "argument_node_nam": [6, 9], "If": [6, 7, 9, 10, 18, 22, 26], "name": [6, 7, 9], "batch_start": 6, "narrow": 6, "select": 6, "relev": [6, 24], "view": [6, 9], "oppos": 6, "copi": [6, 23], "allow": [6, 7, 9, 11, 22], "subsequ": [6, 13, 23], "edit": [6, 22], "origin": [6, 8, 21], "prevent": 6, "effect": 6, "bath": 6, "outsid": [6, 9], "preview": 6, "potenti": 6, "modifi": 6, "main": 7, "packag": [7, 10, 15, 18], "here": [7, 11, 12, 13, 14, 22, 24], "huggingfac": 7, "its": [7, 22, 23, 24], "repo": [7, 22], "languagemodel": [7, 16, 20, 22, 23, 24], "cuda": [7, 11, 12, 17, 22, 24], "In": [7, 12, 22], "case": [7, 12], "mean": [7, 23], "underli": [7, 24], "unus": 7, "ultim": 7, "leverag": 7, "acceler": 7, "gpu": 7, "local_model": [7, 17], "further": 7, "encapsul": [7, 17], "structur": [7, 24], "well": [7, 9], "meta_model": [7, 17], "demonstr": 7, "like": [7, 11, 18, 22, 24], "gpt2lmheadmodel": 7, "gpt2model": 7, "wte": [7, 12], "embed": [7, 12], "50257": 7, "768": [7, 22], "wpe": 7, "1024": 7, "drop": 7, "dropout": 7, "p": 7, "inplac": 7, "11": [7, 22], "12": [7, 11, 22, 24], "gpt2block": 7, "ln_1": 7, "layernorm": 7, "ep": 7, "1e": 7, "05": 7, "elementwise_affin": 7, "attn": [7, 22, 23], "gpt2attent": 7, "c_attn": 7, "conv1d": 7, "c_proj": 7, "attn_dropout": 7, "resid_dropout": 7, "ln_2": 7, "gpt2mlp": 7, "c_fc": 7, "newgeluactiv": 7, "ln_f": [7, 11], "linear": 7, "in_featur": 7, "out_featur": 7, "bia": 7, "two": [7, 12, 22, 23], "enter": [7, 12], "multi": 7, "determin": 7, "behavior": 7, "three": [7, 13], "where": [7, 9, 20, 22, 24], "accept": 7, "languag": [7, 17, 20, 22, 23, 26], "over": [7, 26], "logits1": 7, "empir": 7, "build": 7, "logits2": 7, "direct": [7, 9], "gradient": 7, "repoid_path_model": 7, "alter": 7, "abstract": 7, "pytorch": 7, "gain": 7, "repoid_path_clsnam": 7, "hug": [7, 22], "face": [7, 22], "checkpoint": 7, "custom": 7, "dispatch": 7, "ha": [7, 9, 10, 24, 26], "bee": 7, "yet": [7, 18], "custom_model": 7, "wa": [7, 20], "version": 7, "devic": [7, 9, 11, 12, 17, 22, 23, 24], "_typ_": 7, "singl": [7, 9], "_run_loc": 7, "simpl": [7, 10], "_gener": 7, "tandem": 7, "limit": 7, "amount": 7, "predict": [7, 23, 24, 26], "inform": [7, 22, 24], "node_nam": 7, "module_nam": 7, "_summary_": [7, 9], "_description_": [7, 9], "wrapper": [7, 10, 17], "around": 7, "int": [7, 9, 20], "config": 7, "file": 7, "repositori": 7, "pretrainedconfig": 7, "lm": 7, "pretrainedtoken": 7, "pretrainedmodel": 7, "diffusermodel": 7, "diffus": 7, "repoid_or_path": 7, "cliptoken": 7, "to_imag": 7, "latent": 7, "imag": 7, "convert": [7, 9], "default_patch": 8, "patcher": 8, "obj": 8, "replac": [8, 12], "importlib": 8, "import_modul": 8, "self": [8, 17], "__module__": 8, "And": 8, "setattr": 8, "__name__": 8, "restor": 8, "each": [9, 13, 23, 24, 26], "flow": [9, 22], "said": 9, "thei": [9, 23], "AND": 9, "proxy_valu": 9, "datatyp": 9, "pre": [9, 12], "set_valu": 9, "bi": 9, "depend": 9, "same": [9, 10, 12], "theirs": 9, "longer": [9, 22], "destroi": [9, 22], "free": 9, "memori": 9, "re": [9, 24], "remain": [9, 24], "own": 9, "traceabl": 9, "mani": [9, 23], "python": [9, 24], "built": 9, "magic": 9, "__torch_function__": 9, "find": [9, 24], "shame": 9, "reserv": 9, "There": 9, "__init__": [9, 10], "compil": 9, "whatev": 9, "Their": 9, "need": [9, 10, 22], "These": 9, "kick": 9, "rtn": 9, "what": [9, 22], "null": 9, "never": 9, "proxy_class": 9, "name_idx": 9, "target_nam": 9, "number": 9, "previou": [9, 23], "uniqu": 9, "module_proxi": 9, "option": [9, 10, 26], "desc": 9, "_proxy_devic": 9, "throughout": 10, "wrappermodul": 10, "element": 10, "defin": [10, 22], "everi": 10, "overridden": 10, "subclass": [10, 20], "although": 10, "recip": 10, "afterward": 10, "instead": 10, "sinc": 10, "former": 10, "take": [10, 22], "care": 10, "while": 10, "latter": 10, "silent": 10, "ignor": 10, "fn": 10, "cl": 10, "member": 10, "give": 10, "kind": 10, "been": [10, 18], "cross_entropy_loss": [10, 22, 23, 25], "target_id": [10, 26], "shift": [10, 22, 23, 26], "avg_batch": [10, 26], "avg_token": [10, 23, 26], "entropi": [10, 26], "n": 10, "featur": [10, 18, 22], "last": [10, 11, 13, 22], "averag": [10, 23, 26], "across": 10, "fetch_attr": 10, "hierarchi": 10, "level": 10, "fetch": 10, "func": 10, "lggr": 10, "decor": 10, "__class__": 10, "even": 11, "layer": [11, 13, 22, 23, 24], "usual": 11, "chain": 11, "decod": [11, 12, 20, 22, 24], "vocabularli": 11, "space": 11, "softmax": 11, "argmax": 11, "u": [11, 22, 24], "vocabulari": 11, "dim": 11, "2": [11, 22, 23, 24, 26], "36": 11, "2874": 11, "35": 11, "0114": 11, "38": 11, "0793": 11, "40": 11, "5163": 11, "41": 11, "3759": 11, "34": 11, "9193": 11, "68": 11, "8886": 11, "70": 11, "1562": 11, "71": 11, "8408": 11, "80": 11, "4195": 11, "78": 11, "2552": 11, "1206": 11, "82": 11, "2950": 11, "81": 11, "6519": 11, "83": 11, "9941": 11, "94": 11, "4878": 11, "5194": 11, "85": 11, "6998": 11, "113": 11, "8675": 11, "111": 11, "8628": 11, "6634": 11, "116": 11, "7652": 11, "114": 11, "8267": 11, "112": 11, "3621": 11, "8531": 11, "3006": 11, "91": 11, "8192": 11, "92": 11, "9943": 11, "89": 11, "8382": 11, "6898": 11, "103": 11, "9307": 11, "102": 11, "5054": 11, "105": 11, "1563": 11, "109": 11, "3099": 11, "110": 11, "1395": 11, "198": 11, "417": 11, "8765": 11, "318": 11, "257": 11, "262": 11, "3504": 11, "7372": 11, "6342": 11, "el": 11, "middl": 11, "centr": 11, "pari": [11, 22], "between": [12, 24, 26], "grab": [12, 22], "come": [12, 23], "_": [12, 24], "york": 12, "could": [12, 23], "shown": 12, "0063": 12, "1795": 12, "2060": 12, "1978": 12, "1870": 12, "1588": 12, "1256": 12, "0201": 12, "0853": 12, "0117": 12, "1322": 12, "0054": 12, "1283": 12, "1087": 12, "1027": 12, "0407": 12, "1525": 12, "0030": 12, "0874": 12, "1263": 12, "0033": 12, "1747": 12, "0309": 12, "0572": 12, "0183": 12, "0333": 12, "0689": 12, "0931": 12, "0714": 12, "1341": 12, "0436": 12, "2236": 12, "1965": 12, "0693": 12, "1080": 12, "than": [13, 24], "follow": [13, 22, 23], "again": 13, "hidden_states1": 13, "hidden_states2": 13, "hidden_states3": 13, "becaus": [14, 22, 24], "side": 14, "back": [14, 23], "just": 14, "\u025bn": [15, 18], "sa\u026at": [15, 18], "interpret": [15, 18], "intern": [15, 18, 22], "deep": [15, 18], "learn": [15, 18], "start": [15, 24], "instal": 15, "tutori": [15, 18], "colab": [15, 18, 22], "basic": [15, 18, 21], "search": [15, 21], "induct": [15, 21], "head": [15, 21, 22, 24], "causal": 17, "interfac": 17, "text": [17, 22], "inherit": 17, "py": 17, "variabl": 17, "length": 17, "arbitrari": [17, 23], "init": 17, "configur": 17, "befor": 17, "superclass": 17, "is_avail": 17, "els": 17, "cpu": [17, 23], "To": [18, 23], "pip": 18, "section": 18, "how": [18, 24], "d": [18, 22], "hand": 18, "experi": 18, "cover": [18, 22], "Not": 18, "document": 18, "github": 18, "r": 20, "low": 20, "rank": 20, "adapt": [20, 21], "inject": 20, "trainabl": 20, "matric": 20, "effici": 20, "larg": 20, "task": [20, 22, 24], "without": 20, "extens": 20, "fine": 20, "tune": 20, "decomposit": 20, "matrix": 20, "input_dimens": 20, "deriv": 20, "wb": 20, "output_dimens": 20, "__call__": 20, "alpha": 20, "float": 20, "adjust": 20, "accordingli": 20, "scale": 20, "factor": 20, "combin": 20, "10": [20, 22, 23], "adamw": 20, "lr": 20, "sever": 21, "neel": 21, "nanda": 21, "transformerlen": 21, "demo": [21, 22], "notebook": 22, "engin": [22, 24], "api": [22, 24], "With": 22, "open": 22, "sourc": 22, "llm": 22, "referenc": 22, "ll": [22, 24], "look": [22, 23], "gpt": [22, 23, 24], "small": [22, 23, 24], "80m": 22, "declar": [22, 23, 24], "onto": [22, 23, 24], "let": [22, 23, 24], "break": 22, "down": 22, "piec": 22, "varieti": 22, "final": [22, 24], "raw": 22, "But": [22, 23], "black": 22, "box": 22, "gpt2_text": 22, "natur": [22, 24], "encod": [22, 24], "focu": 22, "highlight": 22, "line": [22, 23], "Then": 22, "word": 22, "becom": 22, "0th": 22, "anoth": 22, "64": 22, "attent": [22, 23], "eventu": 22, "similarli": 22, "ever": 22, "dereferenc": 22, "35364": 22, "3303": 22, "7587": 22, "8861": 22, "884": 22, "355": 22, "1808": 22, "18877": 22, "4572": 22, "11059": 22, "3555": 22, "35915": 22, "290": 22, "15676": 22, "1634": 22, "389": 22, "6032": 22, "10448": 22, "351": 22, "28679": 22, "4673": 22, "319": 22, "431": 22, "7790": 22, "40522": 22, "13": 22, "2102": 22, "2059": 22, "1688": 22, "0503": 22, "3703": 22, "2015": 22, "6594": 22, "9412": 22, "2137": 22, "8": [22, 24], "5667": 22, "6": 22, "3562": 22, "4": [22, 24], "1276": 22, "6006": 22, "0798": 22, "5781": 22, "1944": 22, "8023": 22, "5": 22, "6864": 22, "6289": 22, "1180": 22, "4320": 22, "20": 22, "7147": 22, "7145": 22, "3738": 22, "4004": 22, "1358": 22, "9569": 22, "3060": 22, "7": [22, 24], "1600": 22, "6868": 22, "9850": 22, "7206": 22, "7800": 22, "1185": 22, "1680": 22, "7024": 22, "2865": 22, "assign": 22, "As": 22, "ablat": 22, "abov": 22, "layer_to_abl": 22, "head_index_to_abl": 22, "normal_lm_head": 22, "attention_pattern": 22, "ablated_lm_head": 22, "observ": 22, "notic": 22, "chang": 22, "tensor_token": 22, "0187": 22, "2913": 22, "circuit": [23, 24], "veri": 23, "detect": 23, "continu": [23, 24], "repeat": [23, 24], "consist": 23, "compos": 23, "togeth": 23, "alwai": 23, "attend": 23, "earlier": 23, "why": 23, "sai": 23, "try": 23, "articl": 23, "about": 23, "michael": 23, "jordan": 23, "surnam": 23, "occur": 23, "ie": [23, 24], "confid": 23, "interest": 23, "fact": 23, "generalis": 23, "50": 23, "random": [23, 24], "twice": 23, "plot": 23, "goe": 23, "terribl": 23, "good": 23, "halfwai": 23, "seq_len": [23, 24], "random_token": 23, "randint": 23, "1000": 23, "10000": 23, "repeated_token": 23, "einop": 23, "token_id": 23, "xaxi": [23, 24], "yaxi": [23, 24], "titl": [23, 24], "49": 23, "place": 23, "paid": 23, "identifi": [23, 24], "output_attent": 23, "attn_hidden_st": 23, "layer_idx": 23, "len": [23, 24], "stack": 23, "diagon": 23, "dim1": 23, "dim2": 23, "offset": 23, "induction_scor": 23, "imshow": [23, 24], "score": 23, "indirect": 24, "identif": 24, "ioi": 24, "sentenc": 24, "john": 24, "mari": 24, "went": 24, "gave": 24, "bottl": 24, "milk": 24, "rather": 24, "redwood": 24, "research": 24, "excel": 24, "paper": 24, "studi": 24, "techniqu": 24, "kevin": 24, "meng": 24, "david": 24, "bau": 24, "rome": 24, "goal": 24, "corrupt": 24, "metric": 24, "pick": 24, "much": 24, "recov": 24, "clean_prompt": 24, "corrupted_prompt": 24, "incorrect": 24, "clean_token": 24, "corrupted_token": 24, "def": 24, "logits_to_logit_diff": 24, "correct_answ": 24, "incorrect_answ": 24, "correct_index": 24, "incorrect_index": 24, "clean_resid": 24, "clean_logit": 24, "append": 24, "corrupted_logit": 24, "note": 24, "residu": 24, "stream": 24, "numpi": 24, "arrai": 24, "significantli": 24, "capabl": 24, "clean_logit_diff": 24, "corrupted_logit_diff": 24, "1235": 24, "2725": 24, "consider": 24, "made": 24, "augment": 24, "By": 24, "duplic": 24, "d_model": 24, "loop": 24, "compar": 24, "180": 24, "versu": 24, "n_layer": 24, "corrupted_tokens_list": 24, "tqdm": 24, "resid_pr": 24, "po": 24, "clean_resid_pr": 24, "patched_logit": 24, "visual": 24, "extrem": 24, "localis": 24, "subject": 24, "matter": 24, "until": 24, "move": 24, "9": 24, "patched_result": 24, "np": 24, "16": 24, "patching_result": 24, "patched_logit_diff": 24, "unsqueez": [24, 26], "end": 24, "label": [24, 26], "plotli": 24, "doesn": 24, "token_label": 24, "f": 24, "temp_plot": 24, "normal": 24, "todo": 25, "especi": 26, "suit": 26, "support": 26, "automat": 26, "column": 26, "often": 26, "ensur": 26, "align": 26, "item": 26, "reduct": 26}, "objects": {"": [[20, 0, 1, "", "LORA"], [17, 0, 1, "", "LanguageModel"], [3, 0, 1, "", "Runner"], [17, 2, 1, "", "init"]], "LORA": [[20, 1, 1, "", "WA"], [20, 1, 1, "", "WB"], [20, 2, 1, "", "__call__"], [20, 1, 1, "", "module"], [20, 2, 1, "", "parameters"], [20, 1, 1, "", "r"]], "Runner": [[3, 2, 1, "", "__enter__"], [3, 2, 1, "", "__exit__"], [3, 1, 1, "", "args"], [3, 1, 1, "", "batch_size"], [3, 1, 1, "", "generation_idx"], [3, 1, 1, "", "graph"], [3, 1, 1, "", "inference"], [3, 1, 1, "", "input"], [3, 1, 1, "", "kwargs"], [3, 1, 1, "", "model"], [3, 1, 1, "", "output"], [3, 1, 1, "", "prompts"]], "nnsight": [[5, 3, 0, "-", "Module"], [6, 3, 0, "-", "intervention"], [7, 3, 0, "-", "models"], [8, 3, 0, "-", "patching"], [9, 3, 0, "-", "tracing"], [10, 3, 0, "-", "util"]], "nnsight.Module": [[5, 0, 1, "", "Module"]], "nnsight.Module.Module": [[5, 4, 1, "", "input"], [5, 1, 1, "", "input_shape"], [5, 1, 1, "", "input_type"], [5, 1, 1, "", "module_path"], [5, 4, 1, "id1", "output"], [5, 1, 1, "", "output_shape"], [5, 1, 1, "", "output_type"], [5, 1, 1, "", "tracer"], [5, 2, 1, "", "wrap"]], "nnsight.contexts": [[1, 0, 1, "", "Generator"], [2, 0, 1, "", "Invoker"]], "nnsight.contexts.Generator": [[1, 5, 1, "", "__enter__"], [1, 5, 1, "", "__exit__"], [1, 5, 1, "", "blocking_request"], [2, 5, 1, "", "invoke"], [1, 5, 1, "", "non_blocking_request"], [1, 5, 1, "", "run_local"], [1, 5, 1, "", "run_server"]], "nnsight.contexts.Invoker": [[2, 2, 1, "", "__enter__"], [2, 2, 1, "", "__exit__"], [2, 2, 1, "", "next"], [2, 2, 1, "", "save_all"]], "nnsight.intervention": [[6, 0, 1, "", "HookModel"], [6, 0, 1, "", "InterventionProxy"], [6, 0, 1, "", "TokenIndexer"], [6, 5, 1, "", "intervene"]], "nnsight.intervention.HookModel": [[6, 1, 1, "", "handles"], [6, 1, 1, "", "input_hook"], [6, 1, 1, "", "model"], [6, 1, 1, "", "modules"], [6, 1, 1, "", "output_hook"]], "nnsight.intervention.InterventionProxy": [[6, 2, 1, "", "save"], [6, 4, 1, "", "shape"], [6, 4, 1, "", "t"], [6, 4, 1, "", "token"], [6, 4, 1, "", "value"]], "nnsight.model.AbstractModel": [[1, 5, 1, "", "generate"]], "nnsight.models": [[7, 3, 0, "-", "AbstractModel"], [7, 3, 0, "-", "DiffuserModel"], [7, 3, 0, "-", "LanguageModel"]], "nnsight.models.AbstractModel": [[7, 0, 1, "", "AbstractModel"], [3, 5, 1, "", "forward"]], "nnsight.models.AbstractModel.AbstractModel": [[7, 1, 1, "", "alter"], [7, 1, 1, "", "args"], [7, 1, 1, "", "custom_model"], [7, 1, 1, "", "dispatched"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "generate"], [7, 1, 1, "", "kwargs"], [7, 1, 1, "", "local_model"], [7, 1, 1, "", "meta_model"], [7, 2, 1, "", "modulize"], [7, 1, 1, "", "repoid_path_clsname"], [7, 1, 1, "", "tokenizer"]], "nnsight.models.DiffuserModel": [[7, 0, 1, "", "Diffuser"], [7, 0, 1, "", "DiffuserModel"]], "nnsight.models.DiffuserModel.DiffuserModel": [[7, 2, 1, "", "to_image"]], "nnsight.models.LanguageModel": [[7, 0, 1, "", "LanguageModel"]], "nnsight.models.LanguageModel.LanguageModel": [[7, 1, 1, "", "config"], [7, 1, 1, "", "local_model"], [7, 1, 1, "", "meta_model"], [7, 1, 1, "", "tokenizer"]], "nnsight.patching": [[8, 1, 1, "", "DEFAULT_PATCHER"], [8, 0, 1, "", "Patch"], [8, 0, 1, "", "Patcher"]], "nnsight.patching.Patch": [[8, 1, 1, "", "obj"], [8, 2, 1, "", "patch"], [8, 1, 1, "", "replacement"], [8, 2, 1, "", "restore"]], "nnsight.patching.Patcher": [[8, 2, 1, "", "add"], [8, 1, 1, "", "patches"]], "nnsight.tracing.Graph": [[9, 3, 0, "-", "Graph"]], "nnsight.tracing.Graph.Graph": [[9, 1, 1, "", "argument_node_names"], [9, 1, 1, "", "generation_idx"], [9, 1, 1, "", "module_proxy"], [9, 1, 1, "", "name_idx"], [9, 1, 1, "", "nodes"], [9, 1, 1, "", "proxy_class"]], "nnsight.tracing.Node": [[9, 3, 0, "-", "Node"]], "nnsight.tracing.Node.Node": [[9, 1, 1, "", "_proxy_device"], [9, 1, 1, "", "args"], [9, 1, 1, "", "dependencies"], [9, 1, 1, "", "graph"], [9, 1, 1, "", "kwargs"], [9, 1, 1, "", "listeners"], [9, 1, 1, "", "meta"], [9, 1, 1, "", "name"], [9, 1, 1, "", "proxy_value"], [9, 1, 1, "", "target"], [9, 1, 1, "", "value"]], "nnsight.tracing.Proxy": [[9, 3, 0, "-", "Proxy"]], "nnsight.tracing.Proxy.Proxy": [[9, 1, 1, "", "node"]], "nnsight.util": [[10, 0, 1, "", "WrapperModule"], [10, 5, 1, "", "apply"], [10, 5, 1, "", "cross_entropy_loss"], [10, 5, 1, "", "fetch_attr"], [10, 5, 1, "", "timed"], [10, 5, 1, "", "wrap"]], "nnsight.util.WrapperModule": [[10, 2, 1, "", "forward"]], "nnsight.utils": [[26, 5, 1, "", "cross_entropy_loss"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:method", "3": "py:module", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "method", "Python method"], "3": ["py", "module", "Python module"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"context": 0, "gener": [1, 13], "exampl": [1, 2, 3, 17, 20], "invok": 2, "forward": 3, "document": [4, 15], "nnsight": [5, 6, 7, 8, 9, 10, 15, 17, 20, 26], "modul": [5, 11], "intervent": [6, 12], "model": [7, 16, 22], "patch": [8, 24], "trace": 9, "util": [10, 25, 26], "ad": 11, "hoc": 11, "cross": 12, "prompt": 12, "multipl": 13, "token": [13, 14], "per": 14, "index": 14, "languagemodel": 17, "get": 18, "start": 18, "instal": 18, "first": 18, "step": 18, "toolbox": [19, 20], "optim": 20, "lora": 20, "usag": 20, "tutori": 21, "basic": 22, "load": 22, "access": 22, "activ": 22, "interven": 22, "search": 23, "induct": 23, "head": 23, "cross_entropy_loss": 26}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Contexts": [[0, "contexts"]], "Generator": [[1, "generator"]], "Examples": [[1, "examples"], [2, "examples"], [3, "examples"]], "Invoker": [[2, "invoker"]], "Forward": [[3, "forward"]], "Documentation": [[4, "documentation"]], "nnsight.Module": [[5, "nnsight-module"]], "nnsight.intervention": [[6, "nnsight-intervention"]], "nnsight.models": [[7, "nnsight-models"]], "nnsight.patching": [[8, "nnsight-patching"]], "nnsight.tracing": [[9, "nnsight-tracing"]], "nnsight.util": [[10, "module-nnsight.util"]], "Ad-Hoc Module": [[11, "ad-hoc-module"]], "Cross Prompt intervention": [[12, "cross-prompt-intervention"]], "Multiple Token Generation": [[13, "multiple-token-generation"]], "Per Token Indexing": [[14, "per-token-indexing"]], "nnsight documentation": [[15, "nnsight-documentation"]], "Models": [[16, "models"]], "nnsight.LanguageModel": [[17, "nnsight-languagemodel"]], "Example": [[17, "example"]], "Getting Started": [[18, "getting-started"]], "Installation": [[18, "installation"]], "First Steps": [[18, "first-steps"]], "Toolbox": [[19, "toolbox"]], "nnsight.toolbox.optim.LORA": [[20, "nnsight-toolbox-optim-lora"]], "Usage Example": [[20, "usage-example"]], "Tutorials": [[21, "tutorials"]], "Basics": [[22, "basics"]], "Loading Models": [[22, "loading-models"]], "Accessing Activations": [[22, "accessing-activations"]], "Intervening on Activations": [[22, "intervening-on-activations"]], "Searching for Induction Heads": [[23, "searching-for-induction-heads"]], "Patching": [[24, "patching"]], "Utils": [[25, "utils"]], "nnsight.utils.cross_entropy_loss": [[26, "nnsight-utils-cross-entropy-loss"]]}, "indexentries": {"built-in function": [[1, "nnsight.contexts.Generator.__enter__"], [1, "nnsight.contexts.Generator.__exit__"], [1, "nnsight.contexts.Generator.blocking_request"], [1, "nnsight.contexts.Generator.non_blocking_request"], [1, "nnsight.contexts.Generator.run_local"], [1, "nnsight.contexts.Generator.run_server"], [1, "nnsight.model.AbstractModel.generate"], [2, "nnsight.contexts.Generator.invoke"], [3, "nnsight.models.AbstractModel.forward"], [26, "nnsight.utils.cross_entropy_loss"]], "nnsight.contexts.generator (built-in class)": [[1, "nnsight.contexts.Generator"]], "nnsight.contexts.generator.__enter__()": [[1, "nnsight.contexts.Generator.__enter__"]], "nnsight.contexts.generator.__exit__()": [[1, "nnsight.contexts.Generator.__exit__"]], "nnsight.contexts.generator.blocking_request()": [[1, "nnsight.contexts.Generator.blocking_request"]], "nnsight.contexts.generator.non_blocking_request()": [[1, "nnsight.contexts.Generator.non_blocking_request"]], "nnsight.contexts.generator.run_local()": [[1, "nnsight.contexts.Generator.run_local"]], "nnsight.contexts.generator.run_server()": [[1, "nnsight.contexts.Generator.run_server"]], "nnsight.model.abstractmodel.generate()": [[1, "nnsight.model.AbstractModel.generate"]], "__enter__() (nnsight.contexts.invoker method)": [[2, "nnsight.contexts.Invoker.__enter__"]], "__exit__() (nnsight.contexts.invoker method)": [[2, "nnsight.contexts.Invoker.__exit__"]], "next() (nnsight.contexts.invoker method)": [[2, "nnsight.contexts.Invoker.next"]], "nnsight.contexts.generator.invoke()": [[2, "nnsight.contexts.Generator.invoke"]], "nnsight.contexts.invoker (built-in class)": [[2, "nnsight.contexts.Invoker"]], "save_all() (nnsight.contexts.invoker method)": [[2, "nnsight.contexts.Invoker.save_all"]], "runner (built-in class)": [[3, "Runner"]], "__enter__() (runner method)": [[3, "Runner.__enter__"]], "__exit__() (runner method)": [[3, "Runner.__exit__"]], "args (runner attribute)": [[3, "Runner.args"]], "batch_size (runner attribute)": [[3, "Runner.batch_size"]], "generation_idx (runner attribute)": [[3, "Runner.generation_idx"]], "graph (runner attribute)": [[3, "Runner.graph"]], "inference (runner attribute)": [[3, "Runner.inference"]], "input (runner attribute)": [[3, "Runner.input"]], "kwargs (runner attribute)": [[3, "Runner.kwargs"]], "model (runner attribute)": [[3, "Runner.model"]], "nnsight.models.abstractmodel.forward()": [[3, "nnsight.models.AbstractModel.forward"]], "output (runner attribute)": [[3, "Runner.output"]], "prompts (runner attribute)": [[3, "Runner.prompts"]], "module (class in nnsight.module)": [[5, "nnsight.Module.Module"]], "input (nnsight.module.module property)": [[5, "nnsight.Module.Module.input"]], "input_shape (nnsight.module.module attribute)": [[5, "nnsight.Module.Module.input_shape"]], "input_type (nnsight.module.module attribute)": [[5, "nnsight.Module.Module.input_type"]], "module": [[5, "module-nnsight.Module"], [6, "module-nnsight.intervention"], [7, "module-nnsight.models"], [7, "module-nnsight.models.AbstractModel"], [7, "module-nnsight.models.DiffuserModel"], [7, "module-nnsight.models.LanguageModel"], [8, "module-nnsight.patching"], [9, "module-nnsight.tracing"], [9, "module-nnsight.tracing.Graph.Graph"], [9, "module-nnsight.tracing.Node.Node"], [9, "module-nnsight.tracing.Proxy.Proxy"], [10, "module-nnsight.util"]], "module_path (nnsight.module.module attribute)": [[5, "nnsight.Module.Module.module_path"]], "nnsight.module": [[5, "module-nnsight.Module"]], "output (nnsight.module.module attribute)": [[5, "id0"], [5, "nnsight.Module.Module.output"]], "output (nnsight.module.module property)": [[5, "id1"]], "output_shape (nnsight.module.module attribute)": [[5, "nnsight.Module.Module.output_shape"]], "output_type (nnsight.module.module attribute)": [[5, "nnsight.Module.Module.output_type"]], "tracer (nnsight.module.module attribute)": [[5, "nnsight.Module.Module.tracer"]], "wrap() (nnsight.module.module static method)": [[5, "nnsight.Module.Module.wrap"]], "hookmodel (class in nnsight.intervention)": [[6, "nnsight.intervention.HookModel"]], "interventionproxy (class in nnsight.intervention)": [[6, "nnsight.intervention.InterventionProxy"]], "tokenindexer (class in nnsight.intervention)": [[6, "nnsight.intervention.TokenIndexer"]], "handles (nnsight.intervention.hookmodel attribute)": [[6, "nnsight.intervention.HookModel.handles"]], "input_hook (nnsight.intervention.hookmodel attribute)": [[6, "nnsight.intervention.HookModel.input_hook"]], "intervene() (in module nnsight.intervention)": [[6, "nnsight.intervention.intervene"]], "model (nnsight.intervention.hookmodel attribute)": [[6, "nnsight.intervention.HookModel.model"]], "modules (nnsight.intervention.hookmodel attribute)": [[6, "nnsight.intervention.HookModel.modules"]], "nnsight.intervention": [[6, "module-nnsight.intervention"]], "output_hook (nnsight.intervention.hookmodel attribute)": [[6, "nnsight.intervention.HookModel.output_hook"]], "save() (nnsight.intervention.interventionproxy method)": [[6, "nnsight.intervention.InterventionProxy.save"]], "shape (nnsight.intervention.interventionproxy property)": [[6, "nnsight.intervention.InterventionProxy.shape"]], "t (nnsight.intervention.interventionproxy property)": [[6, "nnsight.intervention.InterventionProxy.t"]], "token (nnsight.intervention.interventionproxy property)": [[6, "nnsight.intervention.InterventionProxy.token"]], "value (nnsight.intervention.interventionproxy property)": [[6, "nnsight.intervention.InterventionProxy.value"]], "abstractmodel (class in nnsight.models.abstractmodel)": [[7, "nnsight.models.AbstractModel.AbstractModel"]], "diffuser (class in nnsight.models.diffusermodel)": [[7, "nnsight.models.DiffuserModel.Diffuser"]], "diffusermodel (class in nnsight.models.diffusermodel)": [[7, "nnsight.models.DiffuserModel.DiffuserModel"]], "languagemodel (class in nnsight.models.languagemodel)": [[7, "nnsight.models.LanguageModel.LanguageModel"]], "alter (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.alter"]], "args (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.args"]], "config (nnsight.models.languagemodel.languagemodel attribute)": [[7, "nnsight.models.LanguageModel.LanguageModel.config"]], "custom_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.custom_model"]], "dispatched (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.dispatched"]], "forward() (nnsight.models.abstractmodel.abstractmodel method)": [[7, "nnsight.models.AbstractModel.AbstractModel.forward"]], "generate() (nnsight.models.abstractmodel.abstractmodel method)": [[7, "nnsight.models.AbstractModel.AbstractModel.generate"]], "kwargs (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.kwargs"]], "local_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.local_model"]], "local_model (nnsight.models.languagemodel.languagemodel attribute)": [[7, "nnsight.models.LanguageModel.LanguageModel.local_model"]], "meta_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.meta_model"]], "meta_model (nnsight.models.languagemodel.languagemodel attribute)": [[7, "nnsight.models.LanguageModel.LanguageModel.meta_model"]], "modulize() (nnsight.models.abstractmodel.abstractmodel method)": [[7, "nnsight.models.AbstractModel.AbstractModel.modulize"]], "nnsight.models": [[7, "module-nnsight.models"]], "nnsight.models.abstractmodel": [[7, "module-nnsight.models.AbstractModel"]], "nnsight.models.diffusermodel": [[7, "module-nnsight.models.DiffuserModel"]], "nnsight.models.languagemodel": [[7, "module-nnsight.models.LanguageModel"]], "repoid_path_clsname (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.repoid_path_clsname"]], "to_image() (nnsight.models.diffusermodel.diffusermodel method)": [[7, "nnsight.models.DiffuserModel.DiffuserModel.to_image"]], "tokenizer (nnsight.models.abstractmodel.abstractmodel attribute)": [[7, "nnsight.models.AbstractModel.AbstractModel.tokenizer"]], "tokenizer (nnsight.models.languagemodel.languagemodel attribute)": [[7, "nnsight.models.LanguageModel.LanguageModel.tokenizer"]], "default_patcher (in module nnsight.patching)": [[8, "nnsight.patching.DEFAULT_PATCHER"]], "patch (class in nnsight.patching)": [[8, "nnsight.patching.Patch"]], "patcher (class in nnsight.patching)": [[8, "nnsight.patching.Patcher"]], "add() (nnsight.patching.patcher method)": [[8, "nnsight.patching.Patcher.add"]], "nnsight.patching": [[8, "module-nnsight.patching"]], "obj (nnsight.patching.patch attribute)": [[8, "nnsight.patching.Patch.obj"]], "patch() (nnsight.patching.patch method)": [[8, "nnsight.patching.Patch.patch"]], "patches (nnsight.patching.patcher attribute)": [[8, "nnsight.patching.Patcher.patches"]], "replacement (nnsight.patching.patch attribute)": [[8, "nnsight.patching.Patch.replacement"]], "restore() (nnsight.patching.patch method)": [[8, "nnsight.patching.Patch.restore"]], "_proxy_device (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node._proxy_device"]], "args (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.args"]], "argument_node_names (in module nnsight.tracing.graph.graph)": [[9, "nnsight.tracing.Graph.Graph.argument_node_names"]], "dependencies (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.dependencies"]], "generation_idx (in module nnsight.tracing.graph.graph)": [[9, "nnsight.tracing.Graph.Graph.generation_idx"]], "graph (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.graph"]], "kwargs (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.kwargs"]], "listeners (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.listeners"]], "meta (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.meta"]], "module_proxy (in module nnsight.tracing.graph.graph)": [[9, "nnsight.tracing.Graph.Graph.module_proxy"]], "name (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.name"]], "name_idx (in module nnsight.tracing.graph.graph)": [[9, "nnsight.tracing.Graph.Graph.name_idx"]], "nnsight.tracing": [[9, "module-nnsight.tracing"]], "nnsight.tracing.graph.graph": [[9, "module-nnsight.tracing.Graph.Graph"]], "nnsight.tracing.node.node": [[9, "module-nnsight.tracing.Node.Node"]], "nnsight.tracing.proxy.proxy": [[9, "module-nnsight.tracing.Proxy.Proxy"]], "node (in module nnsight.tracing.proxy.proxy)": [[9, "nnsight.tracing.Proxy.Proxy.node"]], "nodes (in module nnsight.tracing.graph.graph)": [[9, "nnsight.tracing.Graph.Graph.nodes"]], "proxy_class (in module nnsight.tracing.graph.graph)": [[9, "nnsight.tracing.Graph.Graph.proxy_class"]], "proxy_value (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.proxy_value"]], "target (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.target"]], "value (in module nnsight.tracing.node.node)": [[9, "nnsight.tracing.Node.Node.value"]], "wrappermodule (class in nnsight.util)": [[10, "nnsight.util.WrapperModule"]], "apply() (in module nnsight.util)": [[10, "nnsight.util.apply"]], "cross_entropy_loss() (in module nnsight.util)": [[10, "nnsight.util.cross_entropy_loss"]], "fetch_attr() (in module nnsight.util)": [[10, "nnsight.util.fetch_attr"]], "forward() (nnsight.util.wrappermodule method)": [[10, "nnsight.util.WrapperModule.forward"]], "nnsight.util": [[10, "module-nnsight.util"]], "timed() (in module nnsight.util)": [[10, "nnsight.util.timed"]], "wrap() (in module nnsight.util)": [[10, "nnsight.util.wrap"]], "languagemodel (built-in class)": [[17, "LanguageModel"]], "init()": [[17, "init"]], "lora (built-in class)": [[20, "LORA"]], "wa (lora attribute)": [[20, "LORA.WA"]], "wb (lora attribute)": [[20, "LORA.WB"]], "__call__() (lora method)": [[20, "LORA.__call__"]], "module (lora attribute)": [[20, "LORA.module"]], "parameters() (lora method)": [[20, "LORA.parameters"]], "r (lora attribute)": [[20, "LORA.r"]], "nnsight.utils.cross_entropy_loss()": [[26, "nnsight.utils.cross_entropy_loss"]]}})