Search.setIndex({"docnames": ["contexts", "contexts/generator", "contexts/invoker", "contexts/runner", "documentation", "features", "features/adhoc", "features/crossprompt", "features/multitoken", "features/pertoken", "index", "models", "models/lm", "start", "toolbox", "toolbox/lora", "tutorials", "tutorials/basics", "tutorials/induction", "tutorials/patching", "utils", "utils/crossentropy"], "filenames": ["contexts.rst", "contexts/generator.rst", "contexts/invoker.rst", "contexts/runner.rst", "documentation.rst", "features.rst", "features/adhoc.rst", "features/crossprompt.rst", "features/multitoken.rst", "features/pertoken.rst", "index.rst", "models.rst", "models/lm.rst", "start.rst", "toolbox.rst", "toolbox/lora.rst", "tutorials.rst", "tutorials/basics.rst", "tutorials/induction.rst", "tutorials/patching.rst", "utils.rst", "utils/crossentropy.rst"], "titles": ["Contexts", "Generator", "Invoker", "Forward", "Documentation", "Features", "Ad-Hoc Module", "Cross Prompt intervention", "Multiple Token Generation", "Per Token Indexing", "nnsight documentation", "Models", "nnsight.LanguageModel", "Getting Started", "Toolbox", "nnsight.toolbox.optim.LORA", "Tutorials", "Basics", "Searching for Induction Heads", "Patching", "Utils", "nnsight.utils.cross_entropy_loss"], "terms": {"\u025bn": [10, 13], "sa\u026at": [10, 13], "i": [1, 2, 3, 6, 7, 8, 9, 10, 13, 15, 17, 18, 19, 21], "python": 19, "librari": [], "mechanist": [], "interpret": [10, 13], "open": 17, "llm": 17, "It": [2, 3, 12, 21], "offer": [], "an": [1, 3, 12, 17, 18, 19, 21], "intuit": [], "api": [17, 19], "access": 19, "intern": [10, 13, 17], "oper": [1, 2, 3, 7, 17], "model": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 15, 18, 19, 21], "host": [], "nation": [], "deep": [10, 13], "inferenc": [], "framework": [], "check": [13, 17], "out": [1, 6, 13, 17], "usag": 0, "section": 13, "further": [], "inform": [17, 19], "includ": [], "how": [13, 19], "instal": 10, "project": [], "thi": [1, 3, 7, 9, 13, 17, 18, 19, 21], "under": [], "activ": 19, "develop": [], "creat": [1, 2, 17, 19], "recip": [], "lumach": [], "invalidkinderror": [], "To": [13, 18], "us": [1, 3, 6, 7, 8, 9, 10, 17, 18, 19, 21], "first": [7, 9, 10, 15, 17, 18, 21], "pip": 13, "venv": [], "retriev": [], "list": [2, 3, 12, 15, 19], "random": [18, 19], "ingredi": [], "you": [6, 13, 17, 21], "can": [2, 6, 7, 17, 18, 19, 21], "get_random_ingredi": [], "function": [3, 9, 21], "The": [1, 2, 3, 6, 8, 9, 15, 17, 18, 19, 21], "kind": [], "paramet": [1, 2, 3, 12, 15, 17, 21], "should": 8, "either": [1, 3], "meat": [], "fish": [], "veggi": [], "otherwis": 21, "rais": [], "except": [], "invalid": [], "node": [], "name": [], "graph": [1, 3, 17], "proxy_valu": [], "target": [3, 21], "arg": [1, 2, 3, 12], "kwarg": [1, 2, 3, 12], "meta": 12, "listen": [], "depend": [], "_futur": [], "_proxy_devic": [], "destroi": 17, "done": [], "execut": 3, "fufil": [], "futur": [], "proxy_devic": [], "updat": [], "valu": [3, 6, 7, 8, 9, 17, 18, 19], "class": [1, 2, 3, 12, 15, 21], "engin": [17, 19], "fx": [], "str": 2, "ani": [6, 15, 17], "union": [2, 3], "callabl": [], "option": 21, "none": [1, 2, 3, 12, 15], "dict": 2, "_summary_": [], "_description_": [], "type": [15, 21], "default": [3, 15, 21], "desc": [], "torch": [2, 3, 6, 12, 15, 17, 18, 21], "devic": [6, 7, 12, 17, 18, 19, 21], "remov": 21, "refer": 1, "": [3, 6, 12, 16, 17, 18, 19, 21], "log": [], "destruct": [], "bool": [1, 3, 21], "wrapper": 12, "return": [1, 2, 3, 15, 17, 19, 21], "actual": [1, 2, 6, 17], "true": [1, 17, 18, 21], "all": [1, 2, 3, 13, 17, 19], "ar": [1, 9, 16, 17, 18, 19, 21], "properti": [], "lazi": [], "creation": [], "attribut": [], "static": [], "value1": [], "value2": [], "tensor": [2, 3, 6, 7, 17, 19, 21], "other": [2, 3, 17], "_type_": [], "gener": [0, 2, 3, 4, 5, 6, 7, 9, 12, 15, 17, 18, 19], "block": [1, 2, 7, 17], "generation_idx": 3, "batch_siz": [3, 18, 21], "prompt": [1, 2, 3, 4, 5, 17, 19], "output": [1, 2, 3, 6, 7, 8, 9, 15, 17, 18, 19, 21], "context": [1, 2, 3, 4, 10, 14, 17, 19], "abstractmodel": [0, 1, 3, 11, 12, 15], "server": 1, "fals": [1, 3, 18, 21], "object": [1, 2, 3, 17, 19], "If": [13, 17, 21], "when": [1, 8, 9, 17, 19], "device_map": [1, 12, 17, 18, 19], "wait": 1, "form": [], "respons": [1, 2], "have": [2, 7, 13, 19, 21], "manual": [], "request": 1, "argument": [1, 2, 3, 12, 17], "call": [1, 2, 12, 17, 19, 21], "keyword": [1, 2, 3, 12], "keep": [2, 21], "track": 2, "what": 17, "iter": [2, 19], "do": [17, 19], "intervent": [1, 2, 3, 4, 5, 8, 17, 19], "modul": [2, 4, 5, 15, 17], "specifi": [2, 17], "chang": 17, "invok": [0, 1, 4, 6, 7, 8, 9, 15, 17, 18, 19], "next": [2, 8, 18, 21], "int": 15, "current": [3, 18], "size": [3, 17], "invoc": [1, 2, 7, 9, 17], "batch": [2, 3, 18, 19, 21], "user": 1, "get": [6, 9, 10, 17, 19], "start": [10, 19], "string": 3, "now": [1, 19], "doe": [1, 17], "initi": [1, 12, 17, 19], "run": [1, 2, 3, 17, 19], "onli": [1, 17, 19], "after": [1, 2, 3, 17, 18, 19], "exit": [1, 17, 19], "acual": 1, "load": [1, 12, 18, 19], "ran": [1, 17], "proxi": [1, 2, 17, 19], "which": [1, 6, 15, 17, 18, 19], "essenti": 1, "we": [1, 2, 6, 7, 8, 9, 17, 18, 19], "wish": [1, 17], "carri": [1, 17], "later": [1, 17], "layer": [6, 8, 17, 18, 19], "test": [], "hello": [], "world": [], "notebook": 17, "servic": [], "provid": [3, 12, 15], "parmet": [], "gradient": [], "believ": [], "understand": [], "ai": [], "cognit": [], "one": [8, 17], "greatest": [], "scientif": [], "question": [], "ag": [], "train": 3, "itself": [], "yield": [], "progress": [], "made": 19, "through": 19, "massiv": [], "public": [], "undertak": [], "bridg": [], "research": 19, "experiment": [], "platform": [], "democrat": [], "transpar": [], "big": [], "packag": [10, 13], "larg": 15, "goal": 19, "take": 17, "revers": [], "algorithm": [], "learn": [10, 13], "dure": [1, 3, 6, 17], "from": [3, 7, 9, 12, 15, 16, 17, 18, 19, 21], "its": [17, 18, 19], "weight": [], "fact": 18, "about": 18, "todai": [], "comput": [6, 17, 19, 21], "program": [], "speak": [], "english": [], "human": [], "level": [], "gpt": [17, 18, 19], "3": [2, 7, 8, 17, 21], "palm": [], "etc": [], "yet": 13, "idea": [], "thei": [18, 21], "work": [7, 17], "nor": [], "write": [], "ourselv": [], "introduc": [], "basic": [10, 13, 16], "concept": [], "few": [], "self": 12, "contain": [15, 17, 21], "exampl": [0, 13, 17], "main": [], "demo": [16, 17], "introduct": [], "tutori": [10, 13], "try": 18, "let": [17, 18, 19], "some": [1, 13, 17], "text": [12, 17], "go": [], "over": 21, "piec": 17, "denot": [1, 8, 17], "token": [1, 2, 3, 4, 5, 6, 7, 12, 15, 17, 18, 19, 21], "given": [1, 17], "max_new_token": [1, 2, 7, 8, 9, 17, 18, 19], "1": [1, 3, 6, 7, 8, 9, 15, 17, 18, 19, 21], "within": [2, 3, 7, 17, 19, 21], "want": [2, 17, 21], "appli": [2, 6, 8, 13, 15, 17, 19, 20, 21], "process": [1, 2, 3, 17], "varieti": 17, "input": [1, 2, 3, 12, 15, 17, 19, 21], "format": [3, 17], "final": [17, 19], "raw": 17, "point": [6, 17, 18], "But": [17, 18], "languagemodel": [4, 11, 15, 17, 18, 19], "gpt2": [8, 12, 17, 18, 19], "eiffel": [2, 6, 8, 9, 17], "tower": [2, 6, 8, 9, 17], "citi": [2, 6, 7, 8, 9, 17], "hidden_st": [1, 6, 9, 17], "transform": [1, 6, 7, 8, 9, 12, 15, 17, 18, 19], "h": [1, 6, 8, 9, 15, 17, 18, 19], "0": [1, 6, 7, 8, 9, 15, 17, 19], "save": [1, 2, 3, 6, 7, 8, 9, 17, 18, 19], "print": [6, 7, 15, 17, 19], "decod": [6, 7, 15, 17, 19], "t": [9, 17, 19, 21], "allow": [6, 17], "sourc": 17, "referenc": 17, "hug": 17, "face": 17, "repo": 17, "id": [2, 17, 18, 21], "them": 7, "repo_id": [], "For": [13, 17], "ll": [17, 19], "look": [17, 18], "2": [6, 17, 18, 19, 21], "small": [17, 18, 19], "80m": 17, "caption": [], "break": 17, "black": 17, "box": 17, "line": [17, 18], "paper": 19, "gpt2_text": 17, "natur": [17, 19], "languag": [12, 15, 17, 18, 21], "task": [15, 17, 19], "answer": [], "machin": [], "translat": [], "read": [], "comprehens": [], "summar": [], "typic": [], "approach": [], "supervis": [], "taskspecif": [], "dataset": [3, 15], "gpt2_token": [1, 17], "encod": [17, 19], "onc": [], "again": 8, "time": 19, "On": [], "re": [19, 21], "sai": 18, "last": [6, 8, 17], "index": [2, 3, 4, 5, 17, 19], "statement": [], "down": 17, "specif": [9, 15, 17, 19, 21], "In": [7, 17], "word": 17, "infer": [3, 12, 17], "grab": [7, 17], "perform": [9, 12, 17, 19], "defin": 17, "also": [2, 6, 7, 17], "becom": 17, "There": [], "two": [7, 17, 18], "here": [6, 7, 8, 9, 17, 19], "0th": 17, "becaus": [9, 17, 19], "tupl": 17, "where": [15, 17, 19, 21], "hidden": [6, 8, 9, 17], "state": [6, 8, 9, 17], "indici": [], "attent": [17, 18], "shape": [15, 17, 19, 21], "eventu": 17, "10": [15, 17, 18], "768": 17, "12": [6, 17, 19], "64": 17, "note": 19, "similarli": 17, "clone": 17, "u": [6, 17, 19], "build": [], "longer": 17, "ever": 17, "need": [17, 21], "dereferenc": 17, "popul": 17, "search": [10, 16], "induct": [10, 16], "head": [10, 16, 17, 19], "patch": [10, 16], "http": [], "circuit": [18, 19], "pub": [], "2022": [], "html": [], "veri": 18, "import": [3, 15, 18, 19], "detect": 18, "continu": [18, 19], "repeat": [18, 19], "subsequ": [8, 18], "consist": 18, "separ": 18, "compos": 18, "togeth": 18, "previou": [18, 21], "alwai": 18, "attend": 18, "earlier": 18, "copi": 18, "see": [1, 2, 13, 17, 18, 19], "why": 18, "predict": [18, 19, 21], "new": [2, 7, 18], "articl": 18, "michael": 18, "jordan": 18, "could": [7, 18], "follow": [8, 17, 18], "mani": 18, "surnam": 18, "occur": 18, "ie": [18, 19], "confid": 18, "come": [7, 18], "interest": 18, "generalis": 18, "arbitrari": [12, 18], "sequenc": [2, 3, 18, 19, 21], "50": 18, "twice": 18, "plot": 18, "averag": [18, 21], "loss": [3, 17, 18, 19, 21], "posit": [18, 19], "goe": 18, "terribl": 18, "good": 18, "halfwai": 18, "seq_len": [18, 19], "random_token": 18, "randint": 18, "1000": 18, "10000": 18, "repeated_token": 18, "einop": 18, "token_id": 18, "logit": [3, 18, 19, 21], "lm_head": [2, 3, 6, 17, 18, 19], "cross_entropy_loss": [4, 17, 18, 20], "shift": [17, 18, 21], "avg_token": [18, 21], "xaxi": [18, 19], "yaxi": [18, 19], "titl": [18, 19], "_": [7, 19], "second": [7, 15, 18, 19], "each": [8, 18, 19, 21], "49": 18, "place": 18, "back": [9, 18], "so": [9, 18], "paid": 18, "identifi": [18, 19], "output_attent": 18, "attn_hidden_st": 18, "layer_idx": 18, "attn": [17, 18], "rang": [3, 18, 19], "len": [18, 19], "stack": 18, "diagon": 18, "dim1": 18, "dim2": 18, "offset": 18, "induction_scor": 18, "mean": 18, "cpu": [12, 18, 21], "imshow": [18, 19], "score": 18, "4": [17, 19], "llama": [], "pari": [6, 17], "_load": [], "_access": [], "content": [], "declar": [17, 18, 19], "ref": [], "bullet": [], "ha": [19, 21], "item": 21, "onto": [17, 18, 19], "focu": 17, "highlight": 17, "One": [], "great": [], "thing": [], "neural": [], "network": [], "full": [], "control": [], "our": 19, "system": [], "perspect": [], "know": [], "exactli": [], "insid": 2, "even": 6, "don": 21, "And": [], "make": [], "precis": [], "surgic": [], "edit": 17, "behaviour": [], "extrem": 19, "power": [], "tool": [], "set": [2, 3, 12, 17, 19, 21], "up": [1, 2, 3, 12, 19], "care": [], "counterfactu": [], "causal": 12, "easili": [], "accordingli": 15, "being": [3, 15], "abl": [], "pretti": [], "core": [], "support": 21, "kei": [17, 19], "featur": [4, 10, 13, 17], "most": 17, "ad": [4, 5, 17], "assign": 17, "flow": 17, "As": 17, "ablat": 17, "7": [17, 19], "abov": 17, "affect": [], "howev": [], "explicitli": 2, "cross": [2, 4, 5, 21], "more": [2, 8, 13, 17], "pattern": [], "compon": [], "head_index": [], "zero": 19, "both": 12, "normal": 19, "abal": [], "calcul": 21, "metric": 19, "determin": [], "effect": [], "layer_to_abl": 17, "head_index_to_abl": 17, "normal_lm_head": 17, "attention_pattern": 17, "abalated_lm_head": [], "tensor_token": 17, "0187": 17, "2913": 17, "35364": 17, "3303": 17, "7587": 17, "8861": 17, "11": 17, "884": 17, "355": 17, "1808": 17, "18877": 17, "4572": 17, "11059": 17, "3555": 17, "35915": 17, "290": 17, "15676": 17, "1634": 17, "389": 17, "6032": 17, "10448": 17, "351": 17, "28679": 17, "4673": 17, "319": 17, "431": 17, "7790": 17, "40522": 17, "13": 17, "2102": 17, "cuda": [6, 7, 12, 17, 19], "2059": 17, "1688": 17, "0503": 17, "3703": 17, "2015": 17, "6594": 17, "9412": 17, "2137": 17, "8": [17, 19], "5667": 17, "6": 17, "3562": 17, "1276": 17, "6006": 17, "0798": 17, "5781": 17, "1944": 17, "8023": 17, "5": 17, "6864": 17, "6289": 17, "1180": 17, "4320": 17, "20": 17, "7147": 17, "7145": 17, "3738": 17, "4004": 17, "1358": 17, "9569": 17, "3060": 17, "1600": 17, "6868": 17, "9850": 17, "7206": 17, "7800": 17, "1185": 17, "1680": 17, "7024": 17, "2865": 17, "ablated_lm_head": 17, "result": [17, 19, 21], "notic": 17, "ve": [], "cover": [13, 17], "broader": [], "behavior": [], "somewhat": [], "involv": [], "indirect": 19, "identif": 19, "ioi": 19, "sentenc": 19, "like": [6, 13, 17, 19, 21], "john": 19, "mari": 19, "went": 19, "store": [1, 19], "gave": 19, "bottl": 19, "milk": 19, "rather": 19, "than": [8, 19], "find": 19, "redwood": 19, "excel": 19, "studi": 19, "underli": 19, "techniqu": 19, "kevin": 19, "meng": 19, "david": 19, "bau": 19, "rome": 19, "complet": 19, "clean": [1, 2, 3, 19], "corrupt": 19, "pick": 19, "interven": 19, "much": 19, "recov": 19, "differ": [2, 19], "between": [7, 19, 21], "correct": 19, "incorrect": 19, "clean_prompt": 19, "corrupted_prompt": 19, "clean_token": 19, "corrupted_token": 19, "def": 19, "logits_to_logit_diff": 19, "correct_answ": 19, "incorrect_answ": 19, "correct_index": 19, "incorrect_index": 19, "clean_resid": 19, "clean_logit": 19, "append": 19, "corrupted_logit": 19, "structur": 19, "residu": 19, "stream": 19, "numpi": 19, "arrai": 19, "below": 19, "significantli": 19, "neg": 19, "show": 19, "capabl": 19, "clean_logit_diff": 19, "corrupted_logit_diff": 19, "1235": 19, "2725": 19, "repres": 19, "design": [15, 19], "consider": 19, "respect": 19, "augment": 19, "By": 19, "pass": [1, 3, 19], "duplic": 19, "d_model": 19, "loop": 19, "dimens": [19, 21], "compar": 19, "nest": 19, "would": 19, "180": 19, "versu": 19, "n_layer": 19, "corrupted_tokens_list": 19, "tqdm": 19, "resid_pr": 19, "po": 19, "clean_resid_pr": 19, "patched_logit": 19, "visual": 19, "localis": 19, "subject": 19, "matter": 19, "relev": 19, "remain": 19, "until": 19, "move": [19, 21], "9": 19, "patched_result": 19, "np": 19, "16": 19, "patching_result": 19, "patched_logit_diff": 19, "unsqueez": [19, 21], "add": 19, "end": 19, "label": [19, 21], "plotli": 19, "doesn": 19, "token_label": 19, "f": 19, "enumer": [3, 19], "temp_plot": 19, "x": 19, "git": [], "github": 13, "com": [], "jadenfiotto": [], "kaufman": [], "ndif": [], "nnsight": [0, 1, 2, 3, 4, 11, 13, 14, 17, 20], "d": [13, 17], "along": 17, "colab": [10, 13, 17], "With": 17, "manipul": [10, 13], "step": [3, 10], "hand": 13, "experi": 13, "Not": 13, "been": 13, "document": 13, "lora": [3, 4, 14], "forward": [0, 4, 14], "anoth": 17, "three": 8, "code": [3, 15], "Then": 17, "observ": 17, "sever": 16, "adapt": [4, 15, 16], "neel": 16, "nanda": 16, "origin": 16, "transformerlen": 16, "www": [], "neelnanda": [], "io": [], "toolbox": [3, 4, 10], "util": [3, 4, 10, 15], "todo": [0, 11, 14, 20], "mayb": 11, "diffusionmodel": 11, "per": [4, 5], "same": [7, 21], "case": [7, 21], "embed": 7, "madison": [2, 7], "squar": [2, 7], "garden": [2, 7], "locat": [2, 7], "replac": 7, "wte": 7, "york": 7, "enter": 7, "pre": 7, "shown": 7, "0063": 7, "1795": 7, "2060": 7, "1978": 7, "1870": 7, "1588": 7, "1256": 7, "0201": 7, "0853": 7, "0117": 7, "1322": 7, "0054": 7, "1283": 7, "1087": 7, "1027": 7, "0407": 7, "1525": 7, "0030": 7, "0874": 7, "1263": 7, "0033": 7, "1747": 7, "0309": 7, "0572": 7, "0183": 7, "0333": 7, "0689": 7, "0931": 7, "0714": 7, "1341": 7, "0436": 7, "2236": 7, "1965": 7, "0693": 7, "1080": 7, "hoc": [4, 5], "tree": 6, "order": 6, "usual": 6, "chain": 6, "ln_f": 6, "vocabularli": 6, "space": 6, "softmax": 6, "argmax": 6, "vocabulari": 6, "dim": 6, "36": 6, "2874": 6, "35": 6, "0114": 6, "38": 6, "0793": 6, "40": 6, "5163": 6, "41": 6, "3759": 6, "34": 6, "9193": 6, "68": 6, "8886": 6, "70": 6, "1562": 6, "71": 6, "8408": 6, "80": 6, "4195": 6, "78": 6, "2552": 6, "1206": 6, "82": 6, "2950": 6, "81": 6, "6519": 6, "83": 6, "9941": 6, "94": 6, "4878": 6, "5194": 6, "85": 6, "6998": 6, "113": 6, "8675": 6, "111": 6, "8628": 6, "6634": 6, "116": 6, "7652": 6, "114": 6, "8267": 6, "112": 6, "3621": 6, "8531": 6, "3006": 6, "91": 6, "8192": 6, "92": 6, "9943": 6, "89": 6, "8382": 6, "6898": 6, "103": 6, "9307": 6, "102": 6, "5054": 6, "105": 6, "1563": 6, "109": 6, "3099": 6, "110": 6, "1395": 6, "198": 6, "417": 6, "8765": 6, "318": 6, "257": 6, "262": 6, "3504": 6, "7372": 6, "6342": 6, "el": 6, "middl": 6, "centr": 6, "idx": 9, "multipl": [2, 4, 5, 9], "pad": 9, "left": [9, 21], "side": 9, "helper": 9, "just": 9, "hidden_states1": 8, "hidden_states2": 8, "hidden_states3": 8, "target_id": 21, "avg_batch": 21, "entropi": 21, "especi": 21, "suit": 21, "handl": 21, "A": [2, 3, 12, 15, 21], "automat": 21, "column": 21, "often": 21, "ensur": 21, "align": 21, "reduct": 21, "befor": [12, 21], "avoid": 21, "unnecessari": 21, "data": [2, 3, 15, 21], "transfer": 21, "length": [12, 21], "misalign": 21, "assertionerror": 21, "scenario": 21, "base": [12, 21], "might": 21, "encapsul": 12, "interfac": 12, "local": [1, 12], "prepar": [1, 2, 3, 12], "inherit": 12, "py": 12, "variabl": 12, "init": 12, "instanc": [3, 12], "configur": 12, "meta_model": 12, "local_model": 12, "superclass": 12, "is_avail": 12, "els": 12, "interact": 3, "implement": [3, 15], "runner": [0, 3], "dictionari": 2, "counter": [], "adjust": 15, "via": [], "indic": [], "maintain": [], "hold": [], "descript": [], "unspecifi": [], "blah": [], "downstream": 1, "automodelforcausallm": 1, "link": [1, 10], "doc": 1, "huggingfac": [], "co": [], "en": [], "main_class": [], "text_gener": [], "generationmixin": [], "lm_head_on": 2, "lm_head_two": 2, "impact": 2, "unless": 2, "low": [4, 15], "rank": [4, 15], "optim": [3, 4, 14], "r": 15, "subclass": 15, "inject": 15, "trainabl": 15, "matric": 15, "facilit": [1, 15], "effici": 15, "without": 15, "extens": 15, "fine": 15, "tune": 15, "decomposit": 15, "wa": 15, "matrix": 15, "input_dimens": 15, "deriv": 15, "wb": 15, "output_dimens": 15, "__call__": 15, "alpha": 15, "float": 15, "scale": 15, "factor": 15, "combin": 15, "manag": [3, 15], "dataload": [3, 15], "rest": [3, 15], "your": [3, 15], "mlp": 15, "adamw": 15, "lr": 15, "environ": 2, "orchestr": [1, 2, 3], "addit": [2, 3], "__enter__": [1, 2, 3], "__exit__": [1, 2, 3], "exc_typ": [1, 2, 3], "exc_val": [1, 2, 3], "exc_tb": [1, 2, 3], "increment": 2, "save_al": 2, "map": 2, "path": 2, "whether": [1, 3], "session": [1, 3], "run_loc": 1, "run_serv": 1, "send": 1, "blocking_request": 1, "pydant": 1, "requestmodel": 1, "non_blocking_request": 1, "non": 1, "mode": 3, "epoch": 3, "zero_grad": 3, "lossfn": 3, "backward": 3}, "objects": {"": [[15, 0, 1, "", "LORA"], [12, 0, 1, "", "LanguageModel"], [3, 0, 1, "", "Runner"], [12, 2, 1, "", "init"]], "LORA": [[15, 1, 1, "", "WA"], [15, 1, 1, "", "WB"], [15, 2, 1, "", "__call__"], [15, 1, 1, "", "module"], [15, 2, 1, "", "parameters"], [15, 1, 1, "", "r"]], "Runner": [[3, 2, 1, "", "__enter__"], [3, 2, 1, "", "__exit__"], [3, 1, 1, "", "args"], [3, 1, 1, "", "batch_size"], [3, 1, 1, "", "generation_idx"], [3, 1, 1, "", "graph"], [3, 1, 1, "", "inference"], [3, 1, 1, "", "input"], [3, 1, 1, "", "kwargs"], [3, 1, 1, "", "model"], [3, 1, 1, "", "output"], [3, 1, 1, "", "prompts"]], "nnsight.contexts": [[1, 0, 1, "", "Generator"], [2, 0, 1, "", "Invoker"]], "nnsight.contexts.Generator": [[1, 2, 1, "", "__enter__"], [1, 2, 1, "", "__exit__"], [1, 2, 1, "", "blocking_request"], [2, 3, 1, "", "invoke"], [1, 2, 1, "", "non_blocking_request"], [1, 2, 1, "", "run_local"], [1, 2, 1, "", "run_server"]], "nnsight.contexts.Invoker": [[2, 2, 1, "", "__enter__"], [2, 2, 1, "", "__exit__"], [2, 2, 1, "", "next"], [2, 2, 1, "", "save_all"]], "nnsight.model.AbstractModel": [[1, 3, 1, "", "generate"]], "nnsight.models.AbstractModel": [[3, 3, 1, "", "forward"]], "nnsight.utils": [[21, 3, 1, "", "cross_entropy_loss"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"welcom": [], "nnsight": [10, 12, 15, 21], "": [], "document": [4, 10], "content": [], "usag": [3, 15], "instal": 13, "creat": [], "recip": [], "gener": [1, 8], "context": 0, "get": 13, "start": 13, "layer": [], "argument": [], "test": [], "main": [], "demo": [], "introduct": [], "load": 17, "model": [11, 17], "tutori": 16, "access": 17, "activ": 17, "search": 18, "induct": 18, "head": 18, "patch": 19, "block": [], "basic": 17, "interven": 17, "first": 13, "step": 13, "all": [], "featur": 5, "toolbox": [14, 15], "util": [20, 21], "languagemodel": 12, "cross": 7, "prompt": 7, "intervent": 7, "per": 9, "token": [8, 9], "index": 9, "invok": 2, "lora": 15, "ad": 6, "hoc": 6, "modul": 6, "multipl": 8, "forward": 3, "cross_entropy_loss": 21, "exampl": [1, 2, 3, 12, 15], "invoc": [], "low": [], "rank": [], "adapt": [], "optim": 15}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Documentation": [[4, "documentation"]], "Cross Prompt intervention": [[7, "cross-prompt-intervention"]], "Basics": [[17, "basics"]], "Loading Models": [[17, "loading-models"]], "Accessing Activations": [[17, "accessing-activations"]], "Intervening on Activations": [[17, "intervening-on-activations"]], "Searching for Induction Heads": [[18, "searching-for-induction-heads"]], "Ad-Hoc Module": [[6, "ad-hoc-module"]], "Per Token Indexing": [[9, "per-token-indexing"]], "Multiple Token Generation": [[8, "multiple-token-generation"]], "Contexts": [[0, "contexts"]], "Features": [[5, "features"]], "Models": [[11, "models"]], "Toolbox": [[14, "toolbox"]], "Tutorials": [[16, "tutorials"]], "Utils": [[20, "utils"]], "nnsight.utils.cross_entropy_loss": [[21, "nnsight-utils-cross-entropy-loss"]], "nnsight.LanguageModel": [[12, "nnsight-languagemodel"]], "Example": [[12, "example"]], "nnsight.toolbox.optim.LORA": [[15, "nnsight-toolbox-optim-lora"]], "Usage Example": [[15, "usage-example"], [3, "usage-example"]], "Generator": [[1, "generator"]], "Examples": [[1, "examples"], [2, "examples"]], "Invoker": [[2, "invoker"]], "Forward": [[3, "forward"]], "Patching": [[19, "patching"]], "nnsight documentation": [[10, "nnsight-documentation"]], "Getting Started": [[13, "getting-started"]], "Installation": [[13, "installation"]], "First Steps": [[13, "first-steps"]]}, "indexentries": {}})