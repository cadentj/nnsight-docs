Search.setIndex({"docnames": ["basics", "generator", "index", "induction", "patching", "start", "tutorials"], "filenames": ["basics.rst", "generator.rst", "index.rst", "induction.rst", "patching.rst", "start.rst", "tutorials.rst"], "titles": ["Basics", "Generator", "Welcome to nnsight\u2019s documentation!", "Searching for Induction Heads", "Patching", "Getting Started", "Tutorials"], "terms": {"\u025bn": 2, "sa\u026at": 2, "i": [0, 1, 2, 3, 4], "python": [2, 4], "librari": 2, "mechanist": [0, 2], "interpret": [0, 2], "open": [0, 2], "llm": [0, 2], "It": 2, "offer": 2, "an": [0, 2, 3, 4], "intuit": 2, "api": [0, 2, 4], "access": [2, 4], "intern": [0, 2], "oper": [0, 1, 2], "model": [1, 2, 3, 4], "host": 2, "nation": 2, "deep": 2, "inferenc": 2, "framework": 2, "check": 2, "out": [0, 2], "usag": [], "section": 2, "further": 2, "inform": [0, 2, 4], "includ": 2, "how": [0, 2, 4], "instal": 2, "project": 2, "thi": [0, 1, 2, 3, 4], "under": 2, "activ": [2, 4], "develop": 2, "creat": [0, 4], "recip": [], "lumach": 1, "invalidkinderror": [], "To": [0, 1, 3, 5], "us": [0, 1, 3, 4, 5], "first": [0, 3, 5], "pip": 5, "venv": 5, "retriev": 1, "list": [1, 4], "random": [1, 3, 4], "ingredi": 1, "you": [0, 1], "can": [0, 1, 3, 4], "get_random_ingredi": 1, "function": 1, "The": [0, 3, 4], "kind": [], "paramet": 0, "should": 0, "either": [], "meat": [], "fish": [], "veggi": [], "otherwis": 1, "rais": [], "except": [], "invalid": [], "node": 1, "name": [], "graph": [0, 1], "proxy_valu": [], "target": [], "arg": 1, "kwarg": 1, "meta": [], "listen": [], "depend": [], "_futur": [], "_proxy_devic": [], "destroi": 0, "done": [], "execut": [], "fufil": [], "futur": [], "proxy_devic": [], "updat": [], "valu": [0, 3, 4], "class": 1, "engin": [0, 1, 4], "fx": [], "str": 1, "ani": [0, 1], "union": [], "callabl": [], "option": [], "none": [], "dict": 1, "_summary_": 1, "_description_": [], "type": 1, "default": [], "desc": 1, "torch": [0, 3], "devic": [0, 4], "remov": [], "refer": [], "": [0, 3, 4], "log": [], "destruct": [], "bool": 1, "wrapper": [], "return": [0, 4], "actual": 0, "true": [0, 1, 3], "all": [0, 1, 4], "ar": [0, 3, 4], "properti": [], "lazi": [], "creation": 1, "attribut": [], "static": [], "value1": [], "value2": [], "tensor": [0, 4], "other": 0, "_type_": [], "gener": [0, 2, 3, 4], "block": [0, 1], "generation_idx": 1, "batch_siz": [1, 3], "prompt": [0, 1, 4], "output": [0, 1, 3, 4], "context": [0, 2, 4], "abstractmodel": 1, "server": 1, "fals": [1, 3], "object": [0, 1, 4], "If": 1, "when": [0, 1, 4], "device_map": [0, 1], "wait": 1, "form": 1, "respons": 1, "have": [0, 1, 4], "manual": 1, "request": 1, "argument": [0, 1], "call": [0, 1, 4], "keyword": 1, "keep": 1, "track": 1, "what": [0, 1], "iter": [1, 4], "do": [0, 1, 4], "intervent": [0, 1, 4], "modul": [0, 1], "specifi": [0, 1], "chang": [0, 1], "invok": [0, 1, 3, 4], "next": [1, 3], "int": 1, "current": [1, 3], "size": 1, "invoc": [0, 1], "batch": [1, 3, 4], "user": 1, "get": [0, 2, 4], "start": [2, 4], "string": [], "now": [0, 4], "doe": 0, "initi": [0, 4], "run": [0, 4], "onli": [0, 4], "after": [0, 3, 4], "exit": [0, 4], "acual": [], "load": [3, 4], "ran": 0, "proxi": [0, 4], "which": [0, 3, 4], "essenti": [], "we": [0, 3, 4], "wish": 0, "carri": 0, "later": 0, "layer": [0, 3, 4], "test": [], "hello": [], "world": [], "notebook": [], "servic": [], "provid": [], "parmet": [], "gradient": [], "believ": [], "understand": 0, "ai": [], "cognit": [], "one": 0, "greatest": [], "scientif": [], "question": [], "ag": [], "train": [], "itself": [], "yield": [], "progress": [], "made": 4, "through": 4, "massiv": [], "public": [], "undertak": [], "bridg": [], "research": 4, "experiment": [], "platform": [], "democrat": [], "transpar": [], "big": [], "packag": [], "larg": [], "goal": 4, "take": 0, "revers": [], "algorithm": [], "learn": [], "dure": 0, "from": [0, 3, 4], "its": [0, 3, 4], "weight": [], "fact": 3, "about": [0, 3], "todai": [], "comput": [0, 4], "program": [], "speak": [], "english": [], "human": [], "level": [], "gpt": [0, 3, 4], "3": 0, "palm": [], "etc": [], "yet": [], "idea": [], "thei": [0, 3], "work": 0, "nor": [], "write": [], "ourselv": [], "introduc": [], "basic": [2, 6], "concept": [], "few": [], "self": [], "contain": 0, "exampl": [0, 4], "main": 0, "demo": 0, "introduct": [], "tutori": 2, "try": [0, 3], "let": [0, 3, 4], "some": 0, "text": 0, "go": 0, "over": 0, "piec": 0, "denot": 0, "token": [0, 3, 4], "given": 0, "max_new_token": [0, 3, 4], "1": [0, 3, 4], "within": [0, 4], "want": 0, "appli": [0, 4], "process": 0, "varieti": 0, "input": [0, 4], "format": 0, "final": [0, 4], "raw": 0, "point": [0, 3], "But": [0, 3], "languagemodel": 0, "gpt2": 0, "eiffel": 0, "tower": 0, "citi": 0, "hidden_st": 0, "transform": [0, 3, 4], "h": [0, 3, 4], "0": [0, 4], "save": [0, 3, 4], "print": [0, 4], "decod": [0, 4], "t": [0, 4], "allow": 0, "sourc": 0, "referenc": 0, "hug": 0, "face": 0, "repo": 0, "id": [0, 3], "them": [], "repo_id": [], "For": [0, 4], "ll": [0, 4], "look": [0, 3], "2": [0, 3, 4], "small": [0, 3, 4], "80m": 0, "caption": [], "break": 0, "black": 0, "box": 0, "line": [0, 3], "paper": 4, "gpt2_text": 0, "natur": [0, 4], "languag": [0, 3], "task": [0, 4], "answer": [], "machin": [], "translat": [], "read": [], "comprehens": [], "summar": [], "typic": [], "approach": [], "supervis": [], "taskspecif": [], "dataset": [], "gpt2_token": 0, "encod": [0, 4], "onc": [], "again": [], "time": 4, "On": [], "re": 4, "sai": 3, "last": 0, "index": [0, 4], "statement": [], "down": [], "specif": [0, 4], "In": 0, "word": 0, "infer": 0, "grab": 0, "perform": [0, 4], "defin": 0, "also": 0, "becom": 0, "There": [], "two": [0, 3], "here": [0, 4], "0th": 0, "becaus": [0, 4], "tupl": 0, "where": [0, 4], "hidden": 0, "state": 0, "indici": [], "attent": [0, 3], "shape": [0, 4], "eventu": 0, "10": 3, "768": [], "12": 4, "64": [], "note": 4, "similarli": 0, "clone": 0, "u": [0, 4], "build": 0, "longer": 0, "ever": 0, "need": 0, "dereferenc": 0, "popul": 0, "search": [2, 6], "induct": [2, 6], "head": [0, 2, 4, 6], "patch": [2, 6], "http": 5, "circuit": [3, 4], "pub": [], "2022": [], "html": [], "veri": 3, "import": [3, 4], "detect": 3, "continu": [3, 4], "repeat": [3, 4], "subsequ": 3, "consist": 3, "separ": 3, "compos": 3, "togeth": 3, "previou": 3, "alwai": 3, "attend": 3, "earlier": 3, "copi": 3, "see": [0, 3, 4], "why": 3, "predict": [3, 4], "new": 3, "articl": 3, "michael": 3, "jordan": 3, "could": 3, "follow": 3, "mani": 3, "surnam": 3, "occur": 3, "ie": [3, 4], "confid": 3, "come": 3, "interest": 3, "generalis": 3, "arbitrari": 3, "sequenc": [3, 4], "50": 3, "twice": 3, "plot": 3, "averag": 3, "loss": [0, 3, 4], "posit": [3, 4], "goe": 3, "terribl": 3, "good": 3, "halfwai": 3, "seq_len": [3, 4], "random_token": 3, "randint": 3, "1000": 3, "10000": 3, "repeated_token": 3, "einop": 3, "token_id": 3, "logit": [3, 4], "lm_head": [0, 3, 4], "cross_entropy_loss": [0, 3], "shift": [0, 3], "avg_token": 3, "xaxi": [3, 4], "yaxi": [3, 4], "titl": [3, 4], "_": 4, "second": [3, 4], "each": [3, 4], "49": 3, "place": 3, "back": 3, "so": 3, "paid": 3, "identifi": [3, 4], "output_attent": 3, "attn_hidden_st": 3, "layer_idx": 3, "attn": [0, 3], "rang": [3, 4], "len": [3, 4], "stack": 3, "diagon": 3, "dim1": 3, "dim2": 3, "offset": 3, "induction_scor": 3, "mean": [0, 3], "cpu": 3, "imshow": [3, 4], "score": 3, "4": [0, 4], "llama": [], "pari": 0, "_load": [], "_access": [], "content": 0, "declar": 0, "ref": [], "bullet": [], "ha": 4, "item": [], "onto": 0, "focu": 0, "highlight": 0, "One": 0, "great": 0, "thing": 0, "neural": 0, "network": 0, "full": 0, "control": 0, "our": [0, 4], "system": 0, "perspect": 0, "know": 0, "exactli": 0, "insid": 0, "even": 0, "don": 0, "And": 0, "make": 0, "precis": 0, "surgic": 0, "edit": 0, "behaviour": 0, "extrem": [0, 4], "power": 0, "tool": 0, "set": [0, 4], "up": [0, 4], "care": 0, "counterfactu": 0, "causal": 0, "easili": 0, "accordingli": 0, "being": 0, "abl": 0, "pretti": 0, "core": 0, "support": 0, "kei": [0, 4], "featur": 0, "most": 0, "ad": 0, "assign": 0, "flow": 0, "As": 0, "ablat": 0, "7": [0, 4], "abov": 0, "affect": [], "howev": [], "explicitli": [], "cross": [], "more": [0, 4], "pattern": [], "compon": [], "head_index": [], "zero": 4, "both": [], "normal": 4, "abal": [], "calcul": [], "metric": 4, "determin": [], "effect": [], "layer_to_abl": 0, "head_index_to_abl": 0, "normal_lm_head": 0, "attention_pattern": 0, "abalated_lm_head": 0, "tensor_token": 0, "0187": 0, "2913": 0, "35364": 0, "3303": 0, "7587": 0, "8861": 0, "11": 0, "884": 0, "355": 0, "1808": 0, "18877": 0, "4572": 0, "11059": 0, "3555": 0, "35915": 0, "290": 0, "15676": 0, "1634": 0, "389": 0, "6032": 0, "10448": 0, "351": 0, "28679": 0, "4673": 0, "319": 0, "431": 0, "7790": 0, "40522": 0, "13": 0, "2102": 0, "cuda": [0, 4], "2059": 0, "1688": 0, "0503": 0, "3703": 0, "2015": 0, "6594": 0, "9412": 0, "2137": 0, "8": [0, 4], "5667": 0, "6": 0, "3562": 0, "1276": 0, "6006": 0, "0798": 0, "5781": 0, "1944": 0, "8023": 0, "5": 0, "6864": 0, "6289": 0, "1180": 0, "4320": 0, "20": 0, "7147": 0, "7145": 0, "3738": 0, "4004": 0, "1358": 0, "9569": 0, "3060": 0, "1600": 0, "6868": 0, "9850": 0, "7206": 0, "7800": 0, "1185": 0, "1680": 0, "7024": 0, "2865": 0, "ablated_lm_head": 0, "result": [0, 4], "notic": 0, "ve": 0, "cover": 0, "broader": 0, "behavior": 0, "somewhat": 4, "involv": 4, "indirect": 4, "identif": 4, "ioi": 4, "sentenc": 4, "like": 4, "john": 4, "mari": 4, "went": 4, "store": 4, "gave": 4, "bottl": 4, "milk": 4, "rather": 4, "than": 4, "find": 4, "redwood": 4, "excel": 4, "studi": 4, "underli": 4, "techniqu": 4, "kevin": 4, "meng": 4, "david": 4, "bau": 4, "rome": 4, "complet": 4, "clean": 4, "corrupt": 4, "pick": 4, "interven": 4, "much": 4, "recov": 4, "differ": 4, "between": 4, "correct": 4, "incorrect": 4, "clean_prompt": 4, "corrupted_prompt": 4, "clean_token": 4, "corrupted_token": 4, "def": 4, "logits_to_logit_diff": 4, "correct_answ": 4, "incorrect_answ": 4, "correct_index": 4, "incorrect_index": 4, "clean_resid": 4, "clean_logit": 4, "append": 4, "corrupted_logit": 4, "structur": 4, "residu": 4, "stream": 4, "numpi": 4, "arrai": 4, "below": 4, "significantli": 4, "neg": 4, "show": 4, "capabl": 4, "clean_logit_diff": 4, "corrupted_logit_diff": 4, "1235": 4, "2725": 4, "repres": 4, "design": 4, "consider": 4, "respect": 4, "augment": 4, "By": 4, "pass": 4, "duplic": 4, "d_model": 4, "loop": 4, "dimens": 4, "compar": 4, "nest": 4, "would": 4, "180": 4, "versu": 4, "n_layer": 4, "corrupted_tokens_list": 4, "tqdm": 4, "resid_pr": 4, "po": 4, "clean_resid_pr": 4, "patched_logit": 4, "visual": 4, "localis": 4, "subject": 4, "matter": 4, "relev": 4, "remain": 4, "until": 4, "move": 4, "9": 4, "patched_result": 4, "np": 4, "16": 4, "patching_result": 4, "patched_logit_diff": 4, "unsqueez": 4, "add": 4, "end": 4, "label": 4, "plotli": 4, "doesn": 4, "token_label": 4, "f": 4, "enumer": 4, "temp_plot": 4, "x": 4, "git": 5, "github": 5, "com": 5, "jadenfiotto": 5, "kaufman": 5, "ndif": 5, "nnsight": 5}, "objects": {"engine.contexts": [[1, 0, 0, "-", "Generator"]], "engine.contexts.Generator": [[1, 1, 1, "", "Generator"]], "engine.contexts.Generator.Generator": [[1, 2, 1, "", "args"], [1, 2, 1, "", "batch_size"], [1, 2, 1, "", "blocking"], [1, 2, 1, "", "generation_idx"], [1, 2, 1, "", "graph"], [1, 2, 1, "", "kwargs"], [1, 2, 1, "", "model"], [1, 2, 1, "", "output"], [1, 2, 1, "", "prompts"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"]}, "titleterms": {"welcom": 2, "nnsight": 2, "": 2, "document": 2, "content": 2, "usag": [], "instal": 5, "creat": [], "recip": [], "gener": 1, "context": 1, "get": 5, "start": 5, "layer": [], "argument": [], "test": [], "main": [], "demo": [], "introduct": [], "load": 0, "model": 0, "tutori": 6, "access": 0, "activ": 0, "search": 3, "induct": 3, "head": 3, "patch": 4, "block": [], "basic": 0, "interven": 0}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Basics": [[0, "basics"]], "Loading Models": [[0, "loading-models"]], "Accessing Activations": [[0, "accessing-activations"]], "Intervening on Activations": [[0, "intervening-on-activations"]], "Welcome to nnsight\u2019s documentation!": [[2, "welcome-to-nnsight-s-documentation"]], "Contents": [[2, "contents"]], "Searching for Induction Heads": [[3, "searching-for-induction-heads"]], "Tutorials": [[6, "tutorials"]], "Patching": [[4, "patching"]], "Generator": [[1, "generator"]], "Generate Context": [[1, "generate-context"]], "Getting Started": [[5, "getting-started"]], "Installation": [[5, "installation"]]}, "indexentries": {"generator (class in engine.contexts.generator)": [[1, "engine.contexts.Generator.Generator"]], "args (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.args"]], "batch_size (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.batch_size"]], "blocking (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.blocking"]], "engine.contexts.generator": [[1, "module-engine.contexts.Generator"]], "generation_idx (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.generation_idx"]], "graph (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.graph"]], "kwargs (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.kwargs"]], "model (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.model"]], "module": [[1, "module-engine.contexts.Generator"]], "output (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.output"]], "prompts (engine.contexts.generator.generator attribute)": [[1, "engine.contexts.Generator.Generator.prompts"]]}})