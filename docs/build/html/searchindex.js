Search.setIndex({"docnames": ["basics", "contexts", "documentation", "features", "index", "induction", "models", "patching", "start", "toolbox", "tutorials", "utils"], "filenames": ["basics.rst", "contexts.rst", "documentation.rst", "features.rst", "index.rst", "induction.rst", "models.rst", "patching.rst", "start.rst", "toolbox.rst", "tutorials.rst", "utils.rst"], "titles": ["Basics", "Contexts", "Documentation", "Features", "nnsight documentation", "Searching for Induction Heads", "Models", "Patching", "Getting Started", "Toolbox", "Tutorials", "Utils"], "terms": {"\u025bn": [4, 8], "sa\u026at": [4, 8], "i": [0, 4, 5, 7, 8], "python": 7, "librari": [], "mechanist": [], "interpret": [4, 8], "open": 0, "llm": 0, "It": [], "offer": [], "an": [0, 5, 7], "intuit": [], "api": [0, 7], "access": 7, "intern": [0, 4, 8], "oper": 0, "model": [2, 4, 5, 7, 8], "host": [], "nation": [], "deep": [4, 8], "inferenc": [], "framework": [], "check": [0, 4, 8], "out": [0, 4, 8], "usag": [], "section": [4, 8], "further": [], "inform": [0, 4, 7], "includ": 4, "how": [4, 7, 8], "instal": 4, "project": [], "thi": [0, 5, 7, 8], "under": [], "activ": 7, "develop": [], "creat": [0, 7], "recip": [], "lumach": [], "invalidkinderror": [], "To": [5, 8], "us": [0, 5, 7], "first": [0, 4, 5], "pip": 8, "venv": [], "retriev": [], "list": 7, "random": [5, 7], "ingredi": [], "you": [0, 8], "can": [0, 5, 7], "get_random_ingredi": [], "function": [], "The": [0, 5, 7], "kind": [], "paramet": 0, "should": [], "either": [], "meat": [], "fish": [], "veggi": [], "otherwis": [], "rais": [], "except": [], "invalid": [], "node": [], "name": [], "graph": 0, "proxy_valu": [], "target": [], "arg": [], "kwarg": [], "meta": [], "listen": [], "depend": [], "_futur": [], "_proxy_devic": [], "destroi": 0, "done": [], "execut": [], "fufil": [], "futur": [], "proxy_devic": [], "updat": [], "valu": [0, 5, 7], "class": [], "engin": [0, 7], "fx": [], "str": [], "ani": 0, "union": [], "callabl": [], "option": [], "none": [], "dict": [], "_summary_": [], "_description_": [], "type": [], "default": [], "desc": [], "torch": [0, 5], "devic": [0, 5, 7], "remov": [], "refer": [], "": [0, 5, 7, 8, 10], "log": [], "destruct": [], "bool": [], "wrapper": [], "return": [0, 7], "actual": 0, "true": [0, 5], "all": [0, 7, 8], "ar": [0, 5, 7, 10], "properti": [], "lazi": [], "creation": [], "attribut": [], "static": [], "value1": [], "value2": [], "tensor": [0, 7], "other": 0, "_type_": [], "gener": [0, 1, 5, 7], "block": 0, "generation_idx": [], "batch_siz": 5, "prompt": [0, 7], "output": [0, 5, 7], "context": [0, 2, 4, 7, 8, 9], "abstractmodel": 6, "server": [], "fals": 5, "object": [0, 7], "If": [0, 8], "when": [0, 7], "device_map": [0, 5, 7], "wait": [], "form": [], "respons": [], "have": [7, 8], "manual": [], "request": [], "argument": 0, "call": [0, 7], "keyword": [], "keep": [], "track": [], "what": 0, "iter": 7, "do": [0, 7], "intervent": [0, 7], "modul": 0, "specifi": 0, "chang": 0, "invok": [0, 1, 5, 7], "next": 5, "int": [], "current": 5, "size": 0, "invoc": 0, "batch": [5, 7], "user": [], "get": [0, 4, 7], "start": [4, 7], "string": [], "now": 7, "doe": 0, "initi": [0, 7], "run": [0, 7], "onli": [0, 7], "after": [0, 5, 7], "exit": [0, 7], "acual": [], "load": [5, 7], "ran": 0, "proxi": [0, 7], "which": [0, 5, 7], "essenti": [], "we": [0, 5, 7], "wish": 0, "carri": 0, "later": 0, "layer": [0, 5, 7], "test": [], "hello": [], "world": [], "notebook": 0, "servic": [], "provid": [], "parmet": [], "gradient": [], "believ": [], "understand": [], "ai": [], "cognit": [], "one": 0, "greatest": [], "scientif": [], "question": [], "ag": [], "train": [], "itself": [], "yield": [], "progress": [], "made": 7, "through": 7, "massiv": [], "public": [], "undertak": [], "bridg": [], "research": 7, "experiment": [], "platform": [], "democrat": [], "transpar": [], "big": [], "packag": [4, 8], "larg": [], "goal": 7, "take": 0, "revers": [], "algorithm": [], "learn": [4, 8], "dure": 0, "from": [0, 5, 7, 10], "its": [0, 5, 7], "weight": [], "fact": 5, "about": 5, "todai": [], "comput": [0, 7], "program": [], "speak": [], "english": [], "human": [], "level": [], "gpt": [0, 5, 7], "3": 0, "palm": [], "etc": [], "yet": 8, "idea": [], "thei": 5, "work": [0, 8], "nor": [], "write": [], "ourselv": [], "introduc": [], "basic": [4, 8, 10], "concept": [], "few": [], "self": [], "contain": 0, "exampl": [0, 7, 8], "main": [], "demo": [0, 10], "introduct": [], "tutori": [4, 8], "try": 5, "let": [0, 5, 7], "some": [0, 8], "text": 0, "go": [], "over": [], "piec": 0, "denot": 0, "token": [0, 5, 7], "given": 0, "max_new_token": [0, 5, 7], "1": [0, 5, 7], "within": [0, 7], "want": 0, "appli": [0, 7, 8, 11], "process": 0, "varieti": 0, "input": [0, 7], "format": 0, "final": [0, 7], "raw": 0, "point": [0, 5], "But": [0, 5], "languagemodel": [0, 5, 6, 7], "gpt2": [0, 5, 7], "eiffel": 0, "tower": 0, "citi": 0, "hidden_st": 0, "transform": [0, 5, 7], "h": [0, 5, 7], "0": [0, 7], "save": [0, 5, 7], "print": [0, 7], "decod": [0, 7], "t": [0, 7], "allow": 0, "sourc": 0, "referenc": 0, "hug": 0, "face": 0, "repo": 0, "id": [0, 5], "them": [], "repo_id": [], "For": [0, 7, 8], "ll": [0, 7], "look": [0, 5], "2": [0, 5, 7], "small": [0, 5, 7], "80m": 0, "caption": [], "break": 0, "black": 0, "box": 0, "line": [0, 5], "paper": 7, "gpt2_text": 0, "natur": [0, 7], "languag": [0, 5], "task": [0, 7], "answer": [], "machin": [], "translat": [], "read": [], "comprehens": [], "summar": [], "typic": [], "approach": [], "supervis": [], "taskspecif": [], "dataset": [], "gpt2_token": 0, "encod": [0, 7], "onc": [], "again": [], "time": 7, "On": [], "re": 7, "sai": 5, "last": 0, "index": [0, 7], "statement": [], "down": 0, "specif": [0, 7], "In": 0, "word": 0, "infer": 0, "grab": 0, "perform": [0, 7], "defin": 0, "also": 0, "becom": 0, "There": [], "two": [0, 5], "here": [0, 7, 8], "0th": 0, "becaus": [0, 7], "tupl": 0, "where": [0, 7], "hidden": 0, "state": 0, "indici": [], "attent": [0, 5], "shape": [0, 7], "eventu": 0, "10": [0, 5], "768": 0, "12": [0, 7], "64": 0, "note": 7, "similarli": 0, "clone": 0, "u": [0, 7], "build": [], "longer": 0, "ever": 0, "need": 0, "dereferenc": 0, "popul": 0, "search": [4, 10], "induct": [4, 10], "head": [0, 4, 7, 10], "patch": [4, 10], "http": [], "circuit": [5, 7], "pub": [], "2022": [], "html": [], "veri": 5, "import": [5, 7], "detect": 5, "continu": [5, 7], "repeat": [5, 7], "subsequ": 5, "consist": 5, "separ": 5, "compos": 5, "togeth": 5, "previou": 5, "alwai": 5, "attend": 5, "earlier": 5, "copi": 5, "see": [0, 5, 7, 8], "why": 5, "predict": [5, 7], "new": 5, "articl": 5, "michael": 5, "jordan": 5, "could": 5, "follow": [0, 5], "mani": 5, "surnam": 5, "occur": 5, "ie": [5, 7], "confid": 5, "come": 5, "interest": 5, "generalis": 5, "arbitrari": 5, "sequenc": [5, 7], "50": 5, "twice": 5, "plot": 5, "averag": 5, "loss": [0, 5, 7], "posit": [5, 7], "goe": 5, "terribl": 5, "good": 5, "halfwai": 5, "seq_len": [5, 7], "random_token": 5, "randint": 5, "1000": 5, "10000": 5, "repeated_token": 5, "einop": 5, "token_id": 5, "logit": [5, 7], "lm_head": [0, 5, 7], "cross_entropy_loss": [0, 5, 11], "shift": [0, 5], "avg_token": 5, "xaxi": [5, 7], "yaxi": [5, 7], "titl": [5, 7], "_": 7, "second": [5, 7], "each": [5, 7], "49": 5, "place": 5, "back": 5, "so": 5, "paid": 5, "identifi": [5, 7], "output_attent": 5, "attn_hidden_st": 5, "layer_idx": 5, "attn": [0, 5], "rang": [5, 7], "len": [5, 7], "stack": 5, "diagon": 5, "dim1": 5, "dim2": 5, "offset": 5, "induction_scor": 5, "mean": 5, "cpu": 5, "imshow": [5, 7], "score": 5, "4": [0, 7], "llama": [], "pari": 0, "_load": [], "_access": [], "content": [], "declar": [0, 5, 7], "ref": [], "bullet": [], "ha": 7, "item": [], "onto": [0, 5, 7], "focu": 0, "highlight": 0, "One": [], "great": [], "thing": [], "neural": [], "network": [], "full": [], "control": [], "our": 7, "system": [], "perspect": [], "know": [], "exactli": [], "insid": [], "even": [], "don": [], "And": [], "make": [], "precis": [], "surgic": [], "edit": 0, "behaviour": [], "extrem": 7, "power": [], "tool": [], "set": [0, 7], "up": 7, "care": [], "counterfactu": [], "causal": [], "easili": [], "accordingli": [], "being": [], "abl": [], "pretti": [], "core": [], "support": [], "kei": [0, 7], "featur": [0, 4, 8, 10], "most": 0, "ad": 0, "assign": 0, "flow": 0, "As": 0, "ablat": 0, "7": [0, 7], "abov": 0, "affect": [], "howev": [], "explicitli": [], "cross": [], "more": [0, 4, 7, 8], "pattern": [], "compon": [], "head_index": [], "zero": 7, "both": [], "normal": 7, "abal": [], "calcul": [], "metric": 7, "determin": [], "effect": [], "layer_to_abl": 0, "head_index_to_abl": 0, "normal_lm_head": 0, "attention_pattern": 0, "abalated_lm_head": [], "tensor_token": 0, "0187": 0, "2913": 0, "35364": 0, "3303": 0, "7587": 0, "8861": 0, "11": 0, "884": 0, "355": 0, "1808": 0, "18877": 0, "4572": 0, "11059": 0, "3555": 0, "35915": 0, "290": 0, "15676": 0, "1634": 0, "389": 0, "6032": 0, "10448": 0, "351": 0, "28679": 0, "4673": 0, "319": 0, "431": 0, "7790": 0, "40522": 0, "13": 0, "2102": 0, "cuda": [0, 7], "2059": 0, "1688": 0, "0503": 0, "3703": 0, "2015": 0, "6594": 0, "9412": 0, "2137": 0, "8": [0, 7], "5667": 0, "6": 0, "3562": 0, "1276": 0, "6006": 0, "0798": 0, "5781": 0, "1944": 0, "8023": 0, "5": 0, "6864": 0, "6289": 0, "1180": 0, "4320": 0, "20": 0, "7147": 0, "7145": 0, "3738": 0, "4004": 0, "1358": 0, "9569": 0, "3060": 0, "1600": 0, "6868": 0, "9850": 0, "7206": 0, "7800": 0, "1185": 0, "1680": 0, "7024": 0, "2865": 0, "ablated_lm_head": 0, "result": [0, 7], "notic": 0, "ve": [], "cover": [0, 8], "broader": [], "behavior": [], "somewhat": 7, "involv": 7, "indirect": 7, "identif": 7, "ioi": 7, "sentenc": 7, "like": [0, 7, 8], "john": 7, "mari": 7, "went": 7, "store": 7, "gave": 7, "bottl": 7, "milk": 7, "rather": 7, "than": 7, "find": 7, "redwood": 7, "excel": 7, "studi": 7, "underli": 7, "techniqu": 7, "kevin": 7, "meng": 7, "david": 7, "bau": 7, "rome": 7, "complet": 7, "clean": 7, "corrupt": 7, "pick": 7, "interven": 7, "much": 7, "recov": 7, "differ": 7, "between": 7, "correct": 7, "incorrect": 7, "clean_prompt": 7, "corrupted_prompt": 7, "clean_token": 7, "corrupted_token": 7, "def": 7, "logits_to_logit_diff": 7, "correct_answ": 7, "incorrect_answ": 7, "correct_index": 7, "incorrect_index": 7, "clean_resid": 7, "clean_logit": 7, "append": 7, "corrupted_logit": 7, "structur": 7, "residu": 7, "stream": 7, "numpi": 7, "arrai": 7, "below": 7, "significantli": 7, "neg": 7, "show": 7, "capabl": 7, "clean_logit_diff": 7, "corrupted_logit_diff": 7, "1235": 7, "2725": 7, "repres": 7, "design": 7, "consider": 7, "respect": 7, "augment": 7, "By": 7, "pass": [7, 8], "duplic": 7, "d_model": 7, "loop": 7, "dimens": 7, "compar": 7, "nest": 7, "would": 7, "180": 7, "versu": 7, "n_layer": 7, "corrupted_tokens_list": 7, "tqdm": 7, "resid_pr": 7, "po": 7, "clean_resid_pr": 7, "patched_logit": 7, "visual": 7, "localis": 7, "subject": 7, "matter": 7, "relev": 7, "remain": 7, "until": 7, "move": 7, "9": 7, "patched_result": 7, "np": 7, "16": 7, "patching_result": 7, "patched_logit_diff": 7, "unsqueez": 7, "add": 7, "end": 7, "label": 7, "plotli": 7, "doesn": 7, "token_label": 7, "f": 7, "enumer": 7, "temp_plot": 7, "x": 7, "git": [], "github": 8, "com": [], "jadenfiotto": [], "kaufman": [], "ndif": [], "nnsight": [0, 8], "d": [0, 8], "along": 0, "colab": [0, 8], "With": 0, "manipul": [4, 8], "step": 4, "hand": 8, "experi": 8, "Not": 8, "been": 8, "document": 8, "lora": [8, 9], "forward": [8, 9], "anoth": 0, "three": [], "code": [], "Then": 0, "observ": 0, "sever": 10, "adapt": 10, "neel": 10, "nanda": 10, "origin": 10, "transformerlen": 10, "www": [], "neelnanda": [], "io": [], "toolbox": [2, 4], "util": [2, 4], "todo": [1, 6, 9, 11], "mayb": 6, "diffusionmodel": 6}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": [], "nnsight": 4, "": [], "document": [2, 4], "content": [], "usag": [], "instal": 8, "creat": [], "recip": [], "gener": [], "context": 1, "get": 8, "start": 8, "layer": [], "argument": [], "test": [], "main": [], "demo": [], "introduct": [], "load": 0, "model": [0, 6], "tutori": 10, "access": 0, "activ": 0, "search": 5, "induct": 5, "head": 5, "patch": 7, "block": [], "basic": 0, "interven": 0, "first": 8, "step": 8, "all": [], "featur": 3, "toolbox": 9, "util": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"nnsight documentation": [[4, "nnsight-documentation"]], "Basics": [[0, "basics"]], "Loading Models": [[0, "loading-models"]], "Accessing Activations": [[0, "accessing-activations"]], "Intervening on Activations": [[0, "intervening-on-activations"]], "Searching for Induction Heads": [[5, "searching-for-induction-heads"]], "Patching": [[7, "patching"]], "Getting Started": [[8, "getting-started"]], "Installation": [[8, "installation"]], "First Steps": [[8, "first-steps"]], "Documentation": [[2, "documentation"]], "Models": [[6, "models"]], "Toolbox": [[9, "toolbox"]], "Tutorials": [[10, "tutorials"]], "Utils": [[11, "utils"]], "Contexts": [[1, "contexts"]], "Features": [[3, "features"]]}, "indexentries": {}})